<!-- Open dropdown element-->

<div
    class="right-side-svg d-flex align-items-center justify-content-center flex-column"
    [ngClass]="
        dropDownIsOpened === card.id && Dropdown.isOpen() ? 'active-item' : ''
    "
>
    <div
        #Dropdown="ngbPopover"
        (click)="toggleDropdown(Dropdown, card)"
        [autoClose]="'outside'"
        [ngbPopover]="dropdownPopover"
        [placement]="'bottom-right'"
        class="table-dropdown-container"
        container="body"
        popoverClass="table-dropdown-popover"
        triggers="manual"
    >
        <svg-icon
            class="dots"
            [ngClass]="
                dropDownIsOpened === card.id && Dropdown.isOpen()
                    ? 'rotate-dropdown-svg'
                    : 'dropdown-svg-back'
            "
            [src]="'assets/svg/common/ic_horizontal_dots_details.svg'"
        ></svg-icon>
    </div>
</div>

<!-- Dropdown -->

<ng-template #dropdownPopover let-data="data">
    <div class="table-list-dropdown">
        <div
            class="table-list-dropdown-content-container"
            [ngClass]="{
                'table-list-dropdown-inner-dropdown-active':
                    action?.isInnerDropActive
            }"
            *ngFor="let action of data; trackBy: trackByIdentity"
        >
            <!-- Action -->

            <div
                class="table-list-dropdown-content"
                (click)="
                    !action?.isDropdown
                        ? onDropAction(action)
                        : onShowInnerDropdown(action)
                "
                [ngClass]="{
                    'table-list-dropdown-content-muted': action.mutedStyle,
                    'table-list-dropdown-content-dropdown': action?.isDropdown,
                    'table-list-dropdown-content-dropdown-active':
                        action?.isInnerDropActive,
                    'table-list-dropdown-content-dropdown-disabled': action.mutedStyle 
                }"
                [ngStyle]="action?.tableListDropdownContentStyle"
            >
                <div class="table-list-dropdown-content-text">
                    {{ action?.title }}
                </div>

                <ng-container *ngIf="action?.svgUrl">
                    <svg-icon
                        [class]="action?.svgClass"
                        class="table-list-dropdown-content-icon"
                        [ngClass]="{
                            'inner-dropdown-open': action?.isInnerDropActive
                        }"
                        [src]="action?.svgUrl"
                        [svgStyle]="{
                            'width.px': action?.svgStyle.width,
                            'height.px': action?.svgStyle.height
                        }"
                    ></svg-icon>
                </ng-container>
            </div>

            <!-- Inner Dropdown -->
            <div
                class="table-list-inner-dropdown"
                [ngClass]="{
                    'table-list-inner-dropdown-active':
                        action?.isInnerDropActive
                }"
            >
                <ng-container
                    *ngFor="let content of action?.insideDropdownContent"
                >
                    <div
                        [id]="content.title"
                        #innerDropdownContent
                        (click)="onDropAction(content)"
                        class="inner-dropdown-action-title"
                    >
                        {{ content.title }}
                    </div>
                </ng-container>
            </div>

            <!-- Border -->

            <div
                class="table-list-dropdown-border-container"
                *ngIf="action?.hasBorder"
            >
                <div class="table-list-dropdown-border"></div>
            </div>
        </div>
    </div>
</ng-template>
