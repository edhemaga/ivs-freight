<div
    class="sort-dropdown-main-container d-flex align-items-center gap-1"
    [class.active]="isDropdownOpen"
>
    <div
        class="sort-column-name-container"
        #t2="ngbPopover"
        [ngbPopover]="sortDropdownPopover"
        [placement]="[dropdownPosition]"
        [triggers]="'manual'"
        autoClose="outside"
        [container]="'body'"
        [popoverClass]="'sort-dropdown-popover ' + dropdownPosition"
        (click)="openClosePopover(t2)"
        (hidden)="isDropdownOpen = false"
    >
        <div
            class="sort-column-name-text ta-font-medium"
            ngbTooltip
            [mainTooltip]="'Sort By'"
            tooltipBackground="#424242"
            position="bottom"
        >
            {{ activeSortColumn?.name }}
        </div>
    </div>
    <div
        class="sort-arrows-container d-flex align-items-center justify-content-center"
        (click)="!isDropdownOpen ? sortDirectionChange() : {}"
        ngbTooltip
        [mainTooltip]="sortDirection === 'asc' ? 'Ascending' : 'Descending'"
        [disableTooltip]="isDropdownOpen"
        tooltipBackground="#424242"
        position="bottom"
    >
        <ng-container *ngIf="isDropdownOpen; else sortDirectionArrowsTemplate">
            <svg-icon
                class="dropdown-arrow d-flex"
                [class.rotate-right]="
                    ['right', 'right-top'].includes(dropdownPosition)
                "
                [src]="sortDropdownSvgRoutes.sortDropArrowRoute"
                [svgStyle]="{ 'width.px': 14, 'height.px': 14 }"
            ></svg-icon>
        </ng-container>

        <ng-template #sortDirectionArrowsTemplate>
            <svg-icon
                class="direction-arrow d-flex"
                [class.rotate]="sortDirection === 'asc'"
                [src]="sortDropdownSvgRoutes.sortDirectionRoute"
                [svgStyle]="{ 'width.px': 18, 'height.px': 18 }"
            ></svg-icon>
        </ng-template>
    </div>
</div>

<ng-template #sortDropdownPopover>
    <div
        class="sort-popover d-flex flex-column gap-1"
        [ngStyle]="{ width: dropdownWidth + 'px' }"
    >
        <ng-container *ngFor="let column of _sortColumns">
            <div
                class="sort-popover-item d-flex align-items-center justify-content-between"
                [ngClass]="{
                    active: column.name === activeSortColumn.name,
                    disabled: column.isDisabled
                }"
                (click)="!column.isDisabled ? sortChangeEvent(column) : {}"
            >
                <div
                    class="sort-popover-item-text"
                    [class.ta-font-bold]="column.name === activeSortColumn.name"
                >
                    {{ column.name }}
                </div>

                <div class="check-icon-container d-flex">
                    <ng-container *ngIf="column.name === activeSortColumn.name">
                        <svg-icon
                            class="check-icon d-flex"
                            [src]="sortDropdownSvgRoutes.checkRoute"
                            [svgStyle]="{ 'width.px': 14, 'height.px': 14 }"
                        ></svg-icon>
                    </ng-container>
                </div>
            </div>
        </ng-container>
    </div>
</ng-template>
