<div
    [ngStyle]="{ 'width.px': componentData?.width ?? '100%' }"
    #openHoursPop="ngbPopover"
    [ngbPopover]="openHoursPopover"
    container="body"
    [placement]="'bottom-left'"
    popoverClass="table-open-hours-popover"
    triggers="manual"
    [autoClose]="'outside'"
    (hidden)="
        openHoursDropdownActiveId === componentData?.rowId
            ? (openHoursDropdownActiveId = -1)
            : {}
    "
    (click)="onShowOpenHoursDropdown(openHoursPop)"
>
    <div
        class="d-flex align-items-center open-hours-container"
        [ngClass]="{
            active: openHoursDropdownActiveId === componentData?.rowId,
        }"
        ngbTooltip
        mainTooltip="Open Hours"
        tooltipBackground="#424242"
        tooltipColor="#ffff"
        tooltipMarginTop="-6px"
        position="bottom"
    >
        @if (
            componentData?.openHoursToday?.status !==
            openHoursDropdownStringEnum.CLOSED
        ) {
            <svg-icon
                class="open-hours-icon"
                [ngClass]="{
                    closing:
                        componentData?.openHoursToday?.status ===
                        openHoursDropdownStringEnum.CLOSING_SOON,
                }"
                [src]="openHoursDropdownSvgRoutes.circleRoute"
                [svgStyle]="{
                    'width.px': 10,
                    'height.px': 10,
                }"
            ></svg-icon>
        }

        <p
            class="m-0 text-color-black text-size-14"
            [ngClass]="{
                'ta-font-semi-bold':
                    componentData?.openHoursToday?.status !==
                    openHoursDropdownStringEnum.CLOSED,
            }"
        >
            {{
                componentData?.openHoursToday?.status !==
                openHoursDropdownStringEnum.CLOSED
                    ? componentData?.openHoursToday?.status
                    : 'Opens'
            }}
        </p>
    </div>
</div>

<ng-template #openHoursPopover let-data="data">
    <div class="d-flex flex-column open-hours-dropdown">
        <ng-container
            *ngFor="let workingHourItem of data; trackBy: trackByIdentity"
        >
            <div class="d-flex flex-column open-hours-dropdown-item">
                <p class="m-0 ta-font-bold text-color-white-4 text-size-11">
                    {{ workingHourItem?.workingDays }}
                </p>

                <span class="text-color-white text-size-14">
                    {{ workingHourItem?.workingHours }}
                </span>
            </div>
        </ng-container>
    </div>
</ng-template>
