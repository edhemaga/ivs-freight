<div
    class="dispatch-table"
    [ngClass]="{
        locked: __isBoardLocked,
        unlocked: !__isBoardLocked && showAddAddressField == -1
    }"
    cdkDropList
    (cdkDropListDropped)="dropList($event)"
>
    <div
        *ngIf="__change_in_proggress"
        @iconAnimation
        class="loadingItem goTop"
    ></div>

    <table>
        <thead>
            <tr>
                <th>TRUCK</th>
                <th>TRAILER</th>
                <th>DRIVER</th>
                <th class="empty"></th>
                <th class="empty"></th>
                <th>LAST LOCATION</th>
                <th class="text-center p-0">STATUS</th>
                <th class="pick-delivery">
                    <div>PICKUP</div>
                    <div>DELIVERY</div>
                </th>
                <th>PROGRESS</th>
                <th>PARKING</th>
                <th class="empty"></th>
                <th>NOTE</th>
                <th class="empty"></th>
            </tr>
        </thead>
        <tbody>
            <tr
                class="reorder-row"
                *ngFor="let item of dData.dispatches; let rowIndex = index"
                [cdkDragDisabled]="__isBoardLocked || !item.truck"
                cdkDrag
                cdkDragLockAxis="y"
                cdkDragPreviewContainer="parent"
                cdkDragBoundary=".dispatch-table"
            >
                <td
                    cdkDragHandle
                    class="truck-field"
                    [ngStyle]="{
                        width: hasAdditionalFieldTruck ? '160px' : '120px'
                    }"
                >
                    <app-dispatch-table-truck-trailer
                        [type]="'truck'"
                        [hasAdditionalFieldTruck]="hasAdditionalFieldTruck"
                        [truck]="item?.truck"
                        [truckList]="truckList"
                        [rowIndex]="rowIndex"
                        [isBoardLocked]="__isBoardLocked"
                        [isDrag]="isDrag"
                        [isActiveLoad]="!!item.activeLoad"
                        (addTruckTrailerEmitter)="
                            handleAddTruckTrailerClick($event)
                        "
                        (removeTruckTrailerEmitter)="
                            handleRemoveTruckTrailerClick($event)
                        "
                    >
                    </app-dispatch-table-truck-trailer>
                </td>

                <td
                    class="trailer-field"
                    [ngStyle]="{
                        width: hasAdditionalFieldTrailer ? '160px' : '120px'
                    }"
                >
                    <div
                        [class.isDragging]="isDrag && draggingType == 'trailer'"
                        cdkDropList
                        [cdkDropListSortPredicate]="trailerPositionPrediction"
                        (cdkDropListDropped)="dropTrailer($event, rowIndex)"
                        id="{{ rowIndex | cdkid : gridIndex : 'trailer' }}"
                        [cdkDropListData]="dData"
                        [cdkDropListConnectedTo]="
                            rowIndex
                                | cdkconnect
                                    : dData.dispatches.length
                                    : gridIndex
                                    : 'trailer'
                        "
                    >
                        <div
                            class="drag-hold-between"
                            cdkDrag
                            (cdkDragStarted)="
                                cdkDragStartedTrailer($event, rowIndex)
                            "
                            (cdkDragEnded)="dragEnd()"
                            [cdkDragDisabled]="__isBoardLocked || !item.trailer"
                            cdkDragLockAxis="y"
                            cdkDragPreviewContainer="parent"
                            cdkDragBoundary=".dispatch-table table tbody"
                        >
                            <div
                                *cdkDragPlaceholder
                                class="custom-dispatch-placeholder"
                            ></div>

                            <app-dispatch-table-truck-trailer
                                [type]="'trailer'"
                                [hasAdditionalFieldTrailer]="
                                    hasAdditionalFieldTrailer
                                "
                                [trailer]="item?.trailer"
                                [trailerList]="trailerList"
                                [rowIndex]="rowIndex"
                                [isBoardLocked]="__isBoardLocked"
                                [isDrag]="isDrag"
                                [isActiveLoad]="!!item.activeLoad"
                                (removeTruckTrailerEmitter)="
                                    handleRemoveTruckTrailerClick($event)
                                "
                            >
                            </app-dispatch-table-truck-trailer>
                        </div>
                    </div>
                </td>

                <td class="driver-field">
                    <div
                        class="main_inside"
                        [class.addNew]="
                            !item.driver &&
                            driverList.length &&
                            !__isBoardLocked
                        "
                        [class.filled]="item.driver"
                        [class.default]="
                            !item.driver &&
                            !driverList.length &&
                            !__isBoardLocked
                        "
                        [class.isDragging]="isDrag && draggingType == 'driver'"
                        cdkDropList
                        (cdkDropListDropped)="dropDriver($event, rowIndex)"
                        id="{{ rowIndex | cdkid : gridIndex : 'driver' }}"
                        [cdkDropListData]="dData"
                        [cdkDropListConnectedTo]="
                            rowIndex
                                | cdkconnect
                                    : dData.dispatches.length
                                    : gridIndex
                                    : 'driver'
                        "
                    >
                        <div
                            class="drag-hold-between"
                            cdkDrag
                            (cdkDragStarted)="
                                cdkDragStartedDriver($event, rowIndex)
                            "
                            (cdkDragEnded)="dragEnd()"
                            [cdkDragDisabled]="__isBoardLocked || !item.driver"
                            cdkDragLockAxis="y"
                            [cdkDragPreviewClass]="'trailer_3074D3'"
                            cdkDragPreviewContainer="parent"
                            cdkDragBoundary=".dispatch-table table tbody"
                        >
                            <div
                                *cdkDragPlaceholder
                                class="custom-dispatch-placeholder"
                            ></div>
                            <div
                                class="padding-inside"
                                *ngIf="openedDriverDropdown != rowIndex"
                            >
                                <div
                                    class="add_new"
                                    *ngIf="
                                        !item.driver &&
                                        driverList.length &&
                                        !__isBoardLocked
                                    "
                                    (click)="showDriverDropdown(rowIndex)"
                                >
                                    <div class="text">Add</div>
                                    <svg-icon
                                        *ngIf="!isDrag"
                                        [src]="
                                            'assets/svg/truckassist-table/dropdown/content/add.svg'
                                        "
                                        [svgStyle]="{
                                            'width.px': '18',
                                            'height.px': '18'
                                        }"
                                    ></svg-icon>
                                </div>
                                <div class="info-item" *ngIf="item.driver">
                                    <div
                                        class="driver-copy"
                                        *ngIf="copyIndex == rowIndex"
                                    >
                                        COPIED
                                    </div>
                                    <div class="driver-buttons">
                                        <span
                                            *ngIf="driverHover.txt != 'email'"
                                            [class.only_active_icon]="
                                                driverCopy.indx == rowIndex &&
                                                driverCopy.txt != 'phone'
                                            "
                                            [class.active-icon]="
                                                driverCopy.indx == rowIndex &&
                                                driverCopy.txt == 'phone'
                                            "
                                            (mouseover)="
                                                setMouseOver('phone', rowIndex)
                                            "
                                            (mouseout)="setMouseOut()"
                                            (click)="
                                                copy(
                                                    item.phone,
                                                    rowIndex,
                                                    'phone'
                                                )
                                            "
                                        >
                                            <svg-icon
                                                [src]="
                                                    'assets/svg/common/ic_phone.svg'
                                                "
                                                [svgStyle]="{
                                                    'width.px': '18',
                                                    'height.px': '18'
                                                }"
                                                [fill]="'#ff0000'"
                                            ></svg-icon>
                                        </span>
                                        <span
                                            [class.only_active_icon]="
                                                driverCopy.indx == rowIndex &&
                                                driverCopy.txt != 'email'
                                            "
                                            [class.active-icon]="
                                                driverCopy.indx == rowIndex &&
                                                driverCopy.txt == 'email'
                                            "
                                            (mouseover)="
                                                setMouseOver('email', rowIndex)
                                            "
                                            (mouseout)="setMouseOut()"
                                            (click)="
                                                copy(
                                                    item.email,
                                                    rowIndex,
                                                    'email'
                                                )
                                            "
                                        >
                                            <svg-icon
                                                [src]="
                                                    'assets/svg/common/ic_email.svg'
                                                "
                                                [svgStyle]="{
                                                    'width.px': '18',
                                                    'height.px': '18'
                                                }"
                                                [fill]="'#ff0000'"
                                            ></svg-icon>
                                        </span>
                                    </div>
                                    <span
                                        class="dr-span-left"
                                        *ngIf="driverHover.indx != rowIndex"
                                        >{{ item.driver.firstName }}
                                        {{ item.driver.lastName }}</span
                                    >
                                    <div
                                        class="copy_divs"
                                        *ngIf="
                                            driverHover.indx == rowIndex &&
                                            driverHover.txt == 'phone'
                                        "
                                    >
                                        {{ item.phone }}
                                    </div>
                                    <div
                                        class="copy_divs"
                                        *ngIf="
                                            driverHover.indx == rowIndex &&
                                            driverHover.txt == 'email'
                                        "
                                    >
                                        {{ item.email }}
                                    </div>
                                    <span
                                        class="dr-span"
                                        ngbTooltip
                                        mainTooltip="Owner"
                                        tooltipBackground="#3074D3"
                                        position="right"
                                    >
                                        <svg-icon
                                            *ngIf="
                                                item.driver.owner &&
                                                driverHover.indx != rowIndex
                                            "
                                            [src]="
                                                'assets/svg/common/ic_driver-owner.svg'
                                            "
                                            [svgStyle]="{
                                                'width.px': '13',
                                                'height.px': '13'
                                            }"
                                            [fill]="'#ff0000'"
                                        ></svg-icon>
                                    </span>
                                    <div
                                        *ngIf="!isDrag"
                                        class="remove-item driver-remove-item"
                                        (click)="removeDriver(rowIndex)"
                                    >
                                        <svg-icon
                                            [src]="
                                                'assets/svg/applicant/close-x.svg'
                                            "
                                        ></svg-icon>
                                    </div>
                                </div>
                            </div>

                            <app-ta-input-dropdown
                                *ngIf="openedDriverDropdown == rowIndex"
                                [formControl]="truckFormControll"
                                [template]="'details-template'"
                                [inputConfig]="{
                                    name: 'Input Dropdown',
                                    type: 'text',
                                    label: 'Unit No',
                                    placeholder: 'Unit No.',
                                    isDropdown: true,
                                    dropdownWidthClass: 'w-col-198',
                                    placeholderInsteadOfLabel: true,
                                    hideDropdownArrow: true,
                                    autoFocus: true,
                                    blackInput: true,
                                    hideDropdownArrow: true,
                                    hideRequiredCheck: true,
                                    hideDangerMark: true,
                                    hideErrorMessage: true,
                                    mergeDropdownBodyWithInput: true
                                }"
                                [options]="driverList"
                                [canAddNew]="true"
                                [canOpenModal]="true"
                                [activeItem]="null"
                                (selectedItem)="addDriver($event)"
                            ></app-ta-input-dropdown>
                        </div>
                    </div>
                </td>
                <td class="box-item">
                    <div class="main_inside" [class.filled]="item.driver">
                        <div class="padding-inside">
                            <div
                                *ngIf="item.driver"
                                class="info-item c-pointer"
                                [class.driver-on-vacation]="
                                    item.driver.vacation
                                "
                                (click)="changeDriverVacation(item)"
                                [mainTooltip]="
                                    item.driver.vacation
                                        ? 'Remove from Vacation'
                                        : 'Send to Vacation'
                                "
                                [tooltipBackground]="
                                    item.driver.vacation ? '#EF5350' : '#2F2F2F'
                                "
                                ngbTooltip
                                position="right"
                            >
                                <svg-icon
                                    [src]="
                                        'assets/svg/dispatchboard/vacation.svg'
                                    "
                                ></svg-icon>
                            </div>
                        </div>
                    </div>
                </td>
                <td class="box-item">
                    <div class="main_inside filled">
                        <div class="padding-inside">
                            <div
                                #t1="ngbPopover"
                                (click)="
                                    toggleHos(t1, item.hoursOfService, item.id)
                                "
                                (hidden)="
                                    saveHosData(item.hoursOfService, rowIndex)
                                "
                                [class.statusOpened]="statusOpenedIndex > -1"
                                [class.empty-box-field]="true"
                                [ngbPopover]="hos"
                                autoClose="outside"
                                class="hos-column"
                                [ngClass]="
                                    item.hoursOfService &&
                                    item.hoursOfService[
                                        item.hoursOfService.length - 1
                                    ]?.flag.name === 'On'
                                        ? 'active_hos'
                                        : 'innactive_hos'
                                "
                                placement="bottom"
                                triggers="manual"
                                container="body"
                                popoverClass="hos-ngb-popover"
                            >
                                <div class="hos-img">
                                    <svg-icon
                                        [src]="
                                            'assets/svg/dispatchboard/hos-arrow.svg'
                                        "
                                    ></svg-icon>
                                </div>
                                <div class="hos-number">
                                    {{
                                        (item.hoursOfService !== null
                                            ? item.hoursOfService
                                            : []
                                        ) | hosTime
                                    }}
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
                <td class="location-field">
                    <div
                        class="main_inside"
                        [class.filled]="
                            item.location.address ||
                            showAddAddressField == rowIndex
                        "
                    >
                        <div class="padding-inside">
                            <ng-container
                                *ngIf="
                                    item?.location?.address ||
                                    showAddAddressField == rowIndex
                                "
                            >
                                <app-last-location-component
                                    [item]="item.location"
                                    [rowIndex]="rowIndex"
                                    [showAddAddressField]="showAddAddressField"
                                    [_parkings]="parkingList"
                                    (updateDispatchBoard)="
                                        updateOrAddDispatchBoardAndSend(
                                            'location',
                                            $event,
                                            this.showAddAddressField
                                        )
                                    "
                                    (hideDropdown)="onHideDropdown()"
                                >
                                </app-last-location-component>
                            </ng-container>
                        </div>
                    </div>
                </td>
                <td class="status-field">
                    <div
                        class="main_inside"
                        [class.filled]="
                            item.driver && item.trailer && item.location.address
                        "
                    >
                        <div class="padding-inside">
                            <app-ta-status-switch
                                *ngIf="
                                    item.driver &&
                                    item.trailer &&
                                    item.location.address
                                "
                                (changeStatus)="addStatus($event)"
                                (openIndex)="openIndex($event)"
                                [openedStatus]="statusOpenedIndex"
                                [dispatchboardId]="item.id"
                                [statusHeight]="32"
                                [status]="item.status"
                                [dispatchId]="item.id"
                                [statusMainIndex]="rowIndex"
                                [statusTypes]="'dispatch'"
                                [withStatusAgo]="true"
                                [pickupCount]="item.activeLoad?.pickupCount"
                                [deliveryCount]="item.activeLoad?.deliveryCount"
                                [possibleNextStatuses]="
                                    item.possibleNextStatuses
                                "
                                [nextStopType]="item.nextStopType"
                                [currentStopType]="item.currentStopType"
                            ></app-ta-status-switch>
                        </div>
                    </div>
                </td>
                <td class="pickup-delivery-field">
                    <!--   <div
                        class="main_inside"
                        [class.filled]="
                            item.driver &&
                            item.trailer &&
                            item.truck &&
                            item.location.address
                        "
                    >
                        <div class="padding-inside">
                            <div
                                class="info-item pickup-dev-popover-hold"
                                *ngIf="
                                    item.driver && item.trailer && item.truck
                                "
                                #t3="ngbPopover"
                                [ngbPopover]="pickupPopover"
                                [autoClose]="'outside'"
                                container="body"
                                [placement]="'bottom'"
                                popoverClass="pickup-delivery-popover"
                                triggers="manual"
                                (click)="showPickupDelivery(t3)"
                            >
                                <div
                                    class="no-delpickup"
                                    *ngIf="!item.activeLoad"
                                >
                                    No Active or Pending Load
                                </div>

                                <div
                                    class="load-items-hold"
                                    *ngIf="item.activeLoad"
                                >
                                    <div class="pick-load-box pickup-box">
                                        <svg-icon
                                            *ngIf="
                                                item.activeLoad.pickupCount < 9
                                            "
                                            src="
                                                assets/svg/svg_numbers/olddash/svg_num_box_{{
                                                item.activeLoad.pickupCount
                                            }}.svg
                                            "
                                        ></svg-icon>
                                        <svg-icon
                                            *ngIf="
                                                item.activeLoad.pickupCount > 9
                                            "
                                            src="assets/svg/svg_numbers/svg_num_over.svg
                                        "
                                        ></svg-icon>
                                        <div class="pick-load-info">
                                            <div class="pick-load-info-address">
                                                {{
                                                    item.activeLoad.pickup
                                                        .shipper.address.city
                                                }},
                                                {{
                                                    item.activeLoad.pickup
                                                        .shipper.address
                                                        .stateShortName
                                                }}
                                            </div>
                                            <div class="pick-load-info-time">
                                                05/09/21
                                            </div>
                                        </div>
                                    </div>
                                    <div class="pick-load-box delivery-box">
                                        <svg-icon
                                            *ngIf="
                                                item.activeLoad.deliveryCount <
                                                9
                                            "
                                            src="
                                                assets/svg/svg_numbers/olddash/svg_num_box_{{
                                                item.activeLoad.deliveryCount
                                            }}.svg
                                            "
                                        ></svg-icon>
                                        <svg-icon
                                            *ngIf="
                                                item.activeLoad.deliveryCount >
                                                9
                                            "
                                            src="assets/svg/svg_numbers/svg_num_over.svg
                                        "
                                        ></svg-icon>
                                        <div class="pick-load-info">
                                            <div class="pick-load-info-address">
                                                {{
                                                    item.activeLoad.delivery
                                                        .shipper.address.city
                                                }},
                                                {{
                                                    item.activeLoad.delivery
                                                        .shipper.address
                                                        .stateShortName
                                                }}
                                            </div>
                                            <div class="pick-load-info-time">
                                                05/09/21
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> -->
                </td>
                <td class="progress-field">
                    <div class="main_inside filled">
                        <div class="padding-inside">
                            <div class="info-item p-0 w-100">
                                <app-ta-gps-progressbar></app-ta-gps-progressbar>
                            </div>
                        </div>
                    </div>
                </td>
                <td class="parking-field">
                    <div
                        class="main_inside parking-field-new {{
                            item.parkingSlot ? 'filled' : 'addNew'
                        }} "
                        [class.unassigned]="!item.parkingSlot"
                    >
                        <div
                            class="padding-inside"
                            *ngIf="openParkingDropdown != rowIndex"
                        >
                            <!-- <div class="info-item">
                                <div class="parking-field d-flex">
                                    <svg-icon
                                        src="assets/svg/dispatchboard/parking.svg"
                                    >
                                    </svg-icon>
                                    <div class="parking-number">8650</div>
                                </div>
                            </div> -->
                            <div
                                *ngIf="item.truck || item.trailer"
                                class="add_new"
                                (click)="showParkingDropdown(rowIndex)"
                            >
                                <svg-icon
                                    *ngIf="!isDrag"
                                    src="assets/svg/dispatchboard/parking.svg"
                                >
                                </svg-icon>
                                <div class="text">Assign</div>
                            </div>
                        </div>

                        <app-ta-input-dropdown
                            *ngIf="openParkingDropdown == rowIndex"
                            [formControl]="truckFormControll"
                            [template]="'double-text-template'"
                            [inputConfig]="{
                                name: 'Input Dropdown',
                                type: 'text',
                                isDropdown: true,
                                label: 'Unit No.',
                                placeholder: 'Unit No.',
                                placeholderInsteadOfLabel: true,
                                autoFocus: true,
                                blackInput: true,
                                hideDropdownArrow: true,
                                hideRequiredCheck: true,
                                hideDangerMark: true,
                                hideErrorMessage: true,
                                mergeDropdownBodyWithInput: true,
                                textTransform: 'capitalize',
                                dropdownWidthClass: 'w-col-118'
                            }"
                            [canAddNew]="true"
                            [canOpenModal]="true"
                            [options]="parking"
                            [activeItem]="selectedLabel"
                            (selectedItem)="addParking($event)"
                        ></app-ta-input-dropdown>
                    </div>
                </td>
                <td class="box-item">
                    <div class="main_inside filled">
                        <div class="padding-inside">
                            <div class="info-item justify-content-center">
                                <app-ta-profile-images
                                    [indx]="rowIndex"
                                    [name]="'Slavisa Markovic'"
                                    [size]="'small'"
                                    [type]="'user'"
                                    [withTooltip]="true"
                                >
                                </app-ta-profile-images>
                            </div>
                        </div>
                    </div>
                </td>
                <td class="note-field">
                    <div class="main_inside" [class.filled]="item.truck">
                        <div
                            class="dispatcher-table-cell-container note-container"
                            [class.empty-box-field]="!item.note"
                        >
                            <app-ta-note
                                [note]="item.note"
                                [openedAll]="true"
                                [dispatchIndex]="rowIndex"
                                [parking]="false"
                                [noteWidth]="213"
                                [parentWidth]="'.note-field'"
                                [type]="'dark'"
                                [isDispatch]="true"
                                (saveNoteValue)="saveNoteValue($event)"
                            >
                            </app-ta-note>
                        </div>
                    </div>
                </td>
                <td class="box-item">
                    <div
                        class="main_inside"
                        [class.filled]="item.driver && item.truck"
                    >
                        <div class="padding-inside">
                            <div
                                *ngIf="item.driver && item.truck"
                                class="new_load_dispatch_hold"
                            >
                                <button
                                    [mainTooltip]="'Assign load'"
                                    [tooltipBackground]="'#6C6C6C'"
                                    ngbTooltip
                                    position="top"
                                    class="btn-transparent new_load_dispatch"
                                >
                                    <svg-icon
                                        class="icon-hover-blue-16"
                                        src="assets/svg/common/ic_plus.svg"
                                    >
                                    </svg-icon>
                                </button>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>

            <tr *ngIf="!__isBoardLocked">
                <td class="truck-field">
                    <!--    <div class="main_inside addNew">
                      <div
                            class="padding-inside"
                            *ngIf="openedTruckDropdown != -2"
                        >
                            <div
                                class="add_new"
                                (click)="showTruckDropdown(-2)"
                            >
                                <div class="text">Add</div>
                                <svg-icon
                                    *ngIf="!isDrag"
                                    [src]="
                                        'assets/svg/truckassist-table/dropdown/content/add.svg'
                                    "
                                    [svgStyle]="{
                                        'width.px': '18',
                                        'height.px': '18'
                                    }"
                                ></svg-icon>
                            </div>
                        </div> 

                        <app-ta-input-dropdown
                            *ngIf="openedTruckDropdown == -2"
                            [formControl]="truckFormControll"
                            [template]="'svgtext-dispatch-template'"
                            [inputConfig]="{
                                name: 'Input Dropdown',
                                type: 'text',
                                label: 'Unit No',
                                placeholder: 'Unit No.',
                                isDropdown: true,
                                dropdownWidthClass: 'w-col-118',
                                placeholderInsteadOfLabel: true,
                                hideDropdownArrow: true,
                                autoFocus: true,
                                blackInput: true,
                                hideDropdownArrow: true,
                                hideRequiredCheck: true,
                                hideDangerMark: true,
                                hideErrorMessage: true,
                                mergeDropdownBodyWithInput: true
                            }"
                            [options]="truckList"
                            [activeItem]="null"
                            [canAddNew]="true"
                            [canOpenModal]="true"
                            (selectedItem)="addTruck($event)"
                        ></app-ta-input-dropdown> 
                    </div> -->
                </td>
                <td class="trailer-field">
                    <!--  <div
                        class="main_inside addNew"
                        cdkDropList
                        [cdkDropListSortPredicate]="trailerPositionPrediction"
                        (cdkDropListDropped)="dropTrailer($event, -1)"
                        id="{{ -1 | cdkid : gridIndex : 'trailer' }}"
                        [cdkDropListData]="dData"
                        [cdkDropListConnectedTo]="
                            -1
                                | cdkconnect
                                    : dData.dispatches.length
                                    : gridIndex
                                    : 'trailer'
                        "
                        [class.dropdownActive]="openedTrailerDropdown == -2"
                    >
                        <div class="drag-hold-between">
                            <div
                                *cdkDragPlaceholder
                                class="custom-dispatch-placeholder"
                            ></div>
                            <div
                                class="padding-inside"
                                *ngIf="openedTrailerDropdown != -2"
                            >
                                <div
                                    class="add_new"
                                    *ngIf="openedTrailerDropdown != -2"
                                    (click)="showTrailerDropdown(-2)"
                                >
                                    <div class="text">Add</div>
                                    <svg-icon
                                        *ngIf="!isDrag"
                                        [src]="
                                            'assets/svg/truckassist-table/dropdown/content/add.svg'
                                        "
                                        [svgStyle]="{
                                            'width.px': '18',
                                            'height.px': '18'
                                        }"
                                    ></svg-icon>
                                </div>
                            </div>

                            <app-ta-input-dropdown
                                *ngIf="openedTrailerDropdown == -2"
                                [formControl]="truckFormControll"
                                [template]="'svgtext-dispatch-template'"
                                [inputConfig]="{
                                    name: 'Input Dropdown',
                                    type: 'text',
                                    label: 'Unit No',
                                    placeholder: 'Unit No.',
                                    isDropdown: true,
                                    dropdownWidthClass: 'w-col-118',
                                    placeholderInsteadOfLabel: true,
                                    autoFocus: true,
                                    blackInput: true,
                                    hideDropdownArrow: true,
                                    hideRequiredCheck: true,
                                    hideDangerMark: true,
                                    hideErrorMessage: true,
                                    mergeDropdownBodyWithInput: true
                                }"
                                [options]="trailerList"
                                [activeItem]="null"
                                [canAddNew]="true"
                                [canOpenModal]="true"
                                (selectedItem)="addTrailer($event)"
                            ></app-ta-input-dropdown>
                        </div>
                    </div> -->
                </td>
                <td class="driver-field">
                    <div
                        class="main_inside"
                        cdkDropList
                        (cdkDropListDropped)="dropDriver($event, -1)"
                        id="{{ -1 | cdkid : gridIndex : 'driver' }}"
                        [cdkDropListData]="dData"
                        [cdkDropListConnectedTo]="
                            -1
                                | cdkconnect
                                    : dData.dispatches.length
                                    : gridIndex
                                    : 'driver'
                        "
                        [class.addNew]="driverList.length"
                    >
                        <div class="drag-hold-between">
                            <div
                                *cdkDragPlaceholder
                                class="custom-dispatch-placeholder"
                            ></div>
                            <div
                                class="padding-inside"
                                *ngIf="
                                    openedDriverDropdown != -2 &&
                                    driverList.length
                                "
                            >
                                <div
                                    class="add_new"
                                    (click)="showDriverDropdown(-2)"
                                >
                                    <div class="text">Add</div>
                                    <svg-icon
                                        *ngIf="!isDrag"
                                        [src]="
                                            'assets/svg/truckassist-table/dropdown/content/add.svg'
                                        "
                                        [svgStyle]="{
                                            'width.px': '18',
                                            'height.px': '18'
                                        }"
                                    ></svg-icon>
                                </div>
                            </div>

                            <app-ta-input-dropdown
                                *ngIf="openedDriverDropdown == -2"
                                [formControl]="truckFormControll"
                                [template]="'details-template'"
                                [inputConfig]="{
                                    name: 'Input Dropdown',
                                    type: 'text',
                                    label: 'Unit No',
                                    placeholder: 'Unit No.',
                                    isDropdown: true,
                                    dropdownWidthClass: 'w-col-198',
                                    placeholderInsteadOfLabel: true,
                                    hideDropdownArrow: true,
                                    autoFocus: true,
                                    blackInput: true,
                                    hideDropdownArrow: true,
                                    hideRequiredCheck: true,
                                    hideDangerMark: true,
                                    hideErrorMessage: true,
                                    mergeDropdownBodyWithInput: true
                                }"
                                [options]="driverList"
                                [activeItem]="null"
                                [canAddNew]="true"
                                [canOpenModal]="true"
                                (selectedItem)="addDriver($event)"
                            ></app-ta-input-dropdown>
                        </div>
                    </div>
                </td>
                <td class="box-item">
                    <div class="main_inside">
                        <div class="padding-inside"></div>
                    </div>
                </td>
                <td class="box-item">
                    <div class="main_inside">
                        <div class="padding-inside"></div>
                    </div>
                </td>
                <td class="location-field">
                    <!-- <div
                        class="main_inside"
                        [class.filled]="showAddAddressField == -2"
                    >
                        <div class="padding-inside">
                            <app-ta-input-address-dropdown
                                *ngIf="showAddAddressField == -2"
                                [formControl]="truckAddress"
                                [inputConfig]="{
                                    name: 'Address',
                                    type: 'text',
                                    label: 'Location',
                                    placeholder: 'Location',
                                    textTransform: 'capitalize',
                                    dropdownWidthClass: 'w-col-151',
                                    minLength: 12,
                                    maxLength: 256,
                                    autoFocus: true,
                                    placeholderInsteadOfLabel: true,
                                    hideErrorMessage: true,
                                    blackInput: true
                                }"
                                [placeholderType]="'shortAddress'"
                                (incorrectEvent)="incorrectInput($event, 0, 18)"
                                [activeAddress]="selectedAddress"
                                (selectedAddress)="
                                    handleInputSelect($event, 'ADDRESS')
                                "
                                (closeDropdown)="onHideDropdown($event)"
                            ></app-ta-input-address-dropdown>
                        </div>
                    </div> -->
                </td>
                <td class="status-field">
                    <div class="main_inside">
                        <div class="padding-inside"></div>
                    </div>
                </td>
                <td class="pickup-delivery-field">
                    <div class="main_inside">
                        <div class="padding-inside"></div>
                    </div>
                </td>
                <td class="progress-field">
                    <div class="main_inside">
                        <div class="padding-inside"></div>
                    </div>
                </td>
                <td class="parking-field">
                    <div class="main_inside">
                        <div class="padding-inside"></div>
                    </div>
                </td>
                <td class="box-item">
                    <div class="main_inside">
                        <div class="padding-inside"></div>
                    </div>
                </td>
                <td class="note-field">
                    <div class="main_inside">
                        <div class="padding-inside"></div>
                    </div>
                </td>
                <td class="box-item">
                    <div class="main_inside">
                        <div class="padding-inside"></div>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <div class="table-info d-flex" [ngStyle]="{ 'width.px': toolbarWidth }">
        <div class="table-inside-info">
            <div class="table-info-field truck-filed">
                {{ dData.truckCount }}
                <span
                    [innerHTML]="dData.truckCount == 1 ? 'TRUCK' : 'TRUCKS'"
                ></span>
            </div>
            <div class="table-info-field trailer-field">
                {{ dData.trailerCount }}
                <span
                    [innerHTML]="
                        dData.trailerCount == 1 ? 'TRAILER' : 'TRAILERS'
                    "
                ></span>
            </div>
            <div class="table-info-field driver-field">
                {{ dData.driverCount }}
                <span
                    [innerHTML]="dData.driverCount == 1 ? 'DRIVER' : 'DRIVERS'"
                ></span>
            </div>
        </div>
        <div class="table-inside-info">
            <div class="table-info-field taken-field">2 of 24 Assigned</div>
            <div
                class="table-info-field dispatcher-field"
                [innerHTML]="
                    dData.dispatcher ? dData.dispatcher.fullName : 'Team Board'
                "
            ></div>
        </div>
    </div>
</div>

<!-- Popover for HOS -->
<ng-template #hos>
    <div class="hos-container">
        <div class="hos-header">
            <div class="hos-header-letters">
                <div>M</div>
                <div>N</div>
                <div>M</div>
            </div>
            <div
                class="hos-header-boxes"
                *ngFor="let item of [].constructor(24); let i = index"
            >
                <span></span>
            </div>
            <div class="middle-border"></div>
        </div>
        <div class="hos-body">
            <div
                #firstList="cdkDropList"
                (cdkDropListDropped)="dropHosList($event, data)"
                [cdkDropListConnectedTo]="[secondList]"
                [cdkDropListData]="openedHosData | hosFilter : 'off'"
                cdkDropList
                class="ngx-slider-list"
            >
                <div
                    cdkDrag
                    cdkDragLockAxis="y"
                    cdkDragPreviewContainer="parent"
                    class="ngx-slider-item off-items"
                    *ngFor="
                        let item of openedHosData | hosFilter : 'off';
                        let i = index
                    "
                >
                    <div
                        cdkDragHandle
                        style="cursor: grab"
                        class="ngx-slider-info"
                        [ngStyle]="{
                            width: (item | tooltipWidth).width + 'px',
                            left: (item | tooltipWidth).left + 'px'
                        }"
                    >
                        {{ (item | tooltipWidth).time }}
                        <span
                            class="remove_hos"
                            *ngIf="
                                item.indx !== 0 &&
                                item.indx == openedHosData.length - 1
                            "
                        >
                            <svg-icon
                                (click)="removeHos(item)"
                                src="assets/svg/applicant/close-x.svg"
                            >
                            </svg-icon>
                        </span>
                    </div>
                    <ngx-slider
                        [(highValue)]="item.end"
                        [(value)]="item.start"
                        [options]="options"
                        [rightToLeft]="true"
                        (userChange)="userChangeEnd($event, item)"
                    ></ngx-slider>
                </div>
                <div
                    *ngIf="
                        openedHosData[openedHosData.length - 1].flag.name ==
                        'On'
                    "
                    class="add-new off"
                >
                    <svg-icon
                        (click)="addHOS('off')"
                        src="assets/svg/common/ic_pm_increment.svg"
                    >
                    </svg-icon>
                </div>
            </div>
            <div
                #secondList="cdkDropList"
                (cdkDropListDropped)="dropHosList($event, data)"
                [cdkDropListConnectedTo]="[firstList]"
                [cdkDropListData]="openedHosData | hosFilter : 'on'"
                cdkDropList
                class="ngx-slider-list"
            >
                <div
                    cdkDrag
                    cdkDragLockAxis="y"
                    cdkDragPreviewContainer="parent"
                    class="ngx-slider-item on-items"
                    *ngFor="
                        let item of openedHosData | hosFilter : 'on';
                        let i = index
                    "
                >
                    <div
                        cdkDragHandle
                        style="cursor: grab"
                        class="ngx-slider-info"
                        [ngStyle]="{
                            width: (item | tooltipWidth).width + 'px',
                            left: (item | tooltipWidth).left + 'px'
                        }"
                    >
                        {{ (item | tooltipWidth).time }}
                        <span
                            class="remove_hos"
                            *ngIf="
                                item.indx !== 0 &&
                                item.indx == openedHosData.length - 1
                            "
                        >
                            <svg-icon
                                (click)="removeHos(item)"
                                src="assets/svg/applicant/close-x.svg"
                            >
                            </svg-icon>
                        </span>
                    </div>
                    <ngx-slider
                        [(highValue)]="item.end"
                        [(value)]="item.start"
                        [options]="options"
                        [rightToLeft]="true"
                        (userChange)="userChangeEnd($event, item)"
                    ></ngx-slider>
                </div>
                <div
                    *ngIf="
                        openedHosData[openedHosData.length - 1].flag.name ==
                        'Off'
                    "
                    class="add-new on"
                >
                    <svg-icon
                        (click)="addHOS('on')"
                        src="assets/svg/common/ic_pm_increment.svg"
                    >
                    </svg-icon>
                </div>
            </div>
        </div>
    </div>
</ng-template>

<!-- Pickup and Delivery popover -->

<ng-template #pickupPopover let-data="data">
    <app-ta-pickup-delivery [customWidth]="340"></app-ta-pickup-delivery>
</ng-template>
