<app-ca-modal
    [modalTitle]="'Preview Report'"
    [rightHeaderTemplate]="rightModalContent"
    [customClass]="'modal-container-load modal-payroll-report'"
>
    <div
        origin
        class="w-full pos-relative scrollable-element remove-scroll-track"
    >
        <div class="divider divider--dark divider--small"></div>

        <div class="zoom-controls">
            <button (click)="setZoom(2)">2X</button>
            <button (click)="setZoom(1.5)">1.5X</button>
            <button (click)="setZoom(1.25)">1.25X</button>
            <button (click)="setZoom(1)">DEF LVL</button>
            <button (click)="setZoom(0.75)">0.75X</button>
            <button (click)="setZoom(0.5)">0.5X</button>
        </div>

        <div
            class="d-flex justify-content-center overflow-hidden pos-relative w-full h-full zoom-container"
        >
            @let zoomElementStyles =
                {
                    transform: 'scale(' + zoomLevel + ')',
                    transformOrigin: 'top',
                    width: 100 / zoomLevel + '%',
                };

            <div [ngStyle]="zoomElementStyles">
                @if (!isLoading) {
                    <iframe
                        [srcdoc]="pdfReport?.html"
                        width="100%"
                        height="960px"
                    ></iframe>

                    <div class="h-full pos-relative">
                        <div
                            class="d-flex flex-column align-items-center justify-content-center pos-absolute bottom-12 right-12 w-30 h-52 br-50 p-x-4 p-y-4 background-white zoom-controls-container"
                        >
                            @let zoomInControlSvgClass =
                                pdfZoom >= maxZoom
                                    ? 'svg-fill-light-grey-6'
                                    : 'svg-fill-muted svg-hover-black';

                            @let zoomOutControlSvgClass =
                                pdfZoom === 1
                                    ? 'svg-fill-light-grey-6'
                                    : 'svg-fill-muted svg-hover-black';

                            <div
                                class="d-flex align-items-center justify-content-center c-pointer"
                                (click)="zoomIn()"
                            >
                                <svg-icon
                                    class="svg-size-12"
                                    [ngClass]="zoomInControlSvgClass"
                                    [src]="svgRoutes.plusIcon"
                                ></svg-icon>
                            </div>

                            <div
                                class="d-flex align-items-center justify-content-center c-pointer"
                                (click)="zoomOut()"
                            >
                                <svg-icon
                                    class="svg-size-12"
                                    [ngClass]="zoomOutControlSvgClass"
                                    [src]="svgRoutes.minusIcon"
                                ></svg-icon>
                            </div>
                        </div>
                    </div>
                } @else {
                    <div class="h-800">
                        <div
                            class="d-flex align-items-center justify-content-center h-full w-full"
                        >
                            <app-ta-spinner
                                [size]="'small'"
                                [color]="'black'"
                            ></app-ta-spinner>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</app-ca-modal>

<ng-template #rightModalContent>
    <ng-container *ngIf="!isLoading">
        <div
            class="d-flex justify-content-center align-items-center modal-close-container"
            ngbTooltip
            [mainTooltip]="eGeneralActions.DOWNLOAD"
            [tooltipBackground]="eColor.BLACK"
            [position]="ePosition.BOTTOM"
            (click)="handleDownloadReportClick()"
        >
            <svg-icon
                [src]="svgRoutes.downloadIcon"
                class="modal-buttons"
            ></svg-icon>
        </div>

        <div class="modal-date-border"></div>
    </ng-container>

    <div
        class="d-flex justify-content-center align-items-center modal-close-container"
        ngbTooltip
        [mainTooltip]="eGeneralActions.CANCEL_CAPITALIZED"
        [tooltipBackground]="eColor.BLACK"
        [position]="ePosition.BOTTOM"
        (click)="handleCloseModalClick()"
    >
        <svg-icon
            class="modal-close svg-size-14 svg-fill-muted modal-buttons"
            [src]="svgRoutes.closeIcon"
        ></svg-icon>
    </div>
</ng-template>
