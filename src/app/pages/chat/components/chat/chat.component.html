<div class="chat-container">
    <div class="toolbar-container d-flex align-items-center">
        <!-- TITLE -->
        <div
            class="list-name d-flex justify-content-center align-items-center ta-font-black"
        >
            {{ title | uppercase }}
        </div>

        <!-- TABS -->
        <div class="tab-wrapper d-flex align-items-center">
            <ng-container
                *ngFor="
                    let tab of tabs;
                    let ind = index;
                    trackBy: '' | trackByProperty
                "
            >
                <div
                    class="tab-container d-flex"
                    [ngClass]="{
                        'tab-inactive': !tab.checked,
                        'tab-active': tab.checked
                    }"
                    (click)="onSelectTab(tab)"
                >
                    <div class="tab d-flex align-items-center">
                        <div
                            class="tab-title d-flex justify-content-center align-items-center ta-font-extra-bold"
                        >
                            {{ tab.name }}
                        </div>
                        <div
                            class="data-count d-flex justify-content-center align-items-center ta-font-extra-bold"
                        >
                            {{ tab.count }}
                        </div>
                    </div>
                </div>
            </ng-container>
        </div>

        <ng-container *ngIf="unreadCount">
            <app-chat-vertical-divider></app-chat-vertical-divider>

            <div class="d-flex unread-messages-wrapper">
                <div
                    class="unread-messages-icon d-flex justify-content-center align-items-center"
                >
                    <svg-icon
                        class="d-flex justify-content-center align-items-center"
                        [svgStyle]="{ 'width.px': 18, 'height.px': 18 }"
                        [src]="chatSvgRoutes.unreadMessageIcon"
                    >
                    </svg-icon>
                </div>
                <div
                    class="unread-count-wrapper d-flex justify-content-center align-items-center ta-font-extra-bold"
                >
                    <div class="unread-count">{{ unreadCount }}</div>
                </div>
            </div>
        </ng-container>

        <div
            class="table-actions d-flex justify-content-end align-items-center"
        >
            <div
                class="icon-wrapper d-flex justify-content-center align-items-center"
                [ngStyle]="{
                    backgroundColor:
                        (isProfileDetailsDisplayed$ | async)
                            ? '#424242'
                            : '#ffffff'
                }"
                (click)="displayProfileDetails()"
            >
                <svg-icon
                    class="d-flex"
                    [svgStyle]="{
                        'width.px': 18,
                        'height.px': 18
                    }"
                    [src]="chatSvgRoutes.informationIcon"
                >
                </svg-icon>
            </div>

            <app-chat-vertical-divider></app-chat-vertical-divider>

            <div
                class="icon-wrapper d-flex justify-content-center align-items-center"
                [ngStyle]="{
                    'background-color': isHamburgerMenuActive
                        ? '#424242'
                        : '#fff'
                }"
                (click)="toggleChatPreferences()"
            >
                <svg-icon
                    class="d-flex justify-content-center align-items-center"
                    [svgStyle]="{ 'width.px': 18, 'height.px': 18 }"
                    [src]="chatSvgRoutes.burgerMenuIcon"
                >
                </svg-icon>
            </div>

            <app-chat-vertical-divider></app-chat-vertical-divider>

            <div
                class="icon-wrapper settings-icon d-flex justify-content-center align-items-center"
            >
                <svg-icon
                    class="d-flex justify-content-center align-items-center"
                    [svgStyle]="{ 'width.px': 18, 'height.px': 18 }"
                    [src]="chatSvgRoutes.settingsIcon"
                >
                </svg-icon>
            </div>

            <div class="d-flex justify-content-center align-items-center">
                <div class="new-chat d-flex">
                    <svg-icon class="d-flex" [src]="chatSvgRoutes.plusIcon">
                    </svg-icon>
                </div>
            </div>
        </div>
    </div>

    <div
        class="chat-main-content"
        [ngStyle]="{
            'grid-template-columns':
                (isProfileDetailsDisplayed$ | async) ||
                (isParticipantsDisplayed$ | async)
                    ? chatGridLayout.MAX_AUTO_MAX
                    : chatGridLayout.MAX_AUTO
        }"
    >
        <!-- User list -->
        <div class="chat-lists">
            <app-conversation-list
                [departments]="departments"
                [companyUsers]="companyUsers"
                [drivers]="drivers"
                (selectedConversation)="
                    createUserConversation($event.id, $event.type, $event.group)
                "
            ></app-conversation-list>
        </div>

        <!-- Messages -->
        <div class="conversation-wrapper">
            <ng-container *ngIf="selectedConversation; else noConversation">
                <router-outlet></router-outlet>
            </ng-container>

            <ng-template #noConversation>
                <ng-container
                    *ngTemplateOutlet="conversationNotSelected"
                ></ng-container>
            </ng-template>
        </div>

        <!-- Profile details -->
        <ng-container *ngIf="!(isAttachmentUploadActive$ | async)">
            <div class="profile-details-wrapper d-flex">
                <ng-container *ngIf="isProfileDetailsDisplayed$ | async">
                    <div class="profile-details">
                        <app-chat-user-profile
                            [data]="conversationProfileDetails$ | async"
                            [profileDetailsType]="
                                chatConversationProfileDetailsType.SAFETY
                            "
                            (isProfileDetailsClosed)="closeProfileDetails()"
                        ></app-chat-user-profile>
                    </div>
                </ng-container>
                <ng-container
                    *ngIf="
                        (isParticipantsDisplayed$ | async) &&
                        (conversation$ | async)?.participants?.length
                    "
                >
                    <div class="profile-details">
                        <app-chat-channel-participant-list
                            [@fadeInOutHorizontal]
                            [conversationParticipants]="
                                (conversation$ | async)?.participants
                            "
                            (closeGroupMembersOverviewEvent)="
                                closeGroupMembersOverview($event.value)
                            "
                        ></app-chat-channel-participant-list>
                    </div>
                </ng-container>
            </div>
        </ng-container>
    </div>
</div>

<!-- Templates -->
<ng-template #conversationNotSelected>
    <div class="not-selected-wrapper">
        <app-chat-header>
            <div class="text ta-font-extra-bold">Conversation</div>
        </app-chat-header>

        <div class="content d-flex align-content-center justify-content-center">
            <div>
                <svg-icon
                    class="d-flex justify-content-center align-items-center"
                    [svgStyle]="{ 'width.px': 226, 'height.px': 250 }"
                    [src]="chatSvgRoutes.notSelectedIllustrationIcon"
                >
                </svg-icon>
                <div class="text">
                    <div class="text-main ta-font-bold">
                        Select an item to read
                    </div>
                    <div class="text-auxillary">Nothing is selected</div>
                </div>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #preferences let-item="item">
    <div></div>
</ng-template>
