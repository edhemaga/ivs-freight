<app-ta-modal
    [modalTitle]="
        editData?.type !== 'edit-licence'
            ? editData?.type === 'renew-licence'
                ? 'Renew CDL'
                : 'Add CDL'
            : 'Edit CDL'
    "
    [editData]="editData"
    [editName]="modalName"
    [isModalValid]="cdlForm.valid && isFormDirty"
    [specificCaseModalName]="true"
    [isVoidBtn]="editData?.type === 'edit-licence'"
    (action)="onModalAction($event)"
>
    <form
        origin
        [formGroup]="cdlForm"
        class="form-container form-container-without-mb"
    >
        <!-- State. CDL Number, Class -->

        <div class="row">
            <div class="col-3">
                <app-ca-input-dropdown
                    formControlName="stateId"
                    [inputConfig]="{
                        name: 'Input Dropdown',
                        type: 'text',
                        label: 'State',
                        textTransform: 'uppercase',
                        isRequired: true,
                        isDropdown: true,
                        dropdownWidthClass: 'w-col-97',
                    }"
                    [options]="stateDropdownList"
                    [activeItem]="selectedState"
                    (selectedItem)="onSelectDropdown($event, 'state')"
                ></app-ca-input-dropdown>
            </div>

            <div class="col-6">
                <app-ca-input
                    formControlName="cdlNumber"
                    [inputConfig]="{
                        name: 'cdl-number',
                        type: 'number',
                        label: 'CDL No.',
                        isRequired: true,
                        textTransform: 'capitalize',
                        minLength: selectedCountry === 'US' ? 1 : 5,
                        maxLength: selectedCountry === 'US' ? 19 : 15,
                        isDisabled: !cdlForm.get('stateId').value,
                    }"
                ></app-ca-input>
            </div>

            <div class="col-3">
                <app-ca-input-dropdown
                    formControlName="classType"
                    [inputConfig]="{
                        name: 'Input Dropdown',
                        type: 'text',
                        label: 'Class',
                        isRequired: true,
                        isDropdown: true,
                        dropdownWidthClass: 'w-col-97',
                    }"
                    [options]="classDropdownList"
                    [activeItem]="selectedClass"
                    (selectedItem)="onSelectDropdown($event, 'class')"
                ></app-ca-input-dropdown>
            </div>
        </div>

        <!--  Issue Date, Expiration Date -->

        <div class="row">
            <div class="col-6">
                <app-ca-input
                    formControlName="issueDate"
                    [inputConfig]="{
                        name: 'datepicker',
                        type: 'text',
                        isDropdown: true,
                        label: 'Issue Date',
                        placeholderIcon: 'date',
                        isRequired: true,
                        customClass: 'datetimeclass',
                    }"
                ></app-ca-input>
            </div>

            <div class="col-6">
                <app-ca-input
                    formControlName="expDate"
                    [inputConfig]="{
                        name: 'datepicker',
                        type: 'text',
                        label: 'Expiration Date',
                        isDropdown: true,
                        placeholderIcon: 'date',
                        isRequired: true,
                        customClass: 'datetimeclass',
                    }"
                ></app-ca-input>
            </div>
        </div>

        <!-- Restrictions -->

        <div class="row">
            <div class="col-12">
                <app-ca-input-dropdown
                    formControlName="restrictions"
                    [template]="'multiselect'"
                    [inputConfig]="{
                        name: 'Input Dropdown',
                        type: 'text',
                        isDropdown: true,
                        label: 'Restrictions',
                        multiselectDropdown: true,
                        multiSelectItemRange: true,
                        dropdownWidthClass: 'w-col-456',
                    }"
                    [options]="restrictionsDropdownList"
                    [preloadMultiselectItems]="selectedRestrictions"
                    (selectedItems)="onSelectDropdown($event, 'restrictions')"
                ></app-ca-input-dropdown>
            </div>
        </div>

        <!-- Endorsement -->

        <div class="row last-row">
            <div class="col-12">
                <app-ca-input-dropdown
                    formControlName="endorsements"
                    [template]="'multiselect'"
                    [inputConfig]="{
                        name: 'Input Dropdown',
                        type: 'text',
                        isDropdown: true,
                        label: 'Endorsement',
                        multiselectDropdown: true,
                        dropdownWidthClass: 'w-col-456',
                    }"
                    [options]="endorsementsDropdownList"
                    [preloadMultiselectItems]="selectedEndorsments"
                    (selectedItems)="onSelectDropdown($event, 'endorsments')"
                ></app-ca-input-dropdown>
            </div>
        </div>

        <!-- Documents -->

        <div class="ta-card-body-overflow-none">
            <app-ta-custom-card
                [hasCounter]="documents?.length"
                [cardName]="'Document'"
                [disableAnimation]="isCardAnimationDisabled"
                [isCardOpen]="!!documents.length"
            >
                <app-ca-upload-files
                    [files]="documents"
                    [slider]="{
                        dontUseSlider: false,
                        hasCarouselBottomTabs: true,
                    }"
                    [carouselConfig]="{
                        files: documents,
                        customClass: 'medium',
                        customDetailsPageClass: 'modals',
                        hasCarouselBottomTabs: true,
                    }"
                    [hasCrop]="false"
                    [dropzoneConf]="[
                        {
                            template: 'documentsTemplate',
                            config: {
                                dropzone: {
                                    dropZoneType: 'files',
                                    multiple: true,
                                    globalDropZone: false,
                                    dropZonePages: 'tools_todo',
                                },
                                dropzoneOption: {
                                    customClassName: 'documents-dropzone',
                                    size: 'medium',
                                    modalSize: 'lg',
                                    showDropzone: true,
                                    filesLength: 2,
                                    isRequired: true,
                                    dropzoneClose: false,
                                },
                            },
                        },
                    ]"
                    [isVisibleCropAndDrop]="true"
                    [review]="{
                        isReview: false,
                        reviewMode: 'FEEDBACK_MODE',
                        feedbackText: 'Sample feedback text',
                        categoryTag: 'General',
                    }"
                    [configFile]="{
                        id: 111,
                        customClassName: 'modals',
                        file: {
                            url: '',
                            incorrect: false,
                            lastHovered: false,
                            fileSize: 1200,
                            fileName: '',
                        },
                        hasTagsDropdown: true,
                        hasNumberOfPages: true,
                        activePage: 1,
                        type: 'modal',
                        hasLandscapeOption: false,
                        tagsOptions: [
                            { tagName: 'HOS Agreement', checked: false },
                            { tagName: 'Unsafe Driving AGT', checked: false },
                        ],
                    }"
                    [size]="'medium'"
                    [slideWidth]="180"
                    (onFileEvent)="onFilesEvent($event)"
                ></app-ca-upload-files>
            </app-ta-custom-card>
        </div>

        <!-- Note -->

        <app-ca-input-note
            formControlName="note"
            [isVisibleNote]="
                cdlForm.get('note').value && cdlForm.get('note').value != 'null'
                    ? cdlForm.get('note').value
                    : false
            "
            [note]="
                cdlForm.get('note').value && cdlForm.get('note').value != 'null'
                    ? cdlForm.get('note').value
                    : ''
            "
        ></app-ca-input-note>
    </form>
</app-ta-modal>
