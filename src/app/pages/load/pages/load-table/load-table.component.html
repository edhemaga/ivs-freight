<div class="table-container">
    @if ( { tableOptions: loadStoreService.tableOptions$ | async, tableData:
    loadStoreService.tableData$ | async, columns: loadStoreService.columns$ |
    async, viewData: loadStoreService.viewData$ | async, activeTableData:
    loadStoreService.activeTableData$ | async, activeViewMode:
    loadStoreService.activeViewMode$ | async, }; as store ) {
    <app-new-table-toolbar
        [title]="'Load'"
        [leftSide]="leftSide"
        [columnView]="columnView"
        [filters]="filters"
    ></app-new-table-toolbar>

    @if (store?.activeViewMode === 'List') {
    <app-ta-table-head
        [options]="store?.tableOptions"
        [viewData]="store?.viewData"
        [columns]="store?.columns"
        [tableData]="store?.tableData"
        (headActions)="onTableHeadActions($event)"
    ></app-ta-table-head>

    <app-ta-table-body
        [viewData]="store?.viewData"
        [columns]="store?.columns"
        [options]="store?.tableOptions"
        [selectedTab]="selectedTab | lowercase"
        (bodyActions)="onTableBodyActions($event)"
        [tableData]="store?.tableData"
        (saveValueNote)="saveValueNote($event)"
    ></app-ta-table-body>
    }
    <!-- Cards -->

    @if (store?.activeViewMode === 'Card') {
    <div class="elements">
        <app-load-card
            (bodyActions)="onTableBodyActions($event)"
            [viewData]="store?.viewData"
            [rows]="rows"
            [cardTitle]="cardTitle"
            [cardTitleLink]="cardTitleLink"
            [displayRowsFront]="(displayRows$ | async)?.displayRowsFront"
            [displayRowsBack]="(displayRows$ | async)?.displayRowsBack"
            [page]="page"
            [selectedTab]="selectedTab | lowercase"
            (saveValueNote)="saveValueNote($event)"
        ></app-load-card>

        <!-- Show More -->

        <div
            class="show-more-container d-flex align-items-center justify-content-between"
            [ngStyle]="{ 'width.px': tableWidth }"
        >
            <div class="showing ta-font-semi-bold">
                {{ store?.viewData?.length }} OF
                {{ store?.activeTableData?.data?.length }}
            </div>
            @if ( store?.viewData?.length < store?.activeTableData?.data?.length
            ) {
            <div
                class="show-more ta-font-bold w-fit-content align-items-center d-flex justify-content-between"
                (click)="onShowMore()"
            >
                SHOW MORE
            </div>
            }
        </div>
    </div>
    }

    <ng-template #leftSide>
        <app-toolbar-tabs
            [data]="store.tableData"
            [selectedTab]="selectedTab"
            [variant]="toolbarVariant.Large"
            (tabSelected)="
                onToolBarAction({ action: tableStringEnum.TAB_SELECTED, mode: $event })
            "
        ></app-toolbar-tabs>
    </ng-template>

    <ng-template #columnView>
        <ng-container *ngTemplateOutlet="divider"></ng-container>
        <app-toolbar-tabs
            [data]="tableViewData"
            [selectedTab]="loadStoreService.activeViewMode$ | async"
            [variant]="toolbarVariant.Small"
            (tabSelected)="
                onToolBarAction({ action: tableStringEnum.VIEW_MODE, mode: $event })
            "
        ></app-toolbar-tabs>
        <ng-container *ngTemplateOutlet="divider"></ng-container>
    </ng-template>

    <ng-template #filters>
        <div class="d-flex gap-1 align-items-center">
            <app-ca-search-multiple-states
                [searchType]="'tabel'"
                [selectedTabData]="store?.activeTableData"
                [toolbarSearch]="true"
            ></app-ca-search-multiple-states>

            <ng-container *ngTemplateOutlet="divider"></ng-container>

            @if (selectedTab !== 'Template') {
            <app-ca-filter
                [type]="'timeFilter'"
                [icon]="'ic_time'"
                [filterTitle]="'Time Filter'"
                [timeSubType]="'past'"
                (setFilter)="setFilters($event)"
                (clearAll)="setFilters($event)"
            >
            </app-ca-filter>
            <app-ca-filter
                [type]="'dispatcherFilter'"
                [icon]="'user'"
                [searchState]="true"
                [filterTitle]="'Dispatcher Filter'"
                [defFilterHolder]="true"
                (setFilter)="setFilters($event)"
                (clearAll)="setFilters($event)"
            >
            </app-ca-filter>
            <!-- [unselectedUser]="
                    loadService.loadDispatcherFilters$ | async
                " -->
            <app-ca-filter
                [type]="'statusFilter'"
                [filterTitle]="'Status Filter'"
                [icon]="'broker-half-circle'"
                (setFilter)="setFilters($event)"
                (clearAll)="setFilters($event)"
            >
            </app-ca-filter>

            <!-- [loadStatusOptionsArray]="
                    loadService.loadStatusFilter$ | async
                " -->
            <app-ca-filter
                [type]="'moneyFilter'"
                [icon]="'dollar'"
                [filterTitle]="'Money Filter'"
                [subType]="'all'"
                [isMoneyFilter]="true"
                [isLoadType]="true"
                (setFilter)="setFilters($event)"
                (clearAll)="setFilters($event)"
            >
            </app-ca-filter>
            }
        </div>
    </ng-template>

    <ng-template #divider>
        <div class="new-table--toolbar-divider">
            <div class="new-table--toolbar-divider-border"></div>
        </div>
    </ng-template>
    }
</div>
