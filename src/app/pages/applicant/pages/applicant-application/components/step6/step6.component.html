<div class="d-flex flex-column align-items-center step-container">
    <h1 class="m-0 step-title text-center ta-font-bold">Education</h1>

    <h3 class="m-0 step-subtitle text-center ta-font-regular">
        Please select the highest grade completed:
    </h3>

    <!-- SELECT GRADE -->

    <p class="m-0 ta-font-bold school-college-title">ELEMENTARY & SECONDARY</p>

    <div
        class="d-flex justify-content-center align-items-center grade-container"
    >
        <ng-container
            *ngFor="
                let grade of schoolGrades;
                let i = index;
                trackBy: trackByIdentity
            "
        >
            <div
                class="d-flex justify-content-center align-items-center grade"
                (mouseover)="highlightGrade = i"
                (mouseleave)="highlightGrade = -1"
                (click)="onSchoolGradeClick(i)"
                [ngClass]="{
                    'grade-disabled-selected':
                        selectedMode !== 'APPLICANT_MODE' &&
                        selectedGrade === i,
                    'grade-disabled-before-selected':
                        (selectedMode !== 'APPLICANT_MODE' &&
                            i <= selectedGrade) ||
                        (selectedMode !== 'APPLICANT_MODE' &&
                            selectedCollegeGrade > -1),
                    'grade-required':
                        selectedMode === 'APPLICANT_MODE' &&
                        displayGradeRequiredNote,
                    'grade-hovered-required':
                        selectedMode === 'APPLICANT_MODE' &&
                        i <= highlightGrade &&
                        displayGradeRequiredNote,
                    'grade-hovered':
                        (selectedMode === 'APPLICANT_MODE' &&
                            i <= highlightGrade) ||
                        (selectedMode === 'APPLICANT_MODE' &&
                            highlightCollegeGrade > -1) ||
                        (selectedMode === 'APPLICANT_MODE' &&
                            i < selectedGrade) ||
                        (selectedMode === 'APPLICANT_MODE' &&
                            selectedCollegeGrade > -1),
                    'grade-selected':
                        selectedMode === 'APPLICANT_MODE' && selectedGrade === i
                }"
                [ngStyle]="{
                    cursor:
                        selectedMode === 'APPLICANT_MODE' ? 'pointer' : 'auto'
                }"
            >
                <p class="m-0">{{ grade }}</p>
            </div>
        </ng-container>
    </div>

    <p class="m-0 ta-font-bold school-college-title">COLLEGE:</p>

    <!-- SELECT COLLAGE GRADE -->

    <div
        class="d-flex flex-column justify-content-center align-items-center collage-grade-container"
    >
        <div class="d-flex align-items-center justify-content-center">
            <ng-container
                *ngFor="
                    let grade of collegeGrades;
                    let i = index;
                    trackBy: trackByIdentity
                "
            >
                <div
                    class="d-flex justify-content-center align-items-center grade"
                    (mouseover)="highlightCollegeGrade = i"
                    (mouseleave)="highlightCollegeGrade = -1"
                    (click)="onCollegeGradeClick(i)"
                    [ngClass]="{
                        'grade-disabled-selected':
                            selectedMode !== 'APPLICANT_MODE' &&
                            selectedCollegeGrade === i,
                        'grade-disabled-before-selected':
                            selectedMode !== 'APPLICANT_MODE' &&
                            i <= selectedCollegeGrade,
                        'grade-required':
                            selectedMode === 'APPLICANT_MODE' &&
                            displayGradeRequiredNote,
                        'grade-hovered-required':
                            selectedMode === 'APPLICANT_MODE' &&
                            i <= highlightCollegeGrade &&
                            displayGradeRequiredNote,
                        'grade-hovered':
                            (selectedMode === 'APPLICANT_MODE' &&
                                i <= highlightCollegeGrade) ||
                            (selectedMode === 'APPLICANT_MODE' &&
                                i < selectedCollegeGrade),
                        'grade-selected':
                            selectedMode === 'APPLICANT_MODE' &&
                            selectedCollegeGrade === i
                    }"
                    [ngStyle]="{
                        cursor:
                            selectedMode === 'APPLICANT_MODE'
                                ? 'pointer'
                                : 'auto'
                    }"
                >
                    <p class="m-0">{{ grade }}</p>
                </div>
            </ng-container>
        </div>
    </div>

    <!-- FORM SECTION -->

    <div class="d-flex flex-column form-section">
        <form [formGroup]="educationForm">
            <!-- TOP QUESTIONS -->

            <div class="d-flex flex-column top-questions-container">
                <ng-container
                    *ngFor="
                        let question of questions | slice : 0 : 3;
                        let i = index;
                        trackBy: trackByIdentity
                    "
                >
                    <div class="d-flex flex-column question-container">
                        <div
                            class="d-flex justify-content-between"
                        >
                            <div
                                class="d-flex flex-column"
                                [ngClass]="['title-box' + i, 'title-box']"
                            >
                                <p
                                    class="m-0 ta-font-regular"
                                    [ngClass]="
                                        selectedMode === 'FEEDBACK_MODE'
                                            ? 'question-title question-title-feedback'
                                            : 'question-title'
                                    "
                                >
                                    {{ question.title }}
                                    <span class="required-star">*</span>
                                </p>

                                <p
                                    class="m-0 ta-font-semi-bold required"
                                    [ngClass]="{
                                        'required-active':
                                            displayRadioRequiredNoteArray[i]
                                                .displayRadioRequiredNote
                                    }"
                                >
                                    Required
                                </p>
                            </div>

                            <div class="radios-box">
                                <app-ta-input-radiobuttons
                                    #cmp
                                    [buttons]="question.answerChoices"
                                    [disabled]="
                                        selectedMode !== 'APPLICANT_MODE'
                                    "
                                    [displayRequiredNote]="
                                        displayRadioRequiredNoteArray[i]
                                            .displayRadioRequiredNote
                                    "
                                    (changedValue)="handleInputSelect($event)"
                                ></app-ta-input-radiobuttons>
                            </div>
                        </div>

                        <!-- EXPLAIN -->

                        <ng-container *ngIf="i === 0 || i === 1">
                            <ng-container
                                *ngIf="
                                    educationForm.get(question.formControlName)
                                        ?.value
                                "
                            >
                                <div
                                    class="d-flex explain-container line-container"
                                    [ngStyle]="{
                                        'margin-bottom': educationForm.get(
                                            question.formControlName
                                        )?.value
                                            ? '20px'
                                            : '0'
                                    }"
                                >
                                    <div class="w-100">
                                        <app-ta-input
                                            [formControlName]="
                                                question.formControlNameExplain
                                            "
                                            [inputConfig]="{
                                                name: 'Explain',
                                                type: 'text',
                                                label: 'Please explain',
                                                isRequired: true,
                                                textTransform: 'capitalize',
                                                placeholder: 'Please explain',
                                                placeholderInsteadOfLabel: true,
                                                isDisabled:
                                                    selectedMode ===
                                                        'REVIEW_MODE' ||
                                                    (selectedMode ===
                                                        'FEEDBACK_MODE' &&
                                                        i === 0 &&
                                                        stepFeedbackValues?.isSpecialTrainingDescriptionValid) ||
                                                    (i === 1 &&
                                                        stepFeedbackValues?.isOtherTrainingDescriptionValid),
                                                incorrectInput:
                                                    selectedMode ===
                                                    'REVIEW_MODE'
                                            }"
                                            [incorrectValue]="
                                                openAnnotationArray[i]
                                                    .lineInputs[0]
                                            "
                                            (incorrectEvent)="
                                                incorrectInput($event, 0, i)
                                            "
                                        ></app-ta-input>
                                    </div>

                                    <!-- REVIEW AND FEEDBACK -->

                                    <ng-container
                                        *ngIf="
                                            selectedMode !== 'APPLICANT_MODE'
                                        "
                                    >
                                        <div class="review-feedback-container">
                                            <app-applicant-review-feedback
                                                [formControlName]="
                                                    'questionReview' + (i + 1)
                                                "
                                                [displayAnnotationButton]="
                                                    selectedMode ===
                                                        'REVIEW_MODE' &&
                                                    openAnnotationArray[i]
                                                        .displayAnnotationButton
                                                "
                                                [displayAnnotationTextArea]="
                                                    selectedMode ===
                                                        'REVIEW_MODE' &&
                                                    openAnnotationArray[i]
                                                        .displayAnnotationTextArea
                                                "
                                                [lineIndex]="i"
                                                [isFeedback]="
                                                    selectedMode ===
                                                    'FEEDBACK_MODE'
                                                "
                                                [feedbackText]="
                                                    selectedMode ===
                                                        'FEEDBACK_MODE' &&
                                                    ((i === 0 &&
                                                        stepFeedbackValues?.specialTrainingDescriptionMessage) ||
                                                        (i === 1 &&
                                                            stepFeedbackValues?.otherTrainingDescriptionMessage))
                                                "
                                                (annotationBtnClickEvent)="
                                                    selectedMode ===
                                                        'REVIEW_MODE' &&
                                                        getAnnotationBtnClickValue(
                                                            $event
                                                        )
                                                "
                                            ></app-applicant-review-feedback>
                                        </div>
                                    </ng-container>
                                </div>
                            </ng-container>
                        </ng-container>
                    </div>
                </ng-container>
            </div>

            <!-- GENERAL -->

            <h3 class="m-0 text-center ta-font-bold step-title general-title">
                General
            </h3>

            <!-- BOTTOM QUESTIONS -->

            <div class="d-flex flex-column bottom-questions-container">
                <ng-container
                    *ngFor="
                        let question of questions | slice : 3;
                        let i = index;
                        trackBy: trackByIdentity
                    "
                >
                    <div
                        class="d-flex align-items-center question-container"
                        [ngStyle]="{
                            margin: educationForm.get('driverForCompany').value
                                ? '0 auto'
                                : '0 auto 12px auto'
                        }"
                    >
                        <div
                            class="d-flex flex-column align-items-center w-100"
                        >
                            <div
                                class="d-flex justify-content-between w-100"
                            >
                                <div
                                    class="d-flex flex-column"
                                    [ngClass]="['title-box' + i, 'title-box']"
                                >
                                    <p
                                        class="m-0 ta-font-regular"
                                        [ngClass]="
                                            selectedMode === 'FEEDBACK_MODE'
                                                ? 'question-title question-title-feedback'
                                                : 'question-title'
                                        "
                                    >
                                        {{ question.title }}
                                        <span class="required-star">*</span>
                                    </p>

                                    <p
                                        class="m-0 ta-font-semi-bold required"
                                        [ngClass]="{
                                            'required-active':
                                                displayRadioRequiredNoteArray[
                                                    i + 3
                                                ].displayRadioRequiredNote
                                        }"
                                    >
                                        Required
                                    </p>
                                </div>

                                <div class="radios-box">
                                    <app-ta-input-radiobuttons
                                        #cmp
                                        [buttons]="question.answerChoices"
                                        [disabled]="
                                            selectedMode !== 'APPLICANT_MODE'
                                        "
                                        [displayRequiredNote]="
                                            displayRadioRequiredNoteArray[i + 3]
                                                .displayRadioRequiredNote
                                        "
                                        (changedValue)="
                                            handleInputSelect($event)
                                        "
                                    ></app-ta-input-radiobuttons>
                                </div>
                            </div>

                            <!-- DATE EXPLAIN  -->

                            <ng-container *ngIf="i === 0">
                                <div
                                    class="d-flex"
                                    [ngStyle]="{
                                        margin: educationForm.get(
                                            'driverForCompany'
                                        ).value
                                            ? '22px auto 32px auto'
                                            : '0 auto'
                                    }"
                                >
                                    <ng-container
                                        *ngIf="
                                            educationForm.get(
                                                'driverForCompany'
                                            ).value
                                        "
                                    >
                                        <div class="d-flex line-container">
                                            <div class="date-group">
                                                <app-ta-input 
                                                    formControlName="driverForCompanyBeforeExplain"
                                                    [inputConfig]="driverForCompanyBeforeExplainInputConfig"
                                                    [incorrectValue]="
                                                        openAnnotationArray[2]
                                                            .lineInputs[0]
                                                    "
                                                    (incorrectEvent)="
                                                        incorrectInput(
                                                            $event,
                                                            0,
                                                            2
                                                        )
                                                    "
                                                ></app-ta-input>
                                            </div>

                                            <div class="date-group date-to-group">
                                                <app-ta-input 
                                                    formControlName="driverForCompanyToExplain"
                                                    [inputConfig]="driverForCompanyToExplainInputConfig"
                                                    [incorrectValue]="
                                                        openAnnotationArray[2]
                                                            .lineInputs[1]
                                                    "
                                                    (incorrectEvent)="
                                                        incorrectInput(
                                                            $event,
                                                            1,
                                                            2
                                                        )
                                                    "
                                                ></app-ta-input>
                                            </div>

                                            <!-- REVIEW AND FEEDBACK -->

                                            <ng-container
                                                *ngIf="
                                                    selectedMode !==
                                                    'APPLICANT_MODE'
                                                "
                                            >
                                                <div
                                                    class="review-feedback-container"
                                                >
                                                    <app-applicant-review-feedback
                                                        [formControlName]="
                                                            'questionReview' +
                                                            (i + 4)
                                                        "
                                                        [displayAnnotationButton]="
                                                            selectedMode ===
                                                                'REVIEW_MODE' &&
                                                            openAnnotationArray[
                                                                i + 2
                                                            ]
                                                                .displayAnnotationButton
                                                        "
                                                        [displayAnnotationTextArea]="
                                                            selectedMode ===
                                                                'REVIEW_MODE' &&
                                                            openAnnotationArray[
                                                                i + 2
                                                            ]
                                                                .displayAnnotationTextArea
                                                        "
                                                        [lineIndex]="i + 2"
                                                        [isFeedback]="
                                                            selectedMode ===
                                                            'FEEDBACK_MODE'
                                                        "
                                                        [feedbackText]="
                                                            selectedMode ===
                                                                'FEEDBACK_MODE' &&
                                                            stepFeedbackValues?.datesMessage
                                                        "
                                                        (annotationBtnClickEvent)="
                                                            selectedMode ===
                                                                'REVIEW_MODE' &&
                                                                getAnnotationBtnClickValue(
                                                                    $event
                                                                )
                                                        "
                                                    ></app-applicant-review-feedback>
                                                </div>
                                            </ng-container>
                                        </div>
                                    </ng-container>
                                </div>
                            </ng-container>

                            <!-- EXPLAIN -->

                            <ng-container *ngIf="i === 1">
                                <ng-container
                                    *ngIf="
                                        educationForm.get(
                                            question.formControlName
                                        ).value
                                    "
                                >
                                    <div class="d-flex">
                                        <div
                                            class="explain-container line-container"
                                            [ngStyle]="{
                                                'margin-bottom':
                                                    educationForm.get(
                                                        question.formControlName
                                                    )?.value
                                                        ? '20px'
                                                        : '0'
                                            }"
                                        >
                                            <app-ta-input
                                                [formControlName]="question.formControlNameExplain"
                                                [inputConfig]="isUnableToPreformJobInputConfig" 
                                                [incorrectValue]="
                                                    openAnnotationArray[3]
                                                        .lineInputs[0]
                                                "
                                                (incorrectEvent)="
                                                    incorrectInput($event, 0, 3)
                                                "
                                            ></app-ta-input>

                                            <!-- REVIEW AND FEEDBACK -->

                                            <ng-container
                                                *ngIf="
                                                    selectedMode !==
                                                    'APPLICANT_MODE'
                                                "
                                            >
                                                <div
                                                    class="review-feedback-container"
                                                >
                                                    <app-applicant-review-feedback
                                                        [formControlName]="
                                                            'questionReview' +
                                                            (i + 4)
                                                        "
                                                        [displayAnnotationButton]="
                                                            selectedMode ===
                                                                'REVIEW_MODE' &&
                                                            openAnnotationArray[3]
                                                                .displayAnnotationButton
                                                        "
                                                        [displayAnnotationTextArea]="
                                                            selectedMode ===
                                                                'REVIEW_MODE' &&
                                                            openAnnotationArray[3]
                                                                .displayAnnotationTextArea
                                                        "
                                                        [lineIndex]="3"
                                                        [isFeedback]="
                                                            selectedMode ===
                                                            'FEEDBACK_MODE'
                                                        "
                                                        [feedbackText]="
                                                            selectedMode ===
                                                                'FEEDBACK_MODE' &&
                                                            stepFeedbackValues?.unableToPreformJobDescriptionMessage
                                                        "
                                                        (annotationBtnClickEvent)="
                                                            selectedMode ===
                                                                'REVIEW_MODE' &&
                                                                getAnnotationBtnClickValue(
                                                                    $event
                                                                )
                                                        "
                                                    ></app-applicant-review-feedback>
                                                </div>
                                            </ng-container>
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>
                        </div>
                    </div>
                </ng-container>
            </div>
        </form>

        <!-- CONTACT -->

        <form class="contact-form">
            <p class="contact-title ta-font-extra-bold">
                Emergency contact
            </p>

            <!-- CREATED CONTACT DATA -->

            <ng-container *ngIf="contacts?.length">
                <div
                    class="d-flex flex-column justify-content-center contacts-view-container"
                    [formGroup]="contactForm"
                >
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-center title-container">
                            <div
                                class="d-flex align-items-center name-title-box"
                            >
                                <p class="m-0 ta-font-semi-bold">
                                    NAME <span>*</span>
                                </p>
                            </div>

                            <div
                                class="d-flex align-items-center phone-title-box"
                            >
                                <p class="m-0 ta-font-semi-bold">
                                    PHONE <span>*</span>
                                </p>
                            </div>

                            <div
                                class="d-flex align-items-center relationship-title-box"
                            >
                                <p class="m-0 ta-font-semi-bold">
                                    RELATIONSHIP <span>*</span>
                                </p>
                            </div>
                        </div>

                        <ng-container
                            *ngFor="
                                let contact of contacts?.controls;
                                let i = index;
                                trackBy: trackByIdentity
                            "
                            formArrayName="contacts"
                        >
                            <div
                                class="d-flex align-items-center contact-info-container"
                                [formGroupName]="i"
                                [ngClass]="{
                                    'filled-valid': contacts?.controls[i].valid,
                                    'filled-invalid':
                                        contacts?.controls[i].invalid
                                }"
                            >
                                <div class="group name-group">
                                    <app-ta-input 
                                        formControlName="name"
                                        [inputConfig]="emergencyNameInputConfig">
                                    </app-ta-input>
                                </div>

                                <div class="group phone-group">
                                    <app-ta-input 
                                        formControlName="phone"
                                        [inputConfig]="phoneInputConfig">
                                    </app-ta-input>
                                </div>

                                <div class="group relationship-group">
                                    <app-ta-input 
                                        formControlName="relationship"
                                        [inputConfig]="relationshipInputConfig">
                                    </app-ta-input>
                                </div>

                                <div class="delete-btn-group">
                                    <app-applicant-delete-btn
                                        [filledValid]="
                                            contacts?.controls[i].valid
                                        "
                                        [filledInvalid]="
                                            contacts?.controls[i].invalid
                                        "
                                    ></app-applicant-delete-btn>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </ng-container>

            <!--  <ng-container *ngIf="contactsArray?.length">
                <div
                    class="d-flex flex-column justify-content-center contacts-view-container"
                    [formGroup]="contactForm"
                >
                    <ng-container
                        *ngFor="
                            let contact of contactsArray;
                            let i = index;
                            trackBy: trackByIdentity
                        "
                    >
                        <div class="d-flex flex-column">
                            <ng-container
                                *ngIf="
                                    (contactsArray.length > 0 &&
                                        helperIndex !== 0 &&
                                        i === 0) ||
                                    (helperIndex === 0 && i === 1) ||
                                    (i === helperIndex + 1 &&
                                        selectedContactIndex > -1)
                                "
                            >
                                <div
                                    class="d-flex align-items-center title-container"
                                >
                                    <div
                                        class="d-flex align-items-center name-title-box"
                                    >
                                        <p class="m-0 ta-font-bold">
                                            NAME <span>*</span>
                                        </p>
                                    </div>
                                    <div
                                        class="d-flex align-items-center phone-title-box"
                                    >
                                        <p class="m-0 ta-font-bold">
                                            PHONE <span>*</span>
                                        </p>
                                    </div>
                                    <div
                                        class="d-flex align-items-center relationship-title-box"
                                    >
                                        <p class="m-0 ta-font-bold">
                                            RELATIONSHIP <span>*</span>
                                        </p>
                                    </div>
                                </div>
                            </ng-container>

                            <ng-container *ngIf="!contact.isEditingContact">
                                <div
                                    class="d-flex align-items-center contact-info-container line-container"
                                >
                                    <div
                                        class="d-flex align-items-center info-btn-container"
                                    >
                                        <div
                                            class="d-flex align-items-center"
                                            [ngStyle]="{
                                                cursor:
                                                    selectedMode ===
                                                    'REVIEW_MODE'
                                                        ? 'pointer'
                                                        : 'auto'
                                            }"
                                            (click)="
                                                selectedMode ===
                                                    'REVIEW_MODE' &&
                                                    onCardReview(i)
                                            "
                                        >
                                            <div
                                                class="d-flex align-items-center name-box"
                                            >
                                                <p class="m-0 ta-font-regular">
                                                    {{ contact.name }}
                                                </p>
                                            </div>
                                            <div
                                                class="d-flex align-items-center phone-box"
                                            >
                                                <p class="m-0 ta-font-regular">
                                                    {{ contact.phone }}
                                                </p>
                                            </div>
                                            <div
                                                class="d-flex align-items-center relationship-box"
                                                [ngStyle]="{
                                                    'margin-right':
                                                        selectedMode ===
                                                        'APPLICANT_MODE'
                                                            ? '20px'
                                                            : 0
                                                }"
                                            >
                                                <p class="m-0 ta-font-regular">
                                                    {{ contact.relationship }}
                                                </p>
                                            </div>
                                        </div>

                                        <div
                                            class="d-flex align-items-center btn-container"
                                            [ngClass]="{
                                                active:
                                                    selectedMode ===
                                                    'REVIEW_MODE'
                                            }"
                                            [ngStyle]="{
                                                'margin-left':
                                                    selectedMode ===
                                                    'FEEDBACK_MODE'
                                                        ? '18px'
                                                        : 0
                                            }"
                                        >
                                            <ng-container
                                                *ngIf="
                                                    selectedMode ===
                                                        'APPLICANT_MODE' ||
                                                    (selectedMode ===
                                                        'FEEDBACK_MODE' &&
                                                        stepFeedbackValues
                                                            ?.contactItemsReview[
                                                            i
                                                        ].hasIncorrectValue)
                                                "
                                            >
                                                <div
                                                    ngbTooltip
                                                    mainTooltip="Edit"
                                                    tooltipBackground="#6C6C6C"
                                                    position="top"
                                                >
                                                    <svg-icon
                                                        class="edit-icon"
                                                        src="assets/svg/truckassist-table/dropdown/content/edit-hover.svg"
                                                        [svgStyle]="{
                                                            'width.px': 18,
                                                            'height.px': 18
                                                        }"
                                                        (click)="
                                                            onEditContact(i)
                                                        "
                                                    ></svg-icon>
                                                </div>
                                            </ng-container>

                                            <ng-container
                                                *ngIf="
                                                    selectedMode ===
                                                    'APPLICANT_MODE'
                                                "
                                            >
                                                <div
                                                    ngbTooltip
                                                    mainTooltip="Delete"
                                                    tooltipBackground="#EF5350"
                                                    position="top"
                                                >
                                                    <svg-icon
                                                        class="delete-icon"
                                                        src="assets/svg/truckassist-table/dropdown/content/delete.svg"
                                                        [svgStyle]="{
                                                            'width.px': 18,
                                                            'height.px': 18
                                                        }"
                                                        (click)="
                                                            onDeleteContact(i)
                                                        "
                                                    ></svg-icon>
                                                </div>
                                            </ng-container>

                                            <ng-container
                                                *ngIf="
                                                    selectedMode ===
                                                    'REVIEW_MODE'
                                                "
                                            >
                                                <div
                                                    class="review-icon-box"
                                                    ngbTooltip
                                                    mainTooltip="Mark Incorrect"
                                                    tooltipBackground="#F44336"
                                                    position="top"
                                                >
                                                    <svg-icon
                                                        class="review-icon"
                                                        [ngClass]="{
                                                            active:
                                                                openAnnotationArray[
                                                                    i + 4
                                                                ]
                                                                    .displayAnnotationButton ||
                                                                openAnnotationArray[
                                                                    i + 4
                                                                ]
                                                                    .displayAnnotationTextArea
                                                        }"
                                                        src="assets/svg/ic_x.svg"
                                                        [svgStyle]="{
                                                            'width.px': 18,
                                                            'height.px': 18
                                                        }"
                                                        (click)="
                                                            openAnnotationArray[
                                                                i + 4
                                                            ].lineInputs[0]
                                                                ? incorrectInput(
                                                                      $event,
                                                                      0,
                                                                      i + 4,
                                                                      'card'
                                                                  )
                                                                : onCardReview(
                                                                      i
                                                                  )
                                                        "
                                                    ></svg-icon>
                                                </div>
                                            </ng-container>

                                            <ng-container
                                                *ngIf="
                                                    selectedMode ===
                                                        'FEEDBACK_MODE' &&
                                                    stepFeedbackValues
                                                        ?.contactItemsReview[i]
                                                        .hasIncorrectValue
                                                "
                                            >
                                                <div
                                                    class="feedback-icon-box"
                                                    ngbTooltip
                                                    mainTooltip="Marked Incorrect"
                                                    tooltipBackground="#F44336"
                                                    position="top"
                                                >
                                                    <svg-icon
                                                        class="feedback-icon"
                                                        src="assets/svg/common/ic_danger.svg"
                                                        [svgStyle]="{
                                                            'width.px': 18,
                                                            'height.px': 18
                                                        }"
                                                    ></svg-icon>
                                                </div>
                                            </ng-container>
                                        </div>
                                    </div>

                                    REVIEW AND FEEDBACK 

                                    <ng-container
                                        *ngIf="
                                            selectedMode !== 'APPLICANT_MODE'
                                        "
                                    >
                                        <div class="review-feedback-container">
                                            <app-applicant-review-feedback
                                                [formControlName]="
                                                    'cardReview' + (i + 1)
                                                "
                                                [displayAnnotationButton]="
                                                    selectedMode ===
                                                        'REVIEW_MODE' &&
                                                    openAnnotationArray[i + 4]
                                                        .displayAnnotationButton
                                                "
                                                [displayAnnotationTextArea]="
                                                    selectedMode ===
                                                        'REVIEW_MODE' &&
                                                    openAnnotationArray[i + 4]
                                                        .displayAnnotationTextArea
                                                "
                                                [lineIndex]="i + 4"
                                                [cardsLength]="
                                                    contactsArray.length
                                                "
                                                [cardsType]="
                                                    'educationContacts'
                                                "
                                                [cardIndex]="i"
                                                [isFeedback]="
                                                    selectedMode ===
                                                    'FEEDBACK_MODE'
                                                "
                                                [feedbackText]="
                                                    selectedMode ===
                                                        'FEEDBACK_MODE' &&
                                                    stepFeedbackValues
                                                        ?.contactItemsReview[i]
                                                        .emergencyContactMessage
                                                "
                                                (annotationBtnClickEvent)="
                                                    selectedMode ===
                                                        'REVIEW_MODE' &&
                                                        getAnnotationBtnClickValue(
                                                            $event
                                                        )
                                                "
                                            ></app-applicant-review-feedback>
                                        </div>
                                    </ng-container>
                                </div>
                            </ng-container>

                            <ng-container *ngIf="contact.isEditingContact">
                                <div
                                    class="d-flex flex-column contacts-view-form"
                                    [ngStyle]="{
                                        margin:
                                            i !== 0
                                                ? '32px auto 0 auto'
                                                : '10px auto 0 auto'
                                    }"
                                >
                                    <app-step6-form
                                        [mode]="selectedMode"
                                        [isEditing]="isEditing"
                                        [formValuesToPatch]="formValuesToPatch"
                                        [isReviewingCard]="isReviewingCard"
                                        [stepFeedbackValues]="
                                            feedbackValuesToPatch
                                        "
                                        (formValuesEmitter)="
                                            getContactFormValues($event)
                                        "
                                        (cancelFormEditingEmitter)="
                                            cancelContactEditing($event)
                                        "
                                        (saveFormEditingEmitter)="
                                            saveEditedContact($event)
                                        "
                                        (cancelFormReviewingEmitter)="
                                            cancelContactReview($event)
                                        "
                                        (cardOpenAnnotationArrayValuesEmitter)="
                                            onGetCardOpenAnnotationArrayValues(
                                                $event
                                            )
                                        "
                                    ></app-step6-form>
                                </div>
                            </ng-container>
                        </div>
                    </ng-container>
                </div>
            </ng-container> -->

            <ng-container
                *ngIf="
                    (selectedMode !== 'REVIEW_MODE' && !isEditing) ||
                    (selectedMode === 'REVIEW_MODE' && !isReviewingCard)
                "
            >
                <app-step6-form
                    [mode]="selectedMode"
                    [isEditing]="isEditing"
                    [markFormInvalid]="markFormInvalid"
                    [formValuesToPatch]="formValuesToPatch"
                    [isReviewingCard]="isReviewingCard"
                    [stepFeedbackValues]="feedbackValuesToPatch"
                    [contactsLength]="contacts?.length"
                    (formValuesEmitter)="getContactFormValues($event)"
                    (formStatusEmitter)="onGetFormStatus($event)"
                    (markInvalidEmitter)="onMarkInvalidEmit($event)"
                    (lastFormValuesEmitter)="onGetLastFormValues($event)"
                    (hasIncorrectFieldsEmitter)="onHasIncorrectFields($event)"
                    (openAnnotationArrayValuesEmitter)="
                        onGetOpenAnnotationArrayValues($event)
                    "
                ></app-step6-form>
            </ng-container>
        </form>
    </div>
</div>

<!-- NEXT BTN -->

<div
    class="d-flex justify-content-center align-items-center"
>
    <app-applicant-next-back-btn
        [nextStep]="true"
        [filledCorrectly]="
            educationForm.valid &&
            selectedGrade > -1 &&
            formStatus === 'VALID' &&
            !isEditing &&
            (selectedMode === 'APPLICANT_MODE' ||
                (selectedMode === 'FEEDBACK_MODE' &&
                    isUpperFormFeedbackValueUpdated &&
                    isBottomFormFeedbackValueUpdated))
        "
        [hasIncorrectFields]="
            selectedMode === 'REVIEW_MODE' &&
            (questionsHaveIncorrectFields ||
                hasIncorrectFields ||
                cardsWithIncorrectFields)
        "
        [mode]="selectedMode"
        (stepEvent)="onStepAction($event)"
    ></app-applicant-next-back-btn>
</div>

<!-- BACK BTN -->

<div
    class="d-flex justify-content-center align-items-center"
>
    <app-applicant-next-back-btn
        [backStep]="true"
        (stepEvent)="onStepAction($event)"
    ></app-applicant-next-back-btn>
</div>
