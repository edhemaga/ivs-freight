<div class="modal-table-container">
    <!-- Table Header -->

    <div
        class="align-items-center table-header"
        [ngClass]="{
            'phone-table-header': isPhoneTable,
            'email-table-header': isEmailTable,
            'description-table-header': isDescriptionTable
        }"
    >
        <ng-container
            *ngFor="
                let headerItem of modalTableHeaders;
                let i = index;
                trackBy: trackByIdentity
            "
        >
            <div
                class="d-flex align-items-center table-header-box"
                [ngClass]="{
                    'justify-content-center': i === 0,
                    'description-header': isDescriptionTable && i !== 0,
                    'justify-content-end subtotal': i === 5
                }"
            >
                <p class="m-0 ta-font-bold">
                    {{ headerItem }}
                </p>

                <ng-container *ngIf="i === 1 && !isDescriptionTable">
                    <span class="m-0 ta-font-bold">*</span>
                </ng-container>

                <ng-container
                    *ngIf="i !== 0 && i !== 2 && i !== 5 && isDescriptionTable"
                >
                    <span class="m-0 ta-font-bold">*</span>
                </ng-container>
            </div>
        </ng-container>
    </div>

    <!-- Table Body -->

    <form [formGroup]="modalTableForm" class="table-body">
        <!-- Phone Table -->

        <ng-container *ngIf="isPhoneTable">
            <div class="d-flex flex-column phone-table-container">
                <ng-container
                    formArrayName="phoneTableItems"
                    *ngFor="
                        let phoneItemsRow of getFormArray().controls;
                        let i = index;
                        trackBy: trackByIdentity
                    "
                >
                    <div
                        class="align-items-center table-item"
                        [formGroupName]="i"
                    >
                        <!-- Number & Delete -->

                        <div
                            class="d-flex justify-content-center align-items-center table-item-number"
                        >
                            <p class="m-0 ta-font-medium">{{ i + 1 }}</p>

                            <svg-icon
                                class="delete-icon"
                                src="assets/svg/truckassist-table/dropdown/content/delete-hover-new.svg"
                                [svgStyle]="{
                                    'width.px': 18,
                                    'height.px': 18
                                }"
                                (click)="deleteFormArrayRow(i)"
                            ></svg-icon>
                        </div>

                        <!-- Phone -->

                        <app-ta-input
                            formControlName="phone"
                            [inputConfig]="{
                                name: 'Phone',
                                type: 'text',
                                label: 'Phone',
                                placeholderInsteadOfLabel: true,
                                placeholderIcon: 'phone',
                                mask: '(000) 000-0000',
                                maxLength: 14,
                                hideRequiredCheck: true,
                                hideErrorMessage: true,
                                blackInput:
                                    getFormArray().at(i).get('phone').value &&
                                    !isInputHoverRows[i][0]
                            }"
                            (mouseenter)="handleInputHover(true, i, 0)"
                            (mouseleave)="handleInputHover(false, i, 0)"
                        ></app-ta-input>

                        <!-- Phone Extension -->

                        <div>
                            <ng-container *ngIf="!isContactPhoneExtExist[ind]">
                                <div
                                    class="d-flex align-items-center phone-extension-container"
                                    ngbTooltip
                                    mainTooltip="Add Extension"
                                    position="top"
                                    tooltipBackground="#6c6c6c"
                                    (click)="
                                        isContactPhoneExtExist[ind] =
                                            !isContactPhoneExtExist[ind]
                                    "
                                >
                                    <svg-icon
                                        src="assets/svg/common/ic_plus.svg"
                                    ></svg-icon>

                                    <div class="divider"></div>

                                    <p class="m-0">Add Ext.</p>
                                </div>
                            </ng-container>

                            <app-ta-input
                                *ngIf="isContactPhoneExtExist[ind]"
                                formControlName="phoneExt"
                                [inputConfig]="{
                                    name: 'phone-extension',
                                    type: 'text',
                                    label: 'Add Ext.',
                                    placeholderInsteadOfLabel: true,
                                    minLength: 1,
                                    maxLength: 8,
                                    placeholderIcon: 'phone-extension',
                                    hideRequiredCheck: true,
                                    hideErrorMessage: true,
                                    blackInput:
                                        getFormArray().at(i).get('phoneExt')
                                            .value && !isInputHoverRows[i][1]
                                }"
                                (mouseenter)="handleInputHover(true, i, 1)"
                                (mouseleave)="handleInputHover(false, i, 1)"
                            ></app-ta-input>
                        </div>

                        <!-- Phone Type -->

                        <app-ta-input-dropdown
                            formControlName="contactPhoneType"
                            [inputConfig]="{
                                name: 'Input Dropdown',
                                type: 'text',
                                label: 'Type',
                                placeholderInsteadOfLabel: true,
                                textTransform: 'capitalize',
                                isDropdown: true,
                                dropdownWidthClass: 'w-col-110',
                                hideErrorMessage: true,
                                hideRequiredCheck: true,
                                blackInput:
                                    getFormArray().at(i).get('contactPhoneType')
                                        .value && !isInputHoverRows[i][2]
                            }"
                            [activeItem]="selectedContactPhoneType[i]"
                            [options]="contactPhoneTypeOptions"
                            (selectedItem)="
                                onSelectDropdown(
                                    $event,
                                    'contact-phone-type',
                                    i
                                )
                            "
                            (mouseenter)="handleInputHover(true, i, 2)"
                            (mouseleave)="handleInputHover(false, i, 2)"
                        ></app-ta-input-dropdown>
                    </div>
                </ng-container>
            </div>
        </ng-container>

        <!-- Email Table -->

        <ng-container *ngIf="isEmailTable">
            <div class="d-flex flex-column email-table-container">
                <ng-container
                    formArrayName="emailTableItems"
                    *ngFor="
                        let emailItemsRow of getFormArray().controls;
                        let i = index;
                        trackBy: trackByIdentity
                    "
                >
                    <div
                        class="align-items-center table-item"
                        [formGroupName]="i"
                    >
                        <!-- Number & Delete -->

                        <div
                            class="d-flex justify-content-center align-items-center table-item-number"
                        >
                            <p class="m-0 ta-font-medium">{{ i + 1 }}</p>

                            <svg-icon
                                class="delete-icon"
                                src="assets/svg/truckassist-table/dropdown/content/delete-hover-new.svg"
                                [svgStyle]="{
                                    'width.px': 18,
                                    'height.px': 18
                                }"
                                (click)="deleteFormArrayRow(i)"
                            ></svg-icon>
                        </div>

                        <!-- Email -->

                        <app-ta-input
                            formControlName="email"
                            [inputConfig]="{
                                name: 'Email',
                                type: 'text',
                                placeholderIcon: 'email',
                                label: 'Email',
                                placeholderInsteadOfLabel: true,
                                minLength: 5,
                                maxLength: 64,
                                textTransform: 'lowercase',
                                hideErrorMessage: true,
                                hideRequiredCheck: true,
                                blackInput:
                                    getFormArray().at(i).get('email').value &&
                                    !isInputHoverRows[i][0]
                            }"
                            (mouseenter)="handleInputHover(true, i, 0)"
                            (mouseleave)="handleInputHover(false, i, 0)"
                        ></app-ta-input>

                        <!-- Email Type -->

                        <app-ta-input-dropdown
                            formControlName="contactEmailType"
                            [inputConfig]="{
                                name: 'Input Dropdown',
                                type: 'text',
                                label: 'Type',
                                placeholderInsteadOfLabel: true,
                                textTransform: 'capitalize',
                                isDropdown: true,
                                dropdownWidthClass: 'w-col-110',
                                hideErrorMessage: true,
                                hideRequiredCheck: true,
                                blackInput:
                                    getFormArray().at(i).get('contactEmailType')
                                        .value && !isInputHoverRows[i][1]
                            }"
                            [activeItem]="selectedContactEmailType[i]"
                            [options]="contactEmailTypeOptions"
                            (selectedItem)="
                                onSelectDropdown(
                                    $event,
                                    'contact-email-type',
                                    i
                                )
                            "
                            (mouseenter)="handleInputHover(true, i, 1)"
                            (mouseleave)="handleInputHover(false, i, 1)"
                        ></app-ta-input-dropdown>
                    </div>
                </ng-container>
            </div>
        </ng-container>

        <!-- Description Table -->
        <ng-container *ngIf="isDescriptionTable">
            <div class="d-flex flex-column description-table-container">
                <ng-container
                    formArrayName="descriptionTableItems"
                    *ngFor="
                        let descriptionItemRow of getFormArray().controls;
                        let i = index;
                        trackBy: trackByIdentity
                    "
                >
                    <div
                        class="align-items-center table-item description-item"
                        [formGroupName]="i"
                    >
                        <div
                            class="d-flex justify-content-center align-items-center table-item-number"
                        >
                            <p class="m-0 ta-font-medium">{{ i + 1 }}</p>

                            <svg-icon
                                class="delete-icon"
                                src="assets/svg/truckassist-table/dropdown/content/delete-hover-new.svg"
                                [svgStyle]="{
                                    'width.px': 18,
                                    'height.px': 18
                                }"
                                (click)="deleteFormArrayRow(i)"
                            ></svg-icon>
                        </div>

                        <app-ta-input
                            formControlName="description"
                            [inputConfig]="{
                                name: 'description',
                                type: 'text',
                                label: 'Description',
                                placeholderInsteadOfLabel: true,
                                minLength: 5,
                                maxLength: 64,
                                textTransform: 'lowercase',
                                hideErrorMessage: true,
                                hideRequiredCheck: true,
                                blackInput:
                                    getFormArray().at(i).get('description')
                                        .value && !isInputHoverRows[i][0]
                            }"
                            (mouseenter)="handleInputHover(true, i, 0)"
                            (mouseleave)="handleInputHover(false, i, 0)"
                        ></app-ta-input>

                        <app-ta-input-dropdown
                            formControlName="pm"
                            [inputConfig]="{
                                name: 'pm',
                                type: 'text',
                                label: '',
                                placeholderInsteadOfLabel: true,
                                textTransform: 'capitalize',
                                isDropdown: true,
                                dropdownWidthClass: 'w-col-197',
                                hideErrorMessage: true,
                                hideRequiredCheck: true,
                                blackInput:
                                    getFormArray().at(i).get('pm').value &&
                                    !isInputHoverRows[i][1]
                            }"
                            [activeItem]="null"
                            [options]="contactEmailTypeOptions"
                            (selectedItem)="
                                onSelectDropdown(
                                    $event,
                                    'contact-email-type',
                                    i
                                )
                            "
                            (mouseenter)="handleInputHover(true, i, 1)"
                            (mouseleave)="handleInputHover(false, i, 1)"
                        ></app-ta-input-dropdown>

                        <app-ta-input
                            formControlName="qty"
                            [inputConfig]="{
                                name: 'qty',
                                type: 'text',
                                label: 'Qty',
                                placeholderInsteadOfLabel: true,
                                minLength: 5,
                                maxLength: 64,
                                textTransform: 'lowercase',
                                hideErrorMessage: true,
                                hideRequiredCheck: true,
                                blackInput:
                                    getFormArray().at(i).get('qty').value &&
                                    !isInputHoverRows[i][0]
                            }"
                            (mouseenter)="handleInputHover(true, i, 0)"
                            (mouseleave)="handleInputHover(false, i, 0)"
                        ></app-ta-input>

                        <app-ta-input
                            formControlName="price"
                            [inputConfig]="{
                                name: 'price',
                                type: 'text',
                                label: 'Price',
                                placeholderInsteadOfLabel: true,
                                priceSeparator: true,
                                priceSeparatorLimitation: 6,
                                minLength: 5,
                                maxLength: 64,
                                textTransform: 'lowercase',
                                hideErrorMessage: true,
                                hideRequiredCheck: true,
                                blackInput:
                                    getFormArray().at(i).get('price').value &&
                                    !isInputHoverRows[i][0]
                            }"
                            (mouseenter)="handleInputHover(true, i, 0)"
                            (mouseleave)="handleInputHover(false, i, 0)"
                        ></app-ta-input>

                        <ng-container
                            *ngFor="
                                let subtotal of subtotals;
                                trackBy: trackByIdentity
                            "
                        >
                            <ng-container *ngIf="subtotal.index === i">
                                <div
                                    class="subtotal ta-font-semi-bold d-flex justify-content-end"
                                >
                                    <ng-container *ngIf="subtotal.subtotal">
                                        {{ subtotal.subtotal | currency }}
                                    </ng-container>

                                    <ng-container
                                        *ngIf="
                                            subtotal.index === i &&
                                            !subtotal.subtotal
                                        "
                                    >
                                        {{ 0 | currency }}
                                    </ng-container>
                                </div>
                            </ng-container>
                        </ng-container>
                    </div>
                </ng-container>
            </div>
        </ng-container>
    </form>
</div>
