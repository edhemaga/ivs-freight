<div *ngIf="trailer" class="cards-item-wrapper-1">
    <app-ta-details-header-card
        [tooltipNext]="'Next Trailer'"
        [tooltipPrevious]="'Previous Trailer'"
        [cardDetailsDate]="trailer.createdAt | formatDateP"
        [options]="trailerDropDowns"
        [searchInputName]="'Search Trailer'"
        (selectValue)="onSelectedTrailer($event)"
        (changeEvent)="onChangeTrailer($event)"
    >
        <div class="truck-details-wrapper">
            <div class="details-header-avatar">
                <div class="svg-truck-wrapper">
                    <svg-icon
                        class="truck"
                        src="{{
                            'assets/svg/common/trailers/' +
                                trailer?.trailerType?.logoName
                        }}"
                    >
                    </svg-icon>
                </div>

                <div class="model-name">
                    <div class="svg-wrapper">
                        <svg-icon
                            class="details-header-model"
                            src="{{
                                'assets/svg/common/trailermake/' +
                                    trailer?.trailerMake?.logoName
                            }}"
                        >
                        </svg-icon>
                    </div>
                    <p>{{ trailer.model }}</p>
                </div>
            </div>
            <div class="details-header-data">
                <div class="details-header-data-item second">
                    <div *ngIf="trailer.color" class="light-green">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="18"
                            height="18"
                            viewBox="0 0 18 18"
                        >
                            <g transform="translate(-725 -247)">
                                <rect
                                    width="18"
                                    height="18"
                                    transform="translate(725 247)"
                                    fill="none"
                                />
                                <path
                                    d="M16,16.365c0-2.42,3.382-7.593,4.989-9.912a1,1,0,0,1,1.66,0c1.607,2.319,4.989,7.492,4.989,9.912a5.819,5.819,0,1,1-11.638,0Zm3.174,0a.529.529,0,0,0-1.058,0,3.708,3.708,0,0,0,3.7,3.733.529.529,0,1,0,0-1.058A2.651,2.651,0,0,1,19.174,16.365Z"
                                    transform="translate(712.181 241.886)"
                                    [attr.fill]="trailer?.color.code"
                                />
                            </g>
                        </svg>
                    </div>
                    <span *ngIf="trailer.color" class="vin-text">
                        {{ trailer?.color.name }}
                    </span>
                    <svg-icon src="assets/svg/common/year-truck.svg"></svg-icon>
                    <p class="vin-text date">{{ trailer.year }}</p>

                    <div class="light-green">
                        <svg-icon
                            class="resize"
                            src="assets/svg/common/ic_resize.svg"
                        ></svg-icon>
                    </div>
                    <p class="vin-text">{{ trailer?.trailerLength?.name }}</p>
                </div>
                <div class="details-header-data-item second">
                    <svg-icon
                        class="icons-details"
                        src="assets/svg/common/vin.svg"
                    ></svg-icon>
                    <app-ta-copy
                        [textFontSize]="'18px'"
                        [copyValue]="trailer?.vin"
                    >
                    </app-ta-copy>
                </div>
            </div>
        </div>
    </app-ta-details-header-card>
    <div
        class="wrapper-additional-cards"
        [ngClass]="{ 'bind-height': !templateCard }"
    >
        <div class="details-cards">
            <!-- Assigned to -->
            <app-ta-custom-card
                [cardName]="'Assigned To'"
                [hasDivider]="false"
                [tooltipName]="'Dispatch History'"
                [hasHeaderSvg]="'assets/svg/common/ic_half_time.svg'"
                [isCardOpen]="true"
                [bodyTemplate]="'card'"
                class="first-custom-card"
            >
                <div class="assignTo">
                    <div class="assignTo-item first" *ngIf="trailer?.assignedTo?.truck?.id">
                        <svg-icon class="assignTo-vehicle"> </svg-icon>
                        <p class="assignTo-value no-truck">{{trailer.assignedTo.truck.truckNumber}}</p>
                       <span
                            tooltipBackground="#6c6c6c"
                            ngbTooltip
                            mainTooltip="View in Modal"
                            position="top"
                            class="semi-tooltip"
                            >
                            <svg-icon
                                class="open-modal-icon"
                                src="assets/svg/common/arrow_top_right.svg"
                            ></svg-icon>
                        </span>
                    </div>
                    <div class="assignTo-item second" *ngIf="!trailer?.assignedTo?.truck?.id">
                        <p class="assignTo-value no-truck inactive-assignTo-value">No truck</p>
                    </div>
                    <div class="assignTo-item second" *ngIf="trailer?.assignedTo?.driver?.id">
                        <svg-icon class="assignTo-vehicle"></svg-icon>
                        <p class="assignTo-value no-truck">{{trailer?.assignedTo?.driver?.firstName}} {{trailer?.assignedTo?.driver?.lastName}}</p>
                        <span
                            tooltipBackground="#6c6c6c"
                            ngbTooltip
                            mainTooltip="View in Modal"
                            position="top"
                            class="semi-tooltip"
                            >
                            <svg-icon
                                class="open-modal-icon2"
                                src="assets/svg/common/arrow_top_right.svg"
                            ></svg-icon>
                        </span>
                    </div>
                    <div class="assignTo-item second" *ngIf="!trailer?.assignedTo?.driver?.id">
                        <p class="assignTo-value no-truck inactive-assignTo-value">No Driver</p>
                    </div>
                </div>
            </app-ta-custom-card>

            <!-- Additional info -->
            <app-ta-custom-card
                [cardName]="'Additional Details'"
                [isCardOpen]="true"
                [bodyTemplate]="'card'"
            >
                <div
                    *ngIf="
                        trailer?.emptyWeight ||
                        trailer?.mileage ||
                        trailer?.axles ||
                        trailer?.tireSize?.name
                    "
                    class="common-template"
                >
                    <div
                        *ngIf="trailer.emptyWeight"
                        class="common-template-item"
                    >
                        <div class="common-template-item-name">
                            Empty Weight
                        </div>
                        <div class="common-template-item-value">
                            {{ trailer.emptyWeight | taThousandSeparator }} Ibs
                        </div>
                    </div>
                    <div *ngIf="trailer.mileage" class="common-template-item">
                        <div class="common-template-item-name">Mileage</div>
                        <div class="common-template-item-value">
                            {{ trailer.mileage | taThousandSeparator }} mi
                        </div>
                    </div>
                    <div *ngIf="trailer.axles" class="common-template-item">
                        <div class="common-template-item-name">Axles</div>
                        <div class="common-template-item-value">
                            {{ trailer.axles }}
                        </div>
                    </div>
                    <div
                        *ngIf="trailer.tireSize.name"
                        class="common-template-item"
                    >
                        <div class="common-template-item-name">Tire Size</div>
                        <div class="common-template-item-value">
                            {{ trailer.tireSize.name }}
                        </div>
                    </div>
                    <div
                        *ngIf="trailer.suspension.name"
                        class="common-template-item"
                    >
                        <div class="common-template-item-name">Suspension</div>
                        <div class="common-template-item-value">
                            {{ trailer.suspension.name }}
                        </div>
                    </div>

                    <div
                        *ngIf="trailer.insurancePolicy"
                        class="common-template-item"
                    >
                        <div class="common-template-item-name">
                            Insurance Policy
                        </div>
                        <div class="common-template-item-value">
                            {{ trailer.insurancePolicy }}
                        </div>
                    </div>
                </div>
                <div
                    class="no-data-driver-details"
                    *ngIf="
                        !trailer?.emptyWeight &&
                        !trailer?.mileage &&
                        !trailer?.axles &&
                        !trailer?.tireSize?.name
                    "
                >
                    No Additional Details
                </div>
            </app-ta-custom-card>

            <!-- Owner -->
            <app-ta-custom-card
                [cardName]="'Owner'"
                [isCardOpen]="true"
                [bodyTemplate]="'card'"
            >
                <div class="owner-container">
                    <div class="owner-items-name">
                        <span class="firm-name">{{ trailer.owner.name }}</span>
                    </div>
                    <div [@ownerDetailsAnimation]="toggleOwner ? 'true' : 'false'">
                        <div class="wrapper-owner-items">
                            <div class="owner-items">
                                <svg-icon
                                    class="icons-details"
                                    src="assets/svg/common/ic_phone.svg"
                                ></svg-icon>
                                <app-ta-copy
                                    [copyValue]="trailer?.owner?.phone"
                                >
                                </app-ta-copy>
                            </div>
                            <div class="owner-items">
                                <svg-icon
                                    class="icons-details"
                                    src="assets/svg/common/ic_email.svg"
                                ></svg-icon>
                                <app-ta-copy
                                    [copyValue]="trailer?.owner?.email"
                                >
                                </app-ta-copy>
                            </div>
                            <div class="owner-items">
                                <svg-icon
                                    src="assets/svg/common/ic_address.svg"
                                ></svg-icon>
                                <p class="information-value">
                                    {{ trailer.owner.address.address }}
                                </p>
                            </div>
                        </div>
                    </div>
                    <div [ngClass]="{ 'transform-arrow': toggleOwner }">
                        <div
                            (click)="toggleOwner = !toggleOwner"
                            class="icon-show"
                        >
                            <span
                                tooltipBackground="#6c6c6c"
                                ngbTooltip
                                [mainTooltip]="
                                    toggleOwner ? 'HIDE CONTACT' : 'Show More'
                                "
                                position="top"
                            >
                                <svg-icon
                                    class="arrow-down-employment"
                                    src="assets/svg/common/fill_arrow_down.svg"
                                ></svg-icon>
                            </span>
                            <span
                                tooltipBackground="#6c6c6c"
                                ngbTooltip
                                [mainTooltip]="
                                    toggleOwner ? 'Hide Contact' : 'Show More'
                                "
                                position="top"
                                class="hide-show"
                            >
                            </span>
                        </div>
                    </div>
                </div>
            </app-ta-custom-card>

            <!-- Owner History -->
            <app-ta-custom-card
                [cardName]="'Owner History'"
                [isCardOpen]="true"
                [tooltipName]="'View in Modal'"
                [bodyTemplate]="'card'"
                [hasHeaderSvg]="'assets/svg/common/arrow_top_right.svg'"
            >
                <div class="owner-history-container">
                    <div class="status-container">
                        <div class="status-header">
                            <div class="status-item">
                                <p class="p-status">COMPANY</p>
                            </div>
                            <div class="status-item">
                                <p class="p-status">FROM - TO</p>
                            </div>
                            <div class="status-item">
                                <p class="p-status">DURATION</p>
                            </div>
                        </div>
                        <div class="divider"></div>
                        <div
                            class="status-items"
                            *ngFor="
                                let owHist of trailer.ownerHistories | keyvalue: sortKeys;
                                trackBy: identity
                            "
                        >
                            <div class="item-wrapper">
                                <p class="employment">{{ owHist.value.name }}</p>

                                <p class="date-from-to">
                                    {{ owHist.value.startDate | formatDateP }} -
                                    <span *ngIf="owHist.value.endDate">{{
                                        owHist.value.endDate | formatDateP
                                    }}</span>
                                    <span *ngIf="!owHist.value.endDate">Today</span>
                                </p>
                                <p class="duration">
                                    <span *ngIf="owHist.value.duration.Years">{{ owHist.value.duration.Years }} y</span>
                                    <span> {{ owHist.value.duration.Days }} d</span>
                                </p>
                            </div>
                            <div class="divider"></div>
                        </div>
                    </div>
                </div>
            </app-ta-custom-card>
            <app-ta-custom-card
                *ngIf="trailer?.files.length"
                [cardName]="'Document'"
                [isCardOpen]="false"
                [hasCounter]="trailer?.files?.length ? trailer?.files.length : 0"
                class="item-cards"
                [bodyTemplate]="'card'"
            >
                <div class="card_files_holder" [class.active]="trailer?.files?.length > 1">
                    <app-ta-upload-files
                        [files]="trailer?.files"
                        [customClassName]="'driver-card-pdf'"
                        [hasCarouselBottomTabs]="true"
                        [type]="'details'"
                        [slideWidth]="440"
                        [reviewMode]="'REVIEW_MODE'"
                    ></app-ta-upload-files>
                </div>
            </app-ta-custom-card>
            <!-- Note  -->
            <div class="divider"></div>
            <div class="note-cards">
                <app-ta-input-note
                    [formControl]="note"
                    [isVisibleDivider]="false"
                    [isVisibleNote]="true"
                    [isVisibleArrow]="true"
                    [minRows]="1"
                    [placeholder]="'Write something.'"
                    [customClass]="'note-small'"
                    [note]="trailer.note"
                    [noteType]="'details-card'"
                    [entityId]="trailer.id"
                    [entityType]="'Trailer'"
                ></app-ta-input-note>
            </div>
        </div>
        <div *ngIf="templateCard">
            <div class="custom-card-single">
                <app-ta-custom-card
                    [cardName]="'Registration'"
                    [isCardOpen]="false"
                    [hasDivider]="false"
                    class="item-cards"
                    [bodyTemplate]="'card'"
                    [hasCounter]="trailer.registrations.length"
                    [hasPlusHeader]="true"
                >
                    <div
                        *ngFor="
                            let reg of trailer.registrations;
                            let i = index;
                            trackBy: identity
                        "
                    >
                        <app-ta-re-card
                            [cardDocumentCounter]="1"
                            (resizePage)="toggleResizePage(i, 'registration')"
                            [cardNameCommon]="reg.licensePlate"
                            [hasCopyIcon]="true"
                            [options]="dataEdit"
                            [expDateClose]="reg.expDate | formatDateP"
                            [optionsId]="reg.id"
                        >
                            <div class="cards-container">
                                <div class="card-body-cdl">
                                    <div class="card-row-endor">
                                        <div class="card-item">
                                            <div class="card-item-name">
                                                State
                                            </div>
                                            <div class="card-item-value">
                                                KV
                                            </div>
                                        </div>
                                        <div class="card-item">
                                            <div class="card-item-name">
                                                Issued
                                            </div>
                                            <div class="card-item-value">
                                                {{
                                                    reg.issueDate | formatDateP
                                                }}
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="card-row-progress"
                                        [ngClass]="{
                                            'second-progress':
                                                toggler[i + 'registration']
                                        }"
                                    >
                                        <div
                                            class="card-details-progress-container"
                                        >
                                            <app-truckassist-progress-expiration
                                                [expireDate]="
                                                    reg.expDate | formatDateP
                                                "
                                                [startDate]="
                                                    reg.issueDate | formatDateP
                                                "
                                                [expiresSettings]="'details'"
                                            >
                                            </app-truckassist-progress-expiration>
                                        </div>
                                    </div>
                                </div>
                                <div
                                    [@showHideCardBody]="
                                        toggler[i + 'registration']
                                            ? 'true'
                                            : 'false'
                                    "
                                >
                                    <div class="divider"></div>
                                    <div class="card-note">
                                        <app-ta-input-note
                                            [formControl]="registrationNote"
                                            [isVisibleDivider]="false"
                                            [placeholder]="'Write something.'"
                                            [customClass]="'note-small'"
                                            [isVisibleArrow]="false"
                                            [minRows]="1"
                                            [isVisibleNote]="true"
                                            [noteType]="'details-card'"
                                            [entityId]="trailer.id"
                                            [entityType]="'Trailer'"
                                        ></app-ta-input-note>
                                    </div>
                                </div>
                            </div>
                        </app-ta-re-card>
                    </div>
                </app-ta-custom-card>
            </div>

            <div class="custom-card-single">
                <app-ta-custom-card
                    [cardName]="'FHWA Inspection'"
                    [isCardOpen]="false"
                    [hasDivider]="false"
                    class="item-cards"
                    [bodyTemplate]="'card'"
                    [cardDocumentCounter]="1"
                    [hasCounter]="trailer.inspections.length"
                    [hasPlusHeader]="true"
                >
                    <div
                        *ngFor="
                            let fhwa of trailer.inspections;
                            let i = index;
                            trackBy: identity
                        "
                    >
                        <app-ta-re-card
                            [options]="dataEdit"
                            [cardNameCommon]="fhwa.issueDate | formatDateP"
                            [optionsId]="fhwa.id"
                            (resizePage)="toggleResizePage(i, 'inspection')"
                        >
                            <div class="cards-container">
                                <div class="card-body-cdl">
                                    <div
                                        class="card-row-progress"
                                        [ngClass]="{
                                            'second-progress':
                                                toggler[i + 'inspection']
                                        }"
                                    >
                                        <div
                                            class="card-details-progress-container"
                                        >
                                            <app-truckassist-progress-expiration
                                                [expireDate]="
                                                    fhwa.expDate | formatDateP
                                                "
                                                [startDate]="
                                                    fhwa.issueDate | formatDateP
                                                "
                                                [expiresSettings]="'details'"
                                            >
                                            </app-truckassist-progress-expiration>
                                        </div>
                                    </div>
                                </div>
                                <div
                                    [@showHideCardBody]="
                                        toggler[i + 'inspection']
                                            ? 'true'
                                            : 'false'
                                    "
                                >
                                    <div class="divider"></div>
                                    <div class="card-note">
                                        <app-ta-input-note
                                            [formControl]="inspectionNote"
                                            [isVisibleDivider]="false"
                                            [placeholder]="'Write something.'"
                                            [customClass]="'note-small'"
                                            [isVisibleArrow]="false"
                                            [minRows]="1"
                                            [isVisibleNote]="true"
                                            [noteType]="'details-card'"
                                            [entityId]="trailer.id"
                                            [entityType]="'Trailer'"
                                        ></app-ta-input-note>
                                    </div>
                                </div>
                            </div>
                        </app-ta-re-card>
                    </div>
                </app-ta-custom-card>
            </div>

            <div class="custom-card-single">
                <app-ta-custom-card
                    [cardName]="'Title'"
                    [isCardOpen]="false"
                    [hasDivider]="false"
                    class="item-cards"
                    [bodyTemplate]="'card'"
                    [hasCounter]="trailer.titles.length"
                    [hasPlusHeader]="true"
                >
                    <div
                        *ngFor="
                            let title of trailer.titles;
                            let i = index;
                            trackBy: identity
                        "
                    >
                        <app-ta-re-card
                            [cardDocumentCounter]="1"
                            (resizePage)="toggleResizePage(i, 'title')"
                            [cardNameCommon]="title.number"
                            [options]="dataEdit"
                            [optionsId]="title.id"
                        >
                            <div class="cards-container">
                                <div class="card-body-cdl">
                                    <div class="card-row-endor">
                                        <div class="card-item">
                                            <div class="card-item-name">
                                                Purchased
                                            </div>
                                            <div class="card-item-value">
                                                {{
                                                    title.issueDate
                                                        | formatDateP
                                                }}
                                            </div>
                                        </div>
                                        <div class="card-item">
                                            <div class="card-item-name">
                                                Issued
                                            </div>
                                            <div class="card-item-value">
                                                {{
                                                    title.issueDate
                                                        | formatDateP
                                                }}
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="card-row-progress"
                                        [ngClass]="{
                                            'second-progress':
                                                toggler[i + 'title']
                                        }"
                                    >
                                        <div
                                            class="card-details-progress-container"
                                        >
                                            <app-truckassist-progress-expiration
                                                [expireDate]="
                                                    title.issueDate
                                                        | formatDateP
                                                "
                                                [startDate]="
                                                    title.purchaseDate
                                                        | formatDateP
                                                "
                                                [expiresSettings]="'details'"
                                            >
                                            </app-truckassist-progress-expiration>
                                        </div>
                                    </div>
                                </div>
                                <div
                                    [@showHideCardBody]="
                                        toggler[i + 'title'] ? 'true' : 'false'
                                    "
                                >
                                    <div class="divider"></div>

                                    <div class="card-note">
                                        <app-ta-input-note
                                            [formControl]="titleNote"
                                            [placeholder]="'Write something.'"
                                            [customClass]="'note-small'"
                                            [isVisibleArrow]="false"
                                            [minRows]="1"
                                            [isVisibleDivider]="false"
                                            [isVisibleNote]="true"
                                            [noteType]="'details-card'"
                                            [entityId]="trailer.id"
                                            [entityType]="'Trailer'"
                                        ></app-ta-input-note>
                                    </div>
                                </div>
                            </div>
                        </app-ta-re-card>
                    </div>
                </app-ta-custom-card>
            </div>

            <div class="custom-card-single">
                <app-ta-custom-card
                    [cardName]="'Lease / Purchase'"
                    [isCardOpen]="false"
                    [hasDivider]="false"
                    class="item-cards"
                    [bodyTemplate]="'card'"
                    [hasCounter]="0"
                    [hasPlusHeader]="true"
                >
                </app-ta-custom-card>
            </div>
        </div>
    </div>
</div>
