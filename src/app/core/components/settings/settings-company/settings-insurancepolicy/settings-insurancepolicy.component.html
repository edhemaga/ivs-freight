<div class="settings-insurancepolicy">
    <div class="settings-header">
        <div class="settings-name">
            <p>Insurance Policy</p>
        </div>

        <div class="settings-header-button">
            <div class="border-left"></div>
            <svg-icon
                src="assets/svg/common/ic_plus.svg"
                class="settings-plus-button"
                (click)="
                    onAction({
                        modalName: 'insurance-policy',
                        type: 'new',
                        company: insurancePolicyData
                    })
                "
            ></svg-icon>
        </div>
    </div>
    <div class="settings-body">
        <div
            class="settings-insuarnce"
            *ngFor="
                let insurance of insurancePolicyData?.insurancePolicies;
                let i = index;
                trackBy: identity
            "
        >
            <app-ta-re-card
                [cardNameCommon]="insurance?.producerName"
                [haveHeaderText]="true"
                [cardDocumentCounter]="
                    insurance?.files.length ? insurance?.files.length : 0
                "
                [options]="dropOptions"
                [optionsId]="insurance.id"
                (resizePage)="toggleResizePage(i)"
                (dropActions)="optionsEvent($event, insurance)"
                [paddingDots]="'11px 0px 0px 0px'"
                [paddingFooter]="'11px 4px 11px 13px'"
                [insuranceCard]="true"
                [noteIcons]="
                    insurance?.note
                        ? 'assets/svg/truckassist-table/note/Note.svg'
                        : 'assets/svg/truckassist-table/note/Note - Empty.svg'
                "
            >
                <div class="settings-body-items">
                    <div *ngIf="insurance?.phone" class="single-item">
                        <svg-icon
                            class="company-icons"
                            src="assets/svg/common/ic_phone.svg"
                        ></svg-icon>
                        <app-ta-copy [copyValue]="insurance?.phone">
                        </app-ta-copy>
                    </div>
                    <div *ngIf="insurance.email" class="single-item">
                        <svg-icon
                            class="company-icons"
                            src="assets/svg/common/ic_email.svg"
                        ></svg-icon>
                        <app-ta-copy [copyValue]="insurance?.email">
                        </app-ta-copy>
                    </div>
                    <div *ngIf="insurance.address.address" class="single-item">
                        <svg-icon
                            class="company-icons"
                            src="assets/svg/truckassist-table/location-icon.svg"
                        ></svg-icon>
                        <span class="single-item-address">{{
                            insurance?.address?.address
                        }}</span>
                    </div>
                </div>
                <div
                    *ngFor="
                        let insuranceAdditional of insurance?.insurancePolicyAddons;
                        let i = index;
                        trackBy: identity
                    "
                >
                    <app-ta-custom-card
                        [cardName]="
                            insuranceAdditional.insurancePolicyAddonType.name
                        "
                        [bodyTemplate]="'card'"
                        [isCardOpen]="false"
                        [hasDivider]="true"
                    >
                        <div class="insuarance-card-top-container">
                            <div class="name-div-wrapper">
                                <span class="insurer-name">{{
                                    insuranceAdditional?.insurerName
                                }}</span>
                                <div
                                    *ngIf="insuranceAdditional?.rating?.name"
                                    class="rating"
                                >
                                    <div class="rating-value">
                                        {{ insuranceAdditional?.rating?.name }}
                                    </div>
                                </div>
                            </div>
                            <div
                                class="policy-company-wrapper"
                                [ngClass]="{ copied: copyPolicyName[i] }"
                            >
                                <div class="number-of-policy">
                                    {{ insuranceAdditional?.policy }}
                                </div>
                                <span
                                    [tooltipBackground]="
                                        copyPolicyName[i]
                                            ? '#536BC2'
                                            : '#6c6c6c'
                                    "
                                    ngbTooltip
                                    [mainTooltip]="
                                        copyPolicyName[i] ? 'Copied' : 'Copy'
                                    "
                                    position="top"
                                    [autoClose]="false"
                                >
                                    <svg-icon
                                        (mouseleave)="copyPolicyName[i] = false"
                                        class="insurance-copy"
                                        (click)="
                                            copyText(
                                                insuranceAdditional?.policy,
                                                i
                                            )
                                        "
                                        src="assets/svg/common/ic_copy.svg"
                                    ></svg-icon>
                                </span>
                            </div>
                        </div>
                        <div
                            *ngIf="
                                insuranceAdditional.insurancePolicyAddonType
                                    .name === 'Commercial General Liabillity'
                            "
                            class="payroll-template-data"
                        >
                            <div
                                class="payroll-template-item"
                                *ngIf="insuranceAdditional?.eachOccurrence"
                            >
                                <p class="payroll-name">Each Occurrence</p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.eachOccurrence
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>

                            <div
                                class="payroll-template-item"
                                *ngIf="
                                    insuranceAdditional?.damageToRentedPremises
                                "
                            >
                                <p class="payroll-name">Dmg. to Rented Pr.</p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.damageToRentedPremises
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>

                            <div
                                class="payroll-template-item"
                                *ngIf="insuranceAdditional?.medicalExpanses"
                            >
                                <p class="payroll-name">Medical Expanses</p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.medicalExpanses
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>
                            <div
                                class="payroll-template-item"
                                *ngIf="
                                    insuranceAdditional?.personalAndAdvertisingInjury
                                "
                            >
                                <p class="payroll-name">
                                    Pers. and Adv. Injury
                                </p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.personalAndAdvertisingInjury
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>
                            <div
                                class="payroll-template-item"
                                *ngIf="insuranceAdditional?.generalAggregate"
                            >
                                <p class="payroll-name">General Aggregate</p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.generalAggregate
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>
                            <div
                                class="payroll-template-item"
                                *ngIf="
                                    insuranceAdditional?.productsCompOperAggregate
                                "
                            >
                                <p class="payroll-name">Products - Comp / OP</p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.productsCompOperAggregate
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>
                        </div>

                        <div
                            *ngIf="
                                insuranceAdditional.insurancePolicyAddonType
                                    .name === 'Autmobile Liabillity'
                            "
                            class="payroll-template-data"
                        >
                            <div
                                class="payroll-template-item"
                                *ngIf="insuranceAdditional?.combinedSingleLimit"
                            >
                                <p class="payroll-name">Combined Single</p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.combinedSingleLimit
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>
                            <div
                                class="payroll-template-item"
                                *ngIf="insuranceAdditional?.propertyDamage"
                            >
                                <p class="payroll-name">Property Damage</p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.propertyDamage
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>
                            <div
                                class="payroll-template-item"
                                *ngIf="insuranceAdditional?.bodilyInjuryPerson"
                            >
                                <p class="payroll-name">
                                    Boldly Injury(Person)
                                </p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.bodilyInjuryPerson
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>
                            <div
                                class="payroll-template-item"
                                *ngIf="
                                    insuranceAdditional?.bodilyInjuryAccident
                                "
                            >
                                <p class="payroll-name">
                                    Boldly Injury(Accident)
                                </p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.bodilyInjuryAccident
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>
                        </div>

                        <div
                            *ngIf="
                                insuranceAdditional.insurancePolicyAddonType
                                    .name === 'Motor Truck Cargo Breakdown'
                            "
                            class="payroll-template-data"
                        >
                            <div
                                class="payroll-template-item"
                                *ngIf="insuranceAdditional?.singleConveyance"
                            >
                                <p class="payroll-name">Single Conveyance</p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.singleConveyance
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>
                            <div
                                class="payroll-template-item"
                                *ngIf="insuranceAdditional?.deductable"
                            >
                                <p class="payroll-name">Deductable</p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.deductable
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>
                        </div>

                        <div
                            *ngIf="
                                insuranceAdditional.insurancePolicyAddonType
                                    .name === 'Physical Damage'
                            "
                            class="payroll-template-data"
                        >
                            <div
                                class="payroll-template-item"
                                *ngIf="
                                    insuranceAdditional?.comprehensiveAndCollision
                                "
                            >
                                <p class="payroll-name">
                                    Comprehen. & Collision
                                </p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.comprehensiveAndCollision
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>
                            <div
                                class="payroll-template-item"
                                *ngIf="insuranceAdditional?.deductable"
                            >
                                <p class="payroll-name">Deductable</p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.deductable
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>
                        </div>

                        <div
                            *ngIf="
                                insuranceAdditional.insurancePolicyAddonType
                                    .name === 'Trailer Interchange'
                            "
                            class="payroll-template-data"
                        >
                            <div
                                class="payroll-template-item"
                                *ngIf="insuranceAdditional?.value"
                            >
                                <p class="payroll-name">Value</p>
                                <p class="payroll-value">
                                    ${{
                                        insuranceAdditional?.value
                                            | taThousandSeparator
                                    }}
                                </p>
                            </div>
                        </div>
                    </app-ta-custom-card>
                </div>
                <div class="divider"></div>
                <div class="settings-progress-container">
                    <app-truckassist-progress-expiration
                        [expireDate]="insurance.expires | formatDateP"
                        [startDate]="insurance.issued | formatDateP"
                        [expiresSettings]="'settings-insurance-policy'"
                    ></app-truckassist-progress-expiration>
                </div>
                <div
                    [ngClass]="{ 'body-show': toggler[i] }"
                    [@showHideCardBody]="toggler[i] ? 'true' : 'false'"
                >
                    <div class="divider" *ngIf="insurance?.files?.length"></div>
                    <div
                        class="details-document-container"
                        *ngIf="insurance?.files?.length"
                    >
                        <div class="icon-counter-wrapper">
                            <div class="counter-text-wrapper">
                                <app-ta-counter
                                    [countBackgroud]="'#F3F3F3'"
                                    [countHeight]="'24px'"
                                    [countWidth]="'24px'"
                                    [count]="
                                        insurance?.files.length
                                            ? insurance?.files.length
                                            : 0
                                    "
                                >
                                </app-ta-counter>
                                <p class="details-document-name">Document</p>
                            </div>
                            <svg-icon
                                (click)="onFileAction('download')"
                                src="assets/svg/common/ic_download.svg"
                            >
                            </svg-icon>
                        </div>
                    </div>
                    <div
                        *ngIf="insurance?.files?.length"
                        class="card-pdf"
                        [class.extended]="insurance?.files?.length > 1"
                        [class.disabled]="!insurance?.files?.length"
                    >
                        <app-ta-upload-files
                            [files]="insurance?.files"
                            [customClassName]="'company-details-pdf'"
                            [slideWidth]="390"
                            [type]="'details'"
                            [hasCarouselBottomTabs]="true"
                            [reviewMode]="'REVIEW_MODE'"
                        ></app-ta-upload-files>
                    </div>
                    <div class="divider"></div>
                    <div class="card-note">
                        <app-ta-input-note
                            [formControl]="insuranceNote"
                            [isVisibleDivider]="false"
                            [isVisibleNote]="true"
                            [isVisibleArrow]="false"
                            [minRows]="1"
                            [placeholder]="'Write something.'"
                            [customClass]="'note-small'"
                            [noteType]="'details-card'"
                            [note]="
                                insurance.note && insurance.note != 'null'
                                    ? insurance.note
                                    : ''
                            "
                            [entityId]="insurance.id"
                            [entityType]="'InsurancePolicy'"
                        >
                        </app-ta-input-note>
                    </div>
                </div>
            </app-ta-re-card>
        </div>
    </div>
</div>
