<!-- (mouseenter)="onHoveredNavigation(true)"
(mouseleave)="onHoveredNavigation(false)" -->
<div class="navigation">
    <div
        class="nav-holder"
        #navbar
        [ngClass]="isNavigationHovered == true ? 'dark-nav' : 'animation'"
    >
        <div class="navigation-top">
            <app-navigation-header
                (click)="onHoveredNavigation(true)"
                [isNavigationHovered]="isNavigationHovered"
            ></app-navigation-header>

            <app-navigation-modals
                (click)="onHoveredNavigation(true)"
                [isNavigationHoveredAndPanelOpen]="
                    isModalPanelOpen && isNavigationHovered
                "
            ></app-navigation-modals>
        </div>

        <div
            class="navigation-middle"
            (mouseenter)="onMidleNavHover(true); onFooterHover(false)"
            (mouseleave)="onMidleNavHover(false); onFooterHover(false)"
        >
            <div class="navigation-routes-container">
                <div
                    class="navigation-routes"
                    *ngFor="
                        let item of navigation;
                        let ind = index;
                        trackBy: identity
                    "
                    [ngClass]="{
                        'new-magic-line-selected':
                            isActiveRouteOnReload(item.name) ||
                            routeIndexSelected == ind
                    }"
                >
                    <app-navigation-route
                        [activeLink]="item.isRouteActive"
                        *ngIf="!item.arrow"
                        [class]="'close'"
                        [route]="item"
                        [message]="item.messages"
                        [files]="item.files"
                        [index]="ind"
                        [isActiveFooterRoute]="isActiveFooterRoute"
                        [isNavigationHovered]="isNavigationHovered"
                        [isActiveSubroute]="isActiveSubroute"
                        (onRouteEvent)="onRouteEvent($event)"
                        [selectedRoute]="selectedRoute"
                        [selectedSubRoute]="selectedSubRoute"
                        [middleIsHovered]="middleIsHovered"
                        (itemIndex)="routeIndex($event)"
                    >
                    </app-navigation-route>

                    <!-- If route has subroutes -->
                    <app-navigation-subroute-card
                        (click)="onHoveredNavigation(true)"
                        *ngIf="item.arrow"
                        [isNavigationCardActive]="
                            item.isRouteActive &&
                            isNavigationHovered &&
                            closeDropdownOnNavClose &&
                            !isModalPanelOpen &&
                            !isUserPanelOpen &&
                            !isSettingsPanelOpen &&
                            !isUserCompanyDetailsOpen
                        "
                        [isNavigationHovered]="isNavigationHovered"
                        [contentHeight]="item.route.length"
                        (subrouteContainerActive)="
                            isSubrouteContainerOpen($event)
                        "
                    >
                        <app-navigation-route
                            class="subroute-item"
                            [route]="item"
                            [selectedRoute]="selectedRoute"
                            [activeLink]="item.isRouteActive"
                            [isSettingsPanelOpen]="isSettingsPanelOpen"
                            [isUserPanelOpen]="isUserPanelOpen"
                            [isNavigationHovered]="isNavigationHovered"
                            [closeDropdownOnNavClose]="closeDropdownOnNavClose"
                            [isActiveSubroute]="isActiveSubroute"
                            (onRouteEvent)="onRouteEvent($event)"
                            (itemIndex)="routeIndex($event)"
                        >
                        </app-navigation-route>

                        <app-navigation-subroute
                            *ngIf="
                                isNavigationHovered &&
                                item.isRouteActive &&
                                !isModalPanelOpen &&
                                closeDropdownOnNavClose &&
                                !isUserPanelOpen &&
                                !isSettingsPanelOpen &&
                                !isUserCompanyDetailsOpen
                            "
                            [subroute]="item"
                            [index]="ind"
                            [selectedSubRoute]="selectedSubRoute"
                            [isActiveSubroute]="isActiveSubroute"
                            [isNavigationHovered]="isNavigationHovered"
                            (onSubrouteActiveEvent)="onRouteEvent($event)"
                            (subRouteIndex)="routeIndex($event)"
                        >
                        </app-navigation-subroute>
                    </app-navigation-subroute-card>
                </div>
                <div
                    *ngIf="
                        (middleIsHovered &&
                            !isSettingsPanelOpen &&
                            !isActiveSubroute &&
                            !subrouteContainerOpened &&
                            !isUserPanelOpen) ||
                        (isNavigationHovered &&
                            footerRouteActive &&
                            !footerHovered &&
                            !isActiveSubroute &&
                            !isSettingsPanelOpen &&
                            !subrouteContainerOpened &&
                            !isUserCompanyDetailsOpen &&
                            !isUserPanelOpen &&
                            selectedRoute != 'Settings')
                    "
                    [@showHideDetails]="
                        !isActiveSubroute &&
                        isModalPanelOpen &&
                        !footerRouteActive &&
                        isActiveMagicLine &&
                        isNavigationHovered
                            ? 'false'
                            : 'true'
                    "
                    class="new-magic-line"
                    [ngClass]="{
                        'animate-magic-line': isNavigationHovered,
                        'magic-line-width': !isNavigationHovered
                    }"
                ></div>
            </div>
        </div>
        <!-- Open nav on click -->
        <div class="open-navigation" *ngIf="isNavigationHovered"></div>
        <div
            class="navigation-bottom"
            (mouseenter)="onMidleNavHover(false); onFooterHover(true)"
            (mouseleave)="onMidleNavHover(false); onFooterHover(false)"
        >
            <app-navigation-footer
                (click)="onHoveredNavigation(true)"
                [isNavigationHovered]="isNavigationHovered"
                [isUserCompanyDetailsOpen]="isUserCompanyDetailsOpen"
                [isSettingsPanelOpen]="isSettingsPanelOpen"
                [isUserPanelOpen]="isUserPanelOpen"
                [isModalPanelOpen]="isModalPanelOpen"
                [isActiveFooterRouteClick]="isActiveFooterRoute"
                [showHideLineIfSettingsActive]="middleIsHovered"
                [isActiveSubroute]="isActiveSubroute"
                [selectedRoute]="selectedRoute"
                [selectedSubRoute]="selectedSubRoute"
                [subrouteContainerOpened]="subrouteContainerOpened"
                (onActivateFooterRoutes)="onActivateFooterRoute($event)"
            >
            </app-navigation-footer>
            <app-navigation-user-profile
                (click)="onHoveredNavigation(true)"
                [isNavigationHovered]="
                    isNavigationHovered && !isUserCompanyDetailsOpen
                "
                [isUserPanelOpen]="isUserPanelOpen"
                [companiesExists]="companiesExists"
            >
            </app-navigation-user-profile>

            <app-navigation-user-company
                (click)="onHoveredNavigation(true)"
                [isNavigationHoveredAndPanelOpen]="
                    isUserCompanyDetailsOpen && isNavigationHovered
                "
                (companiesExists)="oneUserCompany($event)"
            ></app-navigation-user-company>
        </div>
    </div>
</div>
