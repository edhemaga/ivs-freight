<div cdkDrag class="modal-container">
  <div cdkDragHandle class="modal-header">
    <h5 class="modal-title">{{ modalTitle }}</h5>
    <svg-icon
      (click)="activeModal.dismiss('Modal close')"
      [svgStyle]="{ 'width.px': 16, 'height.px': 16 }"
      class="modal-close-btn cursor-pointer"
      src="assets/img/svgs/table/close.svg"
    ></svg-icon>
  </div>
  <div class="divider">
  </div>
  <div class="modal-body manage-customer-modal static-element">
    <!-- <app-loading-modal *ngIf="!loaded" class='large'></app-loading-modal> -->
    <app-tab-switcher
      (switchClicked)="tabChange($event)"
      [tabs]="tabs"
    ></app-tab-switcher>
    <form
      (keydown)="keyDownFunction($event)"
      *ngIf="loaded"
      [formGroup]="shipperForm"
      class="form-container"
    >
      <div class="col-12">
        <div class="row static-element pt-2">
          <div class="col-12">
            <div class="form-label-group" [ngClass]="inputText ? 'typing' : 'not-typing'">
              <input
                (keydown)="onCheckBackSpace($event)"
                (keypress)="onBusinessName($event)"
                (paste)="onPaste($event, 'name')"
                [modalType]="inputData.data.type"
                appAutoFocus
                appInputFocus
                class="form-control input-control required"
                formControlName="name"
                id="name"
                placeholder="Business name"
                (keyup)="onKeyUpMethod($event)"
              >
              <div (click)="clearInput($event)" class="clear-button" ngbTooltip="Clear" placement="bottom-left">
              </div>
              <label class="required-label" for="name">Business name</label>
              <app-required-label [control]="shipperForm.controls.name"></app-required-label>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-4">
            <div
              class="form-label-group input-icon phone-field-wrapper input-holder {{ manageInputValidation(shipperForm.controls.phone) }}"  [ngClass]="inputText ? 'typing' : 'not-typing'">
              <input
                appInputFocus
                class="form-control input-control phone-input"
                formControlName="phone"
                id="phone"
                mask="(000) 000-0000"
                placeholder="Phone"
                (keyup)="onKeyUpMethod($event)"
              >
              <svg-icon
                class="default-icon"
                src="../../../../../assets/img/form-validation/phone-icon-default.svg"
              >
              </svg-icon>

              <svg-icon
                (click)="clearInput($event)" class="clear-icon" ngbTooltip="Clear"
                placement="bottom-left"
                src="../../../../../assets/img/form-validation/x-icon-cut.svg"
              ></svg-icon>
              <div (click)="clearInput($event)" class="clear-button" ngbTooltip="Clear" placement="bottom-left">
              </div>
              <label class="required-label" for="phone">Phone</label>
              <p *ngIf="shipperForm.get('phone').errors  && shipperForm.get('phone').touched"
                 class="m-0 required-notice invalid-length">{{shipperForm.get('phone').errors | inputError}} </p>
            </div>
          </div>
          <div class="col-8">
            <div
              class="form-label-group input-icon email-field-wrapper input-holder {{ manageInputValidation(shipperForm.controls.email) }}" [ngClass]="inputText ? 'typing' : 'not-typing'">
              <input
                (keydown)="onCheckBackSpace($event)"
                (keypress)="onEmailTyping($event)"
                (paste)="onPaste($event, 'email')"
                appInputFocus
                class="form-control input-control email-input"
                formControlName="email"
                id="email"
                oninput="this.value = this.value.replace(/[ ]|^ /g,'')"
                placeholder="Email"
                (keyup)="onKeyUpMethod($event)"
              >
              <svg-icon
              class="default-icon"
              src="../../../../../assets/img/form-validation/mail-icon-default.svg"
            >
            </svg-icon>

              <svg-icon
                (click)="clearInput($event)" class="clear-icon" ngbTooltip="Clear"
                placement="bottom-left"
                src="../../../../../assets/img/form-validation/x-icon-cut.svg"
              ></svg-icon>

              <div (click)="clearInput($event)" class="clear-button" ngbTooltip="Clear" placement="bottom-left">
              </div>
              <label class="required-label" for="email">Email</label>
              <p *ngIf="shipperForm.get('email').errors  && shipperForm.get('email').touched"
                 class="m-0 required-notice invalid-length">{{shipperForm.get('email').errors | inputError}} </p>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-10">
            <div
              class="form-label-group input-icon address-field-wrapper input-holder {{ manageInputValidation(shipperForm.controls.address) }}" [ngClass]="inputText ? 'typing' : 'not-typing'">
              <input
                #placesRef="ngx-places"
                (keydown)="addressKeyDown()"
                (onAddressChange)="handleAddressChange($event)"
                [options]="options"
                appInputFocus
                class="form-control input-control required address-input"
                formControlName="address"
                id="address"
                ngx-google-places-autocomplete
                oninput="this.value = this.value.replace(/[^A-Za-z0-9-,.;'&/.() ]|^ /g,'')"
                placeholder="Address, City, State Zip"
                (keyup)="onKeyUpMethod($event)"
              ><svg-icon
              class="default-icon"
              src="../../../../../assets/img/form-validation/address-icon-default.svg"
            >
            </svg-icon>

              <svg-icon
                (click)="clearInput($event)" class="clear-icon" ngbTooltip="Clear"
                placement="top"
                src="../../../../../assets/img/form-validation/x-icon-cut.svg"
              ></svg-icon>

              <label class="required-label" for="address">Address, City, State Zip</label>
              <p *ngIf="shipperForm.get('address').errors && shipperForm.get('address').touched"
                 class="m-0 required-notice invalid-length">{{shipperForm.get('address').errors | inputError}} </p>
              <!-- <app-required-label [control]="shipperForm.controls.address"></app-required-label> -->
            </div>
          </div>
          <div class="col-2">
            <div class="form-label-group" [ngClass]="inputText ? 'typing' : 'not-typing'">
              <input
                (keydown)="onCheckBackSpace($event)"
                (keypress)="onNameTyping($event)"
                class="form-control input-control"
                formControlName="addressUnit"
                id="addressUnit"
                maxlength="6"
                oninput="this.value = this.value.replace(/[^A-Za-z0-9-,.;'&/.() ]|^ /g,'')"
                placeholder="Unit#"
                (keyup)="onKeyUpMethod($event)"
              >
              <div (click)="clearInput($event)" class="clear-button" ngbTooltip="Clear" placement="bottom-left">
              </div>
              <label for="addressUnit">Unit#</label>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-7 switch-hold">
            <app-tab-switcher
              (switchClicked)="tabChange($event)"
              [tabs]="tabs"
            >
            </app-tab-switcher>
          </div>
          <div class="col-5 receiving_hours_holder">
            <div *ngIf="tab == 1" class="d-flex">
              <div class="form-label-group no-padding-input" [ngClass]="inputText ? 'typing' : 'not-typing'">
                <input
                  appInputFocus
                  class="form-control input-control required"
                  formControlName="fromReceivedHours"
                  id="receivingHours"
                  mask="00:00:00"
                  oninput="this.value = this.value.replace(/[^A-Za-z0-9-,.;'&/.() ]|^ /g,'')"
                  placeholder="Receiving hours"
                  (keyup)="onKeyUpMethod($event)"
                >
                <div (click)="clearInput($event)" class="clear-button" ngbTooltip="Clear" placement="bottom-left">
                </div>
                <label class="required-label" for="receivingHours">From</label>
                <app-required-label [control]="shipperForm.controls.fromReceivedHours"></app-required-label>
              </div>
              <div class="form-label-group no-padding-input">
                <input
                  appInputFocus
                  class="form-control input-control required"
                  formControlName="toReceivedHours"
                  id="receivingHours"
                  mask="00:00:00"
                  oninput="this.value = this.value.replace(/[^A-Za-z0-9-,.;'&/.() ]|^ /g,'')"
                  placeholder="Receiving hours"
                  (keyup)="onKeyUpMethod($event)"
                >
                <div (click)="clearInput($event)" class="clear-button" ngbTooltip="Clear" placement="bottom-left">
                </div>
                <label class="required-label" for="receivingHours">To</label>
                <app-required-label [control]="shipperForm.controls.toReceivedHours"></app-required-label>
              </div>
            </div>
          </div>
          <!-- <div class="col-4">
            <div class="form-label-group no-padding-input">
              <input
                id="receivingHours"
                class="form-control input-control"
                placeholder="Receiving hours"
                appInputFocus
                formControlName="receivingHours"
                oninput="this.value = this.value.replace(/[^A-Za-z0-9-,.;'&/.() ]|^ /g,'')"
                mask="00:00:00 - 00:00:00"
              >
              <label for="receivingHours">Receiving hours</label>
            </div>
          </div>
          <div class="col-4">
            <div class="btn-group btn-group-toggle">
              <label class="btn-primary" ngbButtonLabel>
                <input type="checkbox" ngbButton [checked]="true" formControlName="appointments">
                Appointments
              </label>
            </div>
          </div> -->
        </div>

        <div class="row mt-3">
          <div class="col-12 note-wrapper{{ showNote ? ' visible-note' : ' hidden-note' }}">
            <div (click)="openNote()" class="note-label-wrapper">
              <span class="note-label">Note</span>
              <svg-icon
                class="down-icon"
                src="assets/img/svgs/down-arrow.svg"
              ></svg-icon>
            </div>
            <div class="example-full-width note-input{{ showNote ? ' note-visible' : ' note-hidden' }}">
                <textarea
                  #note
                  cdkAutosizeMaxRows="5"
                  cdkAutosizeMinRows="2"
                  cdkTextareaAutosize
                  class="input-custom-textarea form-textarea"
                  formControlName="mainNote"
                  placeholder="Write a note."
                ></textarea>
            </div>
          </div>
        </div>

        <div formArrayName="contactPersons">
          <div *ngFor="let item of contactPersonsFormGroup.controls; let i = index">
            <div [formGroupName]="i">
              <div class="row">
                <div class="col-12">
                  <hr>
                </div>
                <div class="col-12">
                  <div class="form-label-group" [ngClass]="inputText ? 'typing' : 'not-typing'">
                    <!-- appInputrestriction="[A-Za-z]" -->
                    <input
                      (keydown)="onCheckBackSpace($event)"
                      (keypress)="onContactNameTyping($event)"
                      (paste)="onPaste($event, 'name', i)"
                      class="form-control input-control"
                      formControlName="name"
                      id="name{{i}}"
                      oninput="this.value = this.value.replace(/[^A-Za-z0-9-,.;'&/.() ]|^ /g,'')"
                      placeholder="Contact name"
                      (keyup)="onKeyUpMethod($event)"
                    >
                    <div (click)="clearInput($event)" class="clear-button" ngbTooltip="Clear" placement="bottom-left">
                    </div>
                    <label for="name{{i}}">Contact name</label>
                  </div>
                </div>
                <div class="col-4">
                  <div
                    class="form-label-group input-icon phone-field-wrapper"
                    [ngClass]="inputText ? 'typing' : 'not-typing'">
                    <input
                      appInputFocus
                      class="form-control input-control required phone-input"
                      formControlName="phone"
                      id="phone"
                      mask="(000) 000-0000"
                      placeholder="Phone"
                      (keyup)="onKeyUpMethod($event)"
                    >
                    <svg-icon
                      class="default-icon"
                      src="../../../../../assets/img/form-validation/phone-icon-default.svg"
                    >
                    </svg-icon>

                    <svg-icon
                      (click)="clearInput($event)" class="clear-icon" ngbTooltip="Clear"
                      placement="bottom-left"
                      src="../../../../../assets/img/form-validation/x-icon-cut.svg"
                    ></svg-icon>
                    <div (click)="clearInput($event)" class="clear-button" ngbTooltip="Clear" placement="bottom-left">
                    </div>
                    <label class="required-label" for="phone">Phone</label>
                    <p *ngIf="shipperForm.get('phone').errors  && shipperForm.get('phone').touched"
                       class="m-0 required-notice invalid-length">{{shipperForm.get('phone').errors | inputError}} </p>

                  </div>
                </div>
                <div class="col-7">
                  <div
                    class="form-label-group input-icon email-field-wrapper no-padding-input contactEmail {{ manageInputValidation(shipperForm.controls.email) }}"
                    [ngClass]="inputText ? 'typing' : 'not-typing'"
                  >
                    <input
                      (keydown)="onCheckBackSpace($event)"
                      (keypress)="onEmailTyping($event)"
                      (paste)="onPaste($event, 'email', i)"
                      appInputFocus
                      class="form-control input-control contactEmail email-input"
                      formControlName="email"
                      id="email{{i}}"
                      oninput="this.value = this.value.replace(/[ ]|^ /g,'')"
                      placeholder="Email"
                      (keyup)="onKeyUpMethod($event)"
                    >
                    <svg-icon
                      class="default-icon"
                      src="../../../../../assets/img/form-validation/mail-icon-default.svg"
                    >
                    </svg-icon>

                    <svg-icon
                      (click)="clearInput($event)" class="clear-icon" ngbTooltip="Clear"
                      placement="bottom-left"
                      src="../../../../../assets/img/form-validation/x-icon-cut.svg"
                    ></svg-icon>

                    <div (click)="clearInput($event)" class="clear-button" ngbTooltip="Clear" placement="bottom-left">
                    </div>
                    <label class="required-label" for="email">Email</label>
                    <p *ngIf="shipperForm.get('email').errors  && shipperForm.get('email').touched"
                       class="m-0 required-notice invalid-length">{{shipperForm.get('email').errors | inputError}} </p>
                  </div>
                </div>
                <div class="col-1">
                  <a (click)="removeContact(i)" class="text-black-50 removeItem ">×</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!--
        <br>
        <a
        *ngIf="contactPersonsFormGroup.controls.length < 2"
        href="javascript:void(0)"
        class="text-underline"
        (click)="addNewContactPerson()"
        >{{ contactPersonsList.controls.length === 0 ? 'Add contact' : 'Add additional contact' }}</a
      > -->
    </form>
  </div>
  <div class="modal-footer">
    <button class="save-btn" [ngClass]="{'invalid-btn' : !shipperForm.valid}">
      <p class="m-0">Save</p>
    </button>
  </div>
</div>
