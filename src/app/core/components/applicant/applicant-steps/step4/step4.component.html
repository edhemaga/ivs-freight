<div class="d-flex flex-column align-items-center step-container">
  <h1 class="m-0 step-title text-center noselect ta-font-bold">
    Accident record
  </h1>

  <!-- TOP SECTION -->

  <div class="d-flex justify-content-center text-center top-section">
    <p class="m-0 noselect ta-font-bold">
      Please list all motor vehicle collisions in which you were involved<br />
      (both commercial and private vehicle) during the past 3 years prior to the
      application date.
    </p>
  </div>

  <!-- MID SECTION -->

  <div
    class="d-flex judtify-content-center text-center mid-section"
    [formGroup]="accidentForm"
  >
    <app-ta-checkbox
      formControlName="hasPastAccident"
      [name]="'hasPastAccident'"
      [label]="'No accidents for past 3 years'"
      [customClass]="'bold-12'"
    ></app-ta-checkbox>
  </div>

  <div
    class="d-flex flex-column form-section"
    *ngIf="!accidentForm.get('hasPastAccident').value"
  >
    <!-- CREATED ACCIDENT DATA -->

    <div
      class="d-flex flex-column justify-content-center accident-view-container"
      *ngIf="accidentArray.length"
    >
      <div
        class="d-flex flex-column"
        *ngFor="
          let accident of accidentArray;
          let i = index;
          trackBy: trackByIdentity
        "
      >
        <div
          class="d-flex align-items-center title-container"
          *ngIf="
            (accidentArray.length > 1 && helperIndex !== 0 && i === 0) ||
            (helperIndex === 0 && i === 1)
          "
        >
          <div class="d-flex align-items-center date-title-box">
            <p class="m-0 ta-font-bold">DATE <span>*</span></p>
          </div>
          <div class="d-flex align-items-center state-title-box">
            <p class="m-0 ta-font-bold">STATE <span>*</span></p>
          </div>
          <div class="d-flex align-items-center fatalities-title-box">
            <p class="m-0 ta-font-bold">FAT.</p>
          </div>
          <div class="d-flex align-items-center injuries-title-box">
            <p class="m-0 ta-font-bold">INJ.</p>
          </div>
          <div class="d-flex align-items-center hazmat-title-box">
            <p class="m-0 ta-font-bold">H. SPILL <span>*</span></p>
          </div>
          <div class="d-flex align-items-center description-title-box">
            <p class="m-0 ta-font-bold">DESCRIPTION <span>*</span></p>
          </div>
        </div>

        <div
          class="d-flex align-items-center accident-info-container"
          *ngIf="!accident.isEditingAccident"
        >
          <div class="d-flex align-items-center date-box">
            <p class="m-0 ta-font-regular">
              {{ accident.accidentDate }}
            </p>
          </div>
          <div class="d-flex align-items-center state-box">
            <p class="m-0 ta-font-regular">
              {{ accident.accidentState }}
            </p>
          </div>
          <div class="d-flex align-items-center fatalities-box">
            <p class="m-0 ta-font-regular">
              {{ accident.fatalities }}
            </p>
          </div>
          <div class="d-flex align-items-center injuries-box">
            <p class="m-0 ta-font-regular">
              {{ accident.injuries }}
            </p>
          </div>
          <div class="d-flex align-items-center hazmat-box">
            <p class="m-0 ta-font-regular">
              {{ accident.hazmatSpill }}
            </p>
          </div>
          <div class="d-flex align-items-center description-box">
            <p
              class="m-0 ta-font-regular d-inline-block text-truncate"
              style="max-width: 207px"
              [appTooltip]="accident.accidentDescription"
              tooltipColor="#FFFFFF"
              tooltipBackground="#6C6C6C"
              position="bottom-right"
              borderRadius="2px"
              fontSize="11px"
              fontWeight="bold"
            >
              {{ accident.accidentDescription }}
            </p>
          </div>
          <div class="d-flex align-items-center btn-container">
            <svg-icon
              class="edit-icon"
              src="assets/svg/truckassist-table/dropdown/content/edit-hover.svg"
              [svgStyle]="{
                'width.px': 18,
                'height.px': 18
              }"
              appTooltip="Edit"
              tooltipColor="#FFFFFF"
              tooltipBackground="#6C6C6C"
              position="top-middle"
              borderRadius="2px"
              fontSize="11px"
              fontWeight="bold"
              (click)="onEditAccident(i)"
            ></svg-icon>

            <svg-icon
              class="delete-icon"
              src="assets/svg/truckassist-table/dropdown/content/delete.svg"
              [svgStyle]="{
                'width.px': 18,
                'height.px': 18
              }"
              appTooltip="Delete"
              tooltipColor="#FFFFFF"
              tooltipBackground="#EF5350"
              position="top-middle"
              borderRadius="2px"
              fontSize="11px"
              fontWeight="bold"
              (click)="onDeleteAccident(i)"
            ></svg-icon>
          </div>
        </div>

        <div
          class="d-flex flex-column accident-view-form"
          *ngIf="accident.isEditingAccident"
        >
          <app-step4-form
            [form]="accidentForm"
            [handleInputSelect]="handleInputSelect"
            [onIncrementDecrementCounter]="onIncrementDecrementCounter"
            [truckType]="truckType"
            [fatalitiesCounter]="fatalitiesCounter"
            [injuriesCounter]="injuriesCounter"
            [answerChoices]="answerChoices"
          ></app-step4-form>

          <div
            class="d-flex align-items-center mx-auto justify-content-center btn-container"
          >
            <button
              type="button"
              class="d-flex justify-content-center align-items-center ta-font-semi-bold add-btn cancel-btn"
              (click)="onCancelEditAccident()"
            >
              Cancel
            </button>
            <button
              type="button"
              class="d-flex justify-content-center align-items-center ta-font-semi-bold add-btn save-btn"
              [ngClass]="{
                disabled: !isAccidentEdited
              }"
              (click)="onSaveEditedAccident()"
            >
              Save Changes
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- FORM SECTION -->

    <form *ngIf="!isEditing">
      <app-step4-form
        [form]="accidentForm"
        [handleInputSelect]="handleInputSelect"
        [onIncrementDecrementCounter]="onIncrementDecrementCounter"
        [truckType]="truckType"
        [fatalitiesCounter]="fatalitiesCounter"
        [injuriesCounter]="injuriesCounter"
        [answerChoices]="answerChoices"
      ></app-step4-form>
    </form>

    <!-- ADD ANOTHER ACCIDENT -->

    <div
      class="d-flex justify-content-center align-items-center add-more-accident-container"
    >
      <button
        type="button"
        class="d-flex justify-content-center align-items-center ta-font-bold add-btn"
        (click)="onAddAccident()"
        [ngClass]="{
          disabled: accidentForm.invalid
        }"
        *ngIf="!isEditing"
      >
        <svg-icon
          class="plus-icon"
          src="assets/svg/common/ic_plus.svg
      "
          [svgStyle]="{
            'width.px': 18,
            'height.px': 18
          }"
        ></svg-icon>

        Add Another Accident
      </button>
    </div>
  </div>
</div>

<!-- NEXT BTN -->

<div
  class="d-flex justify-content-center align-items-center next-btn-container"
>
  <app-applicant-next-back-btn [nextStep]="true"></app-applicant-next-back-btn>
</div>

<!-- BACK BTN -->

<div
  class="d-flex justify-content-center align-items-center back-btn-container"
>
  <app-applicant-next-back-btn [backStep]="true"> </app-applicant-next-back-btn>
</div>

<!-- CONFIRM ALL REVIEW -->

<app-applicant-confirm-all-review
  *ngIf="selectedMode === 'REVIEW_MODE'"
></app-applicant-confirm-all-review>
