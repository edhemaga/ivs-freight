<div [formGroup]="licenseForm" class="d-flex flex-column step-form">
    <div class="d-flex line-container">
        <div class="group license-group">
            <app-ta-input
                (incorrectEvent)="incorrectInput($event, 0, 10)"
                [incorrectValue]="openAnnotationArray[10].lineInputs[0]"
                [inputConfig]="{
                    name: 'License',
                    type: 'text',
                    label: 'License #',
                    isRequired: true,
                    textTransform: 'capitalize',
                    autoFocus: selectedMode === 'APPLICANT_MODE',
                    isDisabled: selectedMode === 'REVIEW_MODE',
                    incorrectInput: selectedMode === 'REVIEW_MODE'
                }"
                formControlName="licenseNumber"
            ></app-ta-input>
        </div>
        <div class="group country-group">
            <app-ta-input-dropdown
                (selectedItem)="handleInputSelect($event, 'COUNTRY-TYPE')"
                [activeItem]="selectedCountryType"
                [inputConfig]="{
                    name: 'Input Dropdown',
                    type: 'text',
                    label: 'Country',
                    isRequired: true,
                    isDropdown: true,
                    dropdownWidthClass: 'w-col-234',
                    isDisabled: selectedMode === 'REVIEW_MODE'
                }"
                [options]="countryTypes"
                formControlName="country"
            ></app-ta-input-dropdown>
        </div>

        <!-- REVIEW AND FEEDBACK -->

        <div
            *ngIf="
                (selectedMode === 'REVIEW_MODE' ||
                    selectedMode === 'FEEDBACK_MODE') &&
                !isReviewingCard
            "
            class="review-feedback-container"
        >
            <app-applicant-review-feedback
                (annotationBtnClickEvent)="getAnnotationBtnClickValue($event)"
                [displayAnnotationButton]="
                    openAnnotationArray[10].displayAnnotationButton
                "
                [displayAnnotationTextArea]="
                    openAnnotationArray[10].displayAnnotationTextArea
                "
                [feedbackText]="
                    'Check the routing number one more time (one number missing)!!!'
                "
                [isFeedback]="selectedMode === 'FEEDBACK_MODE'"
                [lineIndex]="10"
                formControlName="firstRowReview"
            ></app-applicant-review-feedback>
        </div>
    </div>

    <!-- STATE, CLASS, EXP. DATE -->

    <div class="d-flex line-container">
        <div class="group state-group">
            <app-ta-input-dropdown
                (selectedItem)="handleInputSelect($event, 'STATE-TYPE')"
                [activeItem]="selectedStateType"
                [inputConfig]="{
                    name: 'Input Dropdown',
                    type: 'text',
                    label: 'State',
                    textTransform: 'uppercase',
                    isRequired: true,
                    isDisabled:
                        (selectedMode === 'APPLICANT_MODE' &&
                            !licenseForm.get('country').value) ||
                        selectedMode === 'REVIEW_MODE',
                    isDropdown: true,
                    dropdownWidthClass: 'w-col-246'
                }"
                [options]="stateTypes"
                formControlName="state"
            ></app-ta-input-dropdown>
        </div>
        <div class="group class-group">
            <app-ta-input-dropdown
                (selectedItem)="handleInputSelect($event, 'CLASS-TYPE')"
                [activeItem]="selectedClassType"
                [inputConfig]="{
                    name: 'Input Dropdown',
                    type: 'text',
                    label: 'Class',
                    isRequired: true,
                    isDropdown: true,
                    textTransform: 'uppercase',
                    dropdownWidthClass: 'w-col-174',
                    isDisabled: selectedMode === 'REVIEW_MODE'
                }"
                [options]="classTypes"
                formControlName="classType"
            ></app-ta-input-dropdown>
        </div>
        <div class="group exp-date-group">
            <app-ta-input
                (incorrectEvent)="incorrectInput($event, 2, 11)"
                [incorrectValue]="openAnnotationArray[11].lineInputs[2]"
                [inputConfig]="{
                    name: 'datepicker',
                    type: 'text',
                    label: 'Exp. Date',
                    placeholderIcon: 'date',
                    isRequired: true,
                    customClass: 'datetimeclass',
                    isDisabled: selectedMode === 'REVIEW_MODE',
                    incorrectInput: selectedMode === 'REVIEW_MODE'
                }"
                formControlName="expDate"
            ></app-ta-input>
        </div>

        <!-- REVIEW AND FEEDBACK -->

        <div
            *ngIf="
                (selectedMode === 'REVIEW_MODE' ||
                    selectedMode === 'FEEDBACK_MODE') &&
                !isReviewingCard
            "
            class="review-feedback-container"
        >
            <app-applicant-review-feedback
                (annotationBtnClickEvent)="getAnnotationBtnClickValue($event)"
                [displayAnnotationButton]="
                    openAnnotationArray[11].displayAnnotationButton
                "
                [displayAnnotationTextArea]="
                    openAnnotationArray[11].displayAnnotationTextArea
                "
                [feedbackText]="
                    'Check the routing number one more time (one number missing)!!!'
                "
                [isFeedback]="selectedMode === 'FEEDBACK_MODE'"
                [lineIndex]="11"
                formControlName="secondRowReview"
            ></app-applicant-review-feedback>
        </div>
    </div>

    <!-- RESTRICTIONS -->

    <div class="d-flex line-container">
        <div class="restrictions-group">
            <app-ta-input-dropdown
                (selectedItems)="handleInputSelect($event, 'RESTRICTIONS')"
                [inputConfig]="{
                    name: 'Input Dropdown',
                    type: 'text',
                    label: 'Restrictions',
                    isDropdown: true,
                    multiselectDropdown: true,
                    dropdownWidthClass: 'w-col-616',
                    isDisabled: selectedMode === 'REVIEW_MODE'
                }"
                [multiselectTemplate]="'multiselect-3-columns'"
                [options]="restrictionsList"
                [preloadMultiselectItems]="selectedRestrictions"
                [template]="'multiselect'"
                formControlName="restrictions"
            ></app-ta-input-dropdown>
        </div>
    </div>

    <!-- ENDORSMENTS -->

    <div class="d-flex line-container">
        <div class="endorsments-group">
            <app-ta-input-dropdown
                (selectedItems)="handleInputSelect($event, 'ENDORSMENTS')"
                [inputConfig]="{
                    name: 'Input Dropdown',
                    type: 'text',
                    label: 'Endorsments',
                    isDropdown: true,
                    multiselectDropdown: true,
                    dropdownWidthClass: 'w-col-616',
                    isDisabled: selectedMode === 'REVIEW_MODE'
                }"
                [multiselectTemplate]="'multiselect-3-columns'"
                [options]="endorsmentsList"
                [preloadMultiselectItems]="selectedEndorsments"
                [template]="'multiselect'"
                formControlName="endorsments"
            ></app-ta-input-dropdown>
        </div>
    </div>

    <!-- BTN -->

    <ng-container *ngIf="selectedMode === 'APPLICANT_MODE' && !isEditing">
        <div class="d-flex align-items-center">
            <h4 class="m-0 text-center ta-font-bold add-license-title">
                List any additional license(s) held in past 3 years
            </h4>

            <app-applicant-add-save-btn
                (clickValueEmitter)="onGetBtnClickValue($event)"
                [addBtn]="true"
                [btnText]="'Add License'"
                [disabledValue]="licenseForm.invalid"
            ></app-applicant-add-save-btn>
        </div>
    </ng-container>

    <ng-container *ngIf="isEditing">
        <div class="d-flex align-items-center justify-content-center">
            <app-applicant-add-save-btn
                (clickValueEmitter)="onGetBtnClickValue($event)"
                [cancelBtn]="true"
            ></app-applicant-add-save-btn>

            <app-applicant-add-save-btn
                (clickValueEmitter)="onGetBtnClickValue($event)"
                [disabledValue]="!isLicenseEdited || !licenseForm.valid"
                [saveBtn]="true"
            ></app-applicant-add-save-btn>
        </div>
    </ng-container>

    <ng-container *ngIf="isReviewingCard">
        <div class="d-flex align-items-center justify-content-center">
            <app-applicant-add-save-btn
                (clickValueEmitter)="onGetBtnClickValue($event)"
                [cancelBtn]="true"
                [reviewBtn]="true"
            ></app-applicant-add-save-btn>

            <app-applicant-add-save-btn
                (clickValueEmitter)="onGetBtnClickValue($event)"
                [disabledValue]="!isCardReviewedIncorrect"
                [reviewBtn]="true"
                [saveBtn]="true"
            ></app-applicant-add-save-btn>
        </div>
    </ng-container>
</div>
