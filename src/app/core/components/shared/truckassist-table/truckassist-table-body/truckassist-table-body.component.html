<table>
  <tbody>
    <tr
      [ngStyle]="{ 'margin-top': i > 0 ? '2px' : '0px' }"
      *ngFor="let row of viewData; let i = index; trackBy: trackByFn"
      [ngClass]="{
        'regular-row': !row.isSelected,
        'selected-row': row.isSelected,
        'muted-row':
          !row.active && !row['status'] && !options.disabledMutedStyle
      }"
    >
      <div class="columns-container">
        <td
          *ngFor="let column of columns"
          [ngStyle]="{
            'margin-left':
              column.ngTemplate === 'attachments' ? 'auto' : 'unset'
          }"
        >
          <!-- CHECKBOX TEMPLATE-->
          <div
            *ngIf="!column.hidden && column.ngTemplate === 'checkbox'"
            [ngStyle]="{ width: column.width + 'px' }"
            class="td-content set-center"
          >
            <input
              (change)="onSelectItem(row, i)"
              [checked]="row.isSelected"
              class="table-checkbox"
              id="checkbox{{ i }}"
              type="checkbox"
            />
            <label class="table-checkbox-label" for="checkbox{{ i }}"></label>
          </div>

          <!--AVATAR COLUMN-->
          <div
            *ngIf="!column.hidden && column.ngTemplate === 'avatar'"
            [ngStyle]="{ width: column.width + 'px' }"
            class="td-content"
          >
            <div class="avatar-container">
              <img
                alt="avatar"
                [src]="
                  row.avatar ? row.avatar : 'assets/img/svgs/table/profile.svg'
                "
                class="avatar"
              />
              <img
                alt="avatar"
                *ngIf="row.isOwner"
                class="avatar-owner"
                src="../../../../assets/img/table-svgs/owner-badge-new.svg"
              />
            </div>
            <span (click)="goToDetails(column, row)" class="table-avatar-name"
              >{{ row.firstName }} {{ row.lastName }}</span
            >
          </div>

          <!-- TEXT COLUMN -->
          <div
            class="td-content"
            *ngIf="!column.hidden && column.ngTemplate === 'text'"
            [ngStyle]="{ width: column.width + 'px' }"
          >
            <span class="table-text">{{
              row[column.field] ? row[column.field] : ""
            }}</span>
          </div>

          <!-- STATE TEXT COLUMN -->
          <div
            *ngIf="!column.hidden && column.ngTemplate === 'textState'"
            [ngStyle]="{ width: column.width + 'px' }"
            class="td-content"
          >
            <span
              *ngIf="row?.licenseData"
              class="table-text table-text-state"
              >{{ row[column.field] ? row[column.field] : "" }}</span
            >
          </div>

          <!-- PROGRESS COLUMN TEMPLATE -->
          <div
            class="td-content"
            [ngStyle]="{ width: column.width + 'px' }"
            *ngIf="!column.hidden && column.ngTemplate === 'progress'"
          >
            <app-truckassist-progress-expiration
              *ngIf="row[column.field] && row[column.field]['start']"
              [startDate]="
                row[column.field]['start']
                  ? (row[column.field]['start'] | date: 'shortDate')
                  : undefined
              "
              [expireDate]="
                row[column.field]['end']
                  ? (row[column.field]['end'] | date: 'shortDate')
                  : (row[column.field]['start']
                    | getExpireData
                    | date: 'shortDate')
              "
              [startDate]="
                row[column.field]['start']
                  ? (row[column.field]['start'] | date: 'shortDate')
                  : undefined
              "
              [status]="row['status']"
            ></app-truckassist-progress-expiration>
          </div>

          <!-- ATTACHMENTS COLUMN TEMPLATE -->
          <div
            *ngIf="!column.hidden && column.ngTemplate === 'attachments'"
            [ngStyle]="{ width: column.width + 'px' }"
            class="td-content"
          >
            <div (click)="onShowAttachments(row)" class="attachments-btn">
              <div class="attachments-svg"></div>
            </div>
          </div>

          <!-- NOTE COLUMN TEMPLATE -->
          <div
            *ngIf="!column.hidden && column.ngTemplate === 'note'"
            [ngStyle]="{ width: column.width + 'px' }"
            class="td-content"
          >
            <!--  <app-ta-note
              (saveNoteValue)="saveNote($event, row)"
              [note]="row.additionalData?.note ? row.additionalData?.note : ''"
            ></app-ta-note> -->
          </div>

          <!-- ACTIONS COLUMN TEMPLATE -->
          <div
            class="td-content set-center"
            *ngIf="!column.hidden && column.ngTemplate === 'actions'"
            [ngStyle]="{ width: column.width + 'px' }"
          >
            <app-table-dropdown
              (dropDownActions)="onDropAction($event)"
              [id]="row.id"
              [options]="options"
            ></app-table-dropdown>
          </div>
        </td>
      </div>
    </tr>
  </tbody>
</table>
