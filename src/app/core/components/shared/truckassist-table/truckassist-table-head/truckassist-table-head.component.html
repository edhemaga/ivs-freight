<table>
  <thead>
    <tr
      cdkDropListOrientation="horizontal"
      cdkDropList
      (cdkDropListDropped)="onReorder($event)"
      class="tr"
    >
      <th
        [resizeColumn]="column.resizable && !locked"
        [index]="i"
        (resizeing)="onResize($event)"
        *ngFor="let column of columns; let i = index"
        cdkDrag
        [cdkDragDisabled]="locked || rezaizeing"
        cdkDragBoundary="tr"
        [cdkDragPreviewClass]="'cdk-drag-preview'"
        [ngStyle]="{
          width: column.width + 'px',
          'margin-left': column.moveRight ? 'auto' : 'unset',
          'justify-content': column?.headAlign ? column?.headAlign : ''
        }"
        [ngClass]="{
          'set-center': column.ngTemplate === 'checkbox' || column.setCenter,
          'column-unlocket': !locked
        }"
      >
        <!-- Selected Row Count -->
        <div
          *ngIf="column.ngTemplate === 'checkbox'"
          class="selected-rows-count"
          #op="ngbPopover"
          (click)="onSelectedOptions(op)"
          [autoClose]="true"
          [ngbPopover]="optionsPopover"
          [placement]="'right-top'"
          popoverClass="{{ mySelection.length ? 'has-selected-options-popover' : 'selected-options-popover' }}"
          triggers="manual"
          [ngClass]="{ 'has-selected': mySelection.length }"
        >
          {{ mySelection.length ? mySelection.length : "" }}
        </div>

        <!-- Title -->
        <div
          *ngIf="column.ngTemplate !== 'checkbox' && column.name !== ''"
          class="th-title"
        >
          {{ column.name }}
        </div>

        <!-- Icons -->
        <div *ngIf="column.name === '' && column?.headIconStyle" class="icons">
          <svg-icon
            [svgStyle]="{
              'width.px': column.headIconStyle.width,
              'height.px': column.headIconStyle.height
            }"
            [src]="
              column.headIconStyle.imgPath ? column.headIconStyle.imgPath : ''
            "
          ></svg-icon>
        </div>
      </th>
    </tr>
  </thead>
</table>

<ng-template #optionsPopover let-data="data" data-toggle="popover">
  <div class="select-options-container">
    <!-- Select All -->
    <div
      class="select-option"
      (click)="onSelect('select')"
      *ngIf="!mySelection.length"
    >
      <div class="text">Select All</div>
      <div class="count">{{ viewData.length }}</div>
    </div>

    <!-- Deselect All -->
    <div
      class="select-option"
      (click)="onSelect('deselect')"
      *ngIf="mySelection.length === viewData.length"
    >
      <div class="text">Deselect All</div>
      <div class="count">{{ viewData.length }}</div>
    </div>

    <!-- Select Remaining Or  Clear Selected -->
    <div *ngIf="mySelection.length < viewData.length && mySelection.length">
      <div class="select-option" (click)="onSelect('select')">
        <div class="text">Select Remaining</div>
        <div class="count">{{ viewData.length - mySelection.length }}</div>
      </div>

      <div class="select-option clear-selected" (click)="onSelect('deselect')">
        <div class="text">Clear Selected</div>
        <div class="count">{{ mySelection.length }}</div>
      </div>
    </div>
  </div>
</ng-template>
