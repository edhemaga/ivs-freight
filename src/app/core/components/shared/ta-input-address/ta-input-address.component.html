<div
  class="input-custom-group"
  [ngClass]="{
    'hover-focus-out': !focusInput,
    invalid: getSuperControl.value && getSuperControl.invalid && !focusInput,
    'invalid-empty-required':
      inputConfig.isRequired &&
      !getSuperControl.value &&
      getSuperControl.invalid &&
      !focusInput,
    'invalid-empty-focus-required':
      inputConfig.isRequired &&
      !getSuperControl.value &&
      getSuperControl.invalid &&
      focusInput,
    valid: getSuperControl.value && getSuperControl.valid && !focusInput,
    'address-flag': inputConfig.addressFlag
  }"
>
  <!-- Input Invalid Danger Mark -->
  <svg-icon
    *ngIf="
      touchedInput &&
      getSuperControl.value &&
      getSuperControl.invalid &&
      !focusInput &&
      !inputConfig.addressFlag
    "
    class="input-invalid-danger-mark"
    src="assets/svg/common/ic_danger.svg"
  >
  </svg-icon>

  <!-- Input Clear -->
  <div
    *ngIf="!inputConfig.isDisabled && !inputConfig.addressFlag"
    class="input-clear {{ inputConfig.customClass }}"
    [ngClass]="{
      'valid-focus-in':
        activeAddress?.address === getSuperControl.value &&
        !invalidAddress &&
        focusInput &&
        !inputConfig.blackInput,
      'invalid-focus-in':
        getSuperControl.value &&
        invalidAddress &&
        focusInput &&
        !inputConfig.blackInput
    }"
    ngbTooltip
    mainTooltip="Clear"
    tooltipBackground="#6c6c6c"
    position="top"
    (click)="clearInput()"
  >
    <svg-icon src="assets/svg/ic_x.svg" class="input-clear-x"></svg-icon>
  </div>

  <!-- Adress flag -->
  <div
    *ngIf="inputConfig.addressFlag && isVisibleAddressFlag"
    class="input-address-flag"
    (click)="changeFlagText($event)"
  >
    <p>{{ inputConfig.addressFlag }}</p>
  </div>

  <!-- Input Icon Placeholder -->
  <svg-icon
    class="input-icon {{ inputConfig.customClass }}"
    *ngIf="inputConfig.placeholderIcon"
    [ngClass]="{
      disabled: !getSuperControl.value && inputConfig.isDisabled,
      'disabled-filled': getSuperControl.value && inputConfig.isDisabled,
      'valid-required-in':
        getSuperControl.value &&
        !invalidAddress &&
        focusInput &&
        !inputConfig.commands?.active,
      'valid-required-out':
        getSuperControl.value && !invalidAddress && !focusInput,
      'invalid-required-in':
        getSuperControl.value &&
        invalidAddress &&
        focusInput &&
        !inputConfig.commands?.active,
      'invalid-required-empty':
        !getSuperControl.value &&
        invalidAddress &&
        !focusInput &&
        touchedInput &&
        !inputConfig.commands?.active,
      'invalid-required-filled-out':
        getSuperControl.value && invalidAddress && !focusInput
    }"
    [src]="inputConfig.placeholderIcon?.toLowerCase() | taSvg: 'common'"
  ></svg-icon>

  <!-- Address Control -->
  <input
    #placesRef="ngx-places"
    #input
    [id]="inputConfig.name"
    [name]="inputConfig.name"
    [disabled]="inputConfig.isDisabled"
    [placeholder]="''"
    ngx-google-places-autocomplete
    [options]="options"
    class="input-control {{ inputConfig.textTransform }} {{
      inputConfig.customClass
    }}"
    [ngClass]="{
      disabled: !getSuperControl.value && inputConfig.isDisabled,
      'disabled-filled': getSuperControl.value && inputConfig.isDisabled,
      'valid-focus-in':
        activeAddress &&
        activeAddress?.address === getSuperControl.value &&
        focusInput &&
        !isVisibleCommands &&
        !inputConfig.blackInput,
      'invalid-focus-in':
        getSuperControl.value &&
        invalidAddress &&
        focusInput &&
        !inputConfig.blackInput,
      'has-input-icon': inputConfig.placeholderIcon,
      'input-commands': inputConfig.commands?.active && isVisibleCommands,
      'address-flag': inputConfig.addressFlag && isVisibleAddressFlag
    }"
    (keyup)="onBackspace($event)"
    (input)="onChange($event.target.value)"
    (blur)="onBlur()"
    (focus)="onFocus()"
    (keypress)="manipulateWithInput($event)"
    (onAddressChange)="handleAddressChange($event)"
  />

  <!-- Input Label -->
  <label
    [for]="inputConfig.name"
    class="input-label {{ inputConfig.customClass }}"
    [ngClass]="{
      required: inputConfig.isRequired && !inputConfig.isDisabled,
      'disabled-empty': !getSuperControl.value && inputConfig.isDisabled,
      'disabled-filled': getSuperControl.value && inputConfig.isDisabled,
      'up-label': getSuperControl.value || focusInput,
      'has-input-icon': inputConfig.placeholderIcon,
      'valid-focus-out':
        getSuperControl.value && !getSuperControl.invalid && !focusInput,
      'invalid-focus-out':
        getSuperControl.value && getSuperControl.invalid && !focusInput,
      'routing-address': inputConfig.addressFlag && !focusInput,
      'routing-address-focus': inputConfig.addressFlag && focusInput
    }"
  >
    {{ inputConfig.label }}
  </label>

  <!-- Input Commands -->
  <div
    *ngIf="
      inputConfig.commands?.active &&
      isVisibleCommands &&
      inputConfig.addressFlag
    "
    class="ta-input-commands"
    [ngClass]="{ 'address-flag': inputConfig.addressFlag }"
  >
    <div
      class="ta-input-command-first"
      ngbTooltip
      [mainTooltip]="inputConfig.commands?.firstCommand?.popup?.name"
      [tooltipBackground]="
        inputConfig.commands?.firstCommand?.popup?.backgroundColor
      "
      [disableTooltip]="!inputConfig.commands?.firstCommand?.popup"
      position="top"
    >
      <svg-icon
        class="ta-input-command-svg-first"
        [src]="inputConfig.commands.firstCommand.svg"
        (click)="
          onCommands(
            $event,
            inputConfig.commands.type,
            inputConfig.commands.firstCommand.name
          )
        "
      ></svg-icon>
    </div>
    <div
      class="ta-input-command-second"
      ngbTooltip
      [mainTooltip]="inputConfig.commands?.secondCommand?.popup?.name"
      [tooltipBackground]="
        inputConfig.commands?.secondCommand?.popup?.backgroundColor
      "
      [disableTooltip]="!inputConfig.commands?.secondCommand?.popup"
      position="top"
    >
      <svg-icon
        class="ta-input-command-svg-second"
        [src]="inputConfig.commands.secondCommand.svg"
        (click)="
          onCommands(
            $event,
            inputConfig.commands.type,
            inputConfig.commands.secondCommand.name
          )
        "
      ></svg-icon>
    </div>
  </div>

  <!-- Input Error Message -->
  <span
    *ngIf="
      !(!getSuperControl.value && focusInput) &&
      (touchedInput || getSuperControl.value) &&
      getSuperControl.invalid &&
      !inputConfig.commands?.active &&
      !inputConfig.hideErrorMessage
    "
    class="input-error {{ inputConfig.customClass }}"
  >
    {{ getSuperControl.errors | inputError: inputConfig.name }}
  </span>
</div>
