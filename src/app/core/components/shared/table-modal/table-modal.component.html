<table>
    <thead class="modal-table-head">
        <!-- Fixed Columns -->
        <tr>
            <th *ngFor="let column of tableFixedColumns; let i = index">
                <!-- Number Count -->
                <div
                    *ngIf="column.ngTemplate === 'num-count'"
                    class="th-num-count"
                    [ngStyle]="{
                        'width.px': column.width
                    }"
                >
                    {{ column.title }}
                </div>

                <!-- Title -->
                <div
                    *ngIf="column.ngTemplate === 'text'"
                    class="th-title"
                    [ngStyle]="{
                        'width.px': column.width
                    }"
                >
                    {{ column.title }}
                </div>
            </th>
        </tr>

        <!-- Scrollable Columns -->
        <tr
            id="table-modal-scroll-columns-container"
            class="head-scrollable-container"
            [ngStyle]="{ 'max-width.px': midSectionWidth }"
            cdkDropListOrientation="horizontal"
            cdkDropList
            (cdkDropListDropped)="onReorder($event)"
        >
            <th
                *ngFor="let column of tableScrollableColumns; let i = index"
                cdkDrag
                cdkDragBoundary=".head-scrollable-container"
                [cdkDragPreviewClass]="'cdk-drag-preview'"
            >
                <!-- Title -->
                <div
                    *ngIf="column.ngTemplate === 'text'"
                    class="th-title"
                    [ngStyle]="{
                        'width.px': column.width
                    }"
                >
                    {{ column.title }}
                </div>
            </th>
        </tr>

        <!-- Action Columns -->
        <tr>
            <th *ngFor="let column of tableActionColumns; let i = index">
                <!-- Icons -->
                <div
                    *ngIf="column.isAction"
                    class="add-btn"
                    [ngStyle]="{
                        'width.px': column.width
                    }"
                >
                    <svg-icon
                        [svgStyle]="{
                            'width.px': 14,
                            'height.px': 14
                        }"
                        [src]="'assets/svg/table-modal/Modal-Add-BTN.svg'"
                    ></svg-icon>
                </div>
            </th>
        </tr>
    </thead>

    <tbody class="modal-table-body">
        <app-custom-scrollbar
            [scrollBarOptions]="{
                showVerticalScrollBar: false,
                showHorizontalScrollBar: true,
                modalStyle: {
                    horizontalScrollBarMarginTop: 4,
                    horizontalScrollBarLeft: 0,
                    horizontalScrollBarWidth: 665,
                    additionalWidth: 265,
                    modalScrollClassActive: true
                }
            }"
            (scrollEvent)="onHorizontalScroll($event)"
        >
            <tr
                *ngFor="let row of viewData; let i = index"
                [ngStyle]="{ 'margin-top.px': i !== 0 ? 4 : 0 }"
            >
                <!-- Fixed Columns -->
                <div class="fixed-container">
                    <td *ngFor="let column of tableFixedColumns; let j = index">
                        <!-- Number Count -->
                        <div
                            class="td-num-count"
                            *ngIf="column.ngTemplate === 'num-count'"
                            [ngStyle]="{
                                width: column.width + 'px'
                            }"
                        >
                            {{ i + 1 }}
                        </div>

                        <!-- Text -->
                        <div
                            class="td-input-text"
                            *ngIf="
                                column.ngTemplate === 'text' &&
                                column.columnFocusId !==
                                    column.title + ' ' + i + ' ' + j
                            "
                            [ngStyle]="{
                                width: column.width + 'px'
                            }"
                            (click)="onFocusInput(column, i, j)"
                        >
                            {{ row[column.field].text }}
                            <div class="td-input-text-extraText">
                                {{ row[column.field].extraText }}
                            </div>
                        </div>

                        <!-- Input -->
                        <div
                            *ngIf="
                                column.columnFocusId ===
                                column.title + ' ' + i + ' ' + j
                            "
                            class="ta-input-container"
                            [ngStyle]="{
                                width: column.width + 'px'
                            }"
                        >
                            <app-ta-input
                                *ngIf="column?.inputConfig"
                                [formControl]="column.formControl"
                                [inputConfig]="
                                    column.inputConfig
                                        | tableModalInputConfig
                                            : i + ' ' + column.title
                                "
                            ></app-ta-input>
                        </div>
                    </td>
                </div>

                <!-- Scrollable Columns -->
                <div
                    class="scrollable-container not-pined-columns"
                    id="table-modal-scroll-columns-container"
                    [ngStyle]="{ 'max-width.px': midSectionWidth }"
                >
                    <td
                        *ngFor="
                            let column of tableScrollableColumns;
                            let j = index
                        "
                    >
                        <!-- Text -->
                        <div
                            class="td-input-text"
                            *ngIf="
                                column.ngTemplate === 'text' &&
                                column.columnFocusId !==
                                    column.title + ' ' + i + ' ' + j
                            "
                            [ngStyle]="{
                                width: column.width + 'px'
                            }"
                            (click)="onFocusInput(column, i, j)"
                        >
                            {{ row[column.field].text }}
                            <div class="td-input-text-extraText">
                                {{ row[column.field].extraText }}
                            </div>
                        </div>

                        <!-- Input -->
                        <div
                            *ngIf="
                                column.columnFocusId ===
                                column.title + ' ' + i + ' ' + j
                            "
                            class="ta-input-container"
                            [ngStyle]="{
                                width: column.width + 'px'
                            }"
                        >
                            <app-ta-input
                                *ngIf="column?.inputConfig"
                                [formControl]="column.formControl"
                                [inputConfig]="
                                    column.inputConfig
                                        | tableModalInputConfig
                                            : i + ' ' + column.title
                                "
                            ></app-ta-input>
                        </div>
                    </td>
                </div>

                <!-- Action Columns -->
                <div class="action-container">
                    <td *ngFor="let column of tableActionColumns">
                        <!-- Delete Action -->
                        <div
                            *ngIf="column.isAction"
                            class="icon"
                            [ngStyle]="{
                                'width.px': column.width
                            }"
                            (click)="onDeleteRow(i)"
                        >
                            <svg-icon
                                [svgStyle]="{
                                    'width.px': 18,
                                    'height.px': 18
                                }"
                                [src]="
                                    'assets/svg/table-modal/Modal-Delete-BTN.svg'
                                "
                            ></svg-icon>
                        </div>
                    </td>
                </div>
            </tr>
        </app-custom-scrollbar>
    </tbody>
</table>
