<app-custom-scrollbar
    [scrollBarOptions]="{
        showVerticalScrollBar: true,
        showHorizontalScrollBar: false
    }"
>
    <div cdkDrag class="modal-container {{ customClass }}" ngBAutofocus>
        <div class="modal-original-part {{ partClass }}">
            <!-- Modal Header -->

            <div cdkDragHandle class="modal-header">
                <div
                    class="modal-header-leftside"
                    [ngClass]="{ 'confirmation-modal': confirmationData }"
                >
                    <!-- Haeder tabs -->

                    <div
                        *ngIf="tabChange"
                        class="modal-header-tab-change"
                        [ngClass]="{
                            'modal-header-tab-change-reorder':
                                tabChangePosition === 'right'
                        }"
                    >
                        <app-ta-tab-switch
                            [tabs]="tabChange"
                            (switchClicked)="onTabChange($event)"
                            [type]="'type2-modal-popup'"
                        ></app-ta-tab-switch>
                    </div>

                    <!-- Header svg -->

                    <svg-icon
                        *ngIf="headerSvg"
                        src="assets/svg/common/confirmation/ic_confirmation_{{
                            headerSvg
                        }}.svg"
                        class="modal-header-svg"
                    ></svg-icon>

                    <!-- Header title -->

                    <h5 class="modal-title">{{ modalTitle }}</h5>

                    <!-- Header name -->

                    <h5
                        class="edit-name"
                        *ngIf="
                            (editData?.type?.includes('edit') ||
                                specificCaseModalName) &&
                            editName
                        "
                    >
                        {{ editName }}
                    </h5>
                </div>

                <div class="modal-header-rightside">
                    <!-- Hazardous Logo -->

                    <ng-container *ngIf="isVisibleHazardous">
                        <svg-icon
                            src="assets/svg/common/ic_hazardous.svg"
                            class="modal-hazardous-logo"
                            (click)="toggleAdditionalPart('hazardous')"
                        ></svg-icon>
                    </ng-container>

                    <!-- Load Map Button -->

                    <ng-container *ngIf="isVisibleMap">
                        <div
                            class="d-flex align-items-center justify-content-center modal-header-load-map-button"
                            [ngClass]="{ active: mapVisibility }"
                            (click)="toggleAdditionalPart('map')"
                        >
                            <svg-icon
                                src="../../../../../assets/svg/common/load/ic_load_map.svg"
                            ></svg-icon>
                        </div>
                    </ng-container>

                    <!-- Header close -->

                    <ng-container
                        *ngIf="
                            this.editData?.type !== 'edit-company-first-login'
                        "
                    >
                        <svg-icon
                            class="modal-close"
                            src="assets/svg/ic_x.svg"
                            (click)="onAction('close')"
                        ></svg-icon>
                    </ng-container>
                </div>
            </div>

            <!-- Divider top -->

            <div *ngIf="topDivider" class="divider"></div>
            <!-- Modal body -->

            <div class="modal-body">
                <!-- Modal content -->

                <ng-content select="[origin]"></ng-content>

                <!-- Divider bottom -->

                <div *ngIf="bottomDivider" class="divider"></div>
            </div>

            <!-- Modal footer Normal -->

            <div
                *ngIf="!disableFooter && !confirmationData"
                class="modal-footer"
                cdkDragHandle
                [ngClass]="{
                    'mutliple-buttons': editData?.type?.includes('edit'),
                    'load-template': loadModalTemplate,
                    'map-settings-template': mapSettingsModal || mapRouteModal
                }"
            >
                <!-- Footer Left Side -->

                <div
                    class="ta-modal-footer-left-side"
                    *ngIf="
                        editData?.type?.includes('edit') ||
                        loadModalTemplate ||
                        mapSettingsModal ||
                        mapRouteModal
                    "
                >
                    <!-- Delete -->

                    <ng-container
                        *ngIf="
                            !disableDelete &&
                            !resendEmail &&
                            !loadModalTemplate &&
                            !mapSettingsModal &&
                            !mapRouteModal
                        "
                    >
                        <button
                            (click)="onAction('delete')"
                            class="modal-delete-btn"
                            type="button"
                        >
                            Delete
                        </button>
                    </ng-container>

                    <!-- Map Settings Reset -->

                    <ng-container
                        *ngIf="
                            (mapSettingsModal || mapRouteModal) &&
                            resetMapVisibility
                        "
                    >
                        <button
                            (click)="onAction('reset-map-routing')"
                            class="modal-map-settings-reset-btn"
                            type="button"
                        >
                            Reset
                        </button>
                    </ng-container>

                    <!-- Resend Email -->

                    <ng-container *ngIf="resendEmail">
                        <button
                            (click)="onAction('resend email')"
                            class="modal-resend-email-btn"
                            type="button"
                        >
                            {{
                                resendEmailSpinnerVisibility
                                    ? 'Sending'
                                    : 'Resend Application Email'
                            }}
                            <div
                                *ngIf="resendEmailSpinnerVisibility"
                                class="modal-spinner"
                            >
                                <app-ta-spinner
                                    [size]="'small'"
                                    [color]="'white'"
                                ></app-ta-spinner>
                            </div>
                        </button>
                    </ng-container>

                    <!-- Deactivated -->

                    <ng-container *ngIf="editData?.disableButton">
                        <button
                            (click)="onAction('deactivate')"
                            class="modal-deactivate-btn"
                            type="button"
                        >
                            {{ isDeactivated ? 'Activate' : 'Deactivate' }}
                        </button>
                    </ng-container>

                    <!-- DNU -->

                    <ng-container *ngIf="editData?.dnuButton">
                        <button
                            (click)="onAction('dnu')"
                            class="modal-deactivate-btn"
                            type="button"
                            ngbTooltip
                            mainTooltip="Do Not Use List"
                            tooltipBackground="#6c6c6c"
                            position="top"
                        >
                            {{ isDNU ? 'Remove from DNU' : 'Move to DNU' }}
                        </button>
                    </ng-container>

                    <!-- BFB -->

                    <ng-container *ngIf="editData?.bfbButton">
                        <button
                            (click)="onAction('bfb')"
                            class="modal-deactivate-btn"
                            type="button"
                            ngbTooltip
                            mainTooltip="Banned from Broker List"
                            tooltipBackground="#6c6c6c"
                            position="top"
                        >
                            {{ isBFB ? 'Remove from BFB' : 'Move to BFB' }}
                        </button>
                    </ng-container>

                    <!-- Convert to Template -->

                    <ng-container
                        *ngIf="loadModalTemplate && !isConvertedToTemplate"
                    >
                        <button
                            (click)="onAction('convert-to-template')"
                            class="d-flex align-items-center justify-content-center ta-font-bold modal-convert-to-template-btn"
                            type="button"
                        >
                            Convert to Template
                        </button>
                    </ng-container>
                </div>

                <!-- Footer right side -->

                <div class="ta-modal-footer-right-side">
                    <!-- Save and Add New button -->

                    <button
                        *ngIf="saveAndAddNew"
                        (click)="onAction('save and add new')"
                        class="d-flex align-items-center justify-content-center ta-font-bold modal-save-btn"
                        [ngClass]="{ valid: isModalValid }"
                        type="button"
                    >
                        {{
                            saveAddNewSpinnerVisibility
                                ? 'Saving'
                                : customTextSaveAndAddNew
                                ? customTextSaveAndAddNew
                                : 'Save and Add New'
                        }}
                        <div
                            *ngIf="saveAddNewSpinnerVisibility"
                            class="modal-spinner"
                        >
                            <app-ta-spinner
                                [size]="'small'"
                                [color]="'white'"
                            ></app-ta-spinner>
                        </div>
                    </button>

                    <!-- Set Map Settings -->

                    <button
                        *ngIf="mapSettingsModal"
                        (click)="onAction('set-map-settings')"
                        class="d-flex align-items-center justify-content-center ta-font-bold modal-save-btn"
                        [ngClass]="{ valid: isModalValid }"
                        type="button"
                    >
                        {{
                            setMapSettingsSpinnerVisibility ? 'Saving' : 'Save'
                        }}
                        <div
                            *ngIf="setMapSettingsSpinnerVisibility"
                            class="modal-spinner"
                        >
                            <app-ta-spinner
                                [size]="'small'"
                                [color]="'white'"
                            ></app-ta-spinner>
                        </div>
                    </button>

                    <!-- Create Map Route -->

                    <button
                        *ngIf="mapRouteModal"
                        (click)="onAction('create-map-route')"
                        class="d-flex align-items-center justify-content-center ta-font-bold modal-save-btn"
                        [ngClass]="{ valid: isModalValid }"
                        type="button"
                    >
                        {{
                            setMapRouteSpinnerVisibility
                                ? 'Saving'
                                : editData.id
                                ? 'Save Changes'
                                : 'Save'
                        }}
                        <div
                            *ngIf="setMapRouteSpinnerVisibility"
                            class="modal-spinner"
                        >
                            <app-ta-spinner
                                [size]="'small'"
                                [color]="'white'"
                            ></app-ta-spinner>
                        </div>
                    </button>

                    <!-- Save button -->

                    <ng-container *ngIf="!mapSettingsModal && !mapRouteModal">
                        <button
                            (click)="onAction('save')"
                            class="d-flex align-items-center justify-content-center ta-font-bold modal-save-btn"
                            [ngClass]="{ valid: isModalValid }"
                            type="button"
                        >
                            {{
                                profileUpdateText
                                    ? saveSpinnerVisibility
                                        ? 'Saving'
                                        : 'Save Changes'
                                    : applicantText
                                    ? saveSpinnerVisibility
                                        ? 'Inviting'
                                        : 'Invite'
                                    : saveSpinnerVisibility
                                    ? 'Saving'
                                    : editData?.type?.includes('edit')
                                    ? editData?.type?.includes('fo')
                                        ? 'Save'
                                        : 'Save Changes'
                                    : 'Save'
                            }}

                            <ng-container *ngIf="saveSpinnerVisibility">
                                <div class="modal-spinner">
                                    <app-ta-spinner
                                        [size]="'small'"
                                        [color]="'white'"
                                    ></app-ta-spinner>
                                </div>
                            </ng-container>
                        </button>
                    </ng-container>
                </div>
            </div>

            <!-- Modal Footer Confirmation Modal -->

            <div
                *ngIf="confirmationData"
                class="modal-footer"
                [ngClass]="{
                    'mutliple-buttons': confirmationData.subType !== 'cdl void'
                }"
            >
                <!-- Cancel -->

                <button
                    *ngIf="confirmationData.subType !== 'cdl void'"
                    (click)="onAction('close')"
                    class="modal-cancel-btn"
                    type="button"
                >
                    Cancel
                </button>

                <!-- Delete -->

                <button
                    *ngIf="
                        ['delete', 'multiple delete'].includes(
                            confirmationData?.type
                        )
                    "
                    (click)="
                        onAction(
                            confirmationData?.data
                                ? 'delete'
                                : 'multiple delete'
                        )
                    "
                    class="modal-delete-btn modal-red-btn modal-confirmation-btn"
                    type="button"
                >
                    Delete
                </button>

                <!-- Activate -->

                <button
                    *ngIf="confirmationData?.type === 'activate'"
                    (click)="onAction('activate')"
                    class="d-flex align-items-center justify-content-center ta-font-bold modal-save-btn valid modal-confirmation-btn"
                    type="button"
                >
                    Activate
                    {{
                        confirmationData?.template
                            .substring(0, 1)
                            .toUpperCase() +
                            confirmationData?.template.substring(1)
                    }}
                </button>

                <!-- Deactivate -->

                <button
                    *ngIf="confirmationData?.type === 'deactivate'"
                    (click)="onAction('deactivate')"
                    class="modal-deactivate-btn modal-gray-btn modal-confirmation-btn"
                    type="button"
                >
                    Deactivate {{ confirmationData?.template }}
                </button>

                <!-- Hire -->

                <button
                    *ngIf="confirmationData?.type === 'hire'"
                    (click)="onAction('hire')"
                    class="d-flex align-items-center justify-content-center ta-font-bold modal-save-btn active valid modal-confirmation-btn"
                    type="button"
                >
                    Hire
                </button>

                <!-- Archive -->

                <button
                    *ngIf="confirmationData?.subType === 'archive'"
                    (click)="onAction('archive')"
                    class="modal-deactivate-btn modal-gray-btn modal-confirmation-btn"
                    type="button"
                >
                    {{
                        confirmationData?.subTypeStatus
                            ? 'Remove from archive'
                            : 'Archive' + ' ' + confirmationData?.template
                    }}
                </button>

                <!-- Void CDL -->

                <button
                    *ngIf="confirmationData?.subType === 'cdl void'"
                    (click)="onAction('cdl-void')"
                    class="modal-deactivate-btn modal-gray-btn modal-confirmation-btn"
                    type="button"
                >
                    Void Current CDL
                </button>

                <!-- DNU -->

                <button
                    *ngIf="confirmationData?.subType === 'dnu'"
                    (click)="onAction('dnu')"
                    class="modal-deactivate-btn modal-gray-btn modal-confirmation-btn"
                    type="button"
                >
                    {{
                        confirmationData?.subTypeStatus
                            ?.substring(0, 1)
                            .toUpperCase() +
                            confirmationData?.subTypeStatus?.substring(1)
                    }}
                    {{
                        confirmationData?.subTypeStatus === 'move'
                            ? 'to'
                            : 'from'
                    }}
                    DNU
                </button>

                <!-- DNU -->

                <button
                    *ngIf="confirmationData?.subType === 'ban list'"
                    (click)="onAction('bfb')"
                    class="modal-deactivate-btn modal-gray-btn modal-confirmation-btn"
                    type="button"
                >
                    {{
                        confirmationData?.subTypeStatus
                            ?.substring(0, 1)
                            .toUpperCase() +
                            confirmationData?.subTypeStatus?.substring(1)
                    }}
                    {{
                        confirmationData?.subTypeStatus === 'move'
                            ? 'to'
                            : 'from'
                    }}
                    Ban List
                </button>

                <!-- Favourite -->

                <button
                    *ngIf="confirmationData?.subType === 'favorite'"
                    (click)="onAction('favorite')"
                    class="modal-deactivate-btn modal-gray-btn modal-confirmation-btn"
                    type="button"
                >
                    {{
                        confirmationData?.subTypeStatus === 'move'
                            ? 'Mark as Favorite'
                            : 'Remove from Favorite'
                    }}
                </button>
            </div>

            <!-- End Confirmation Modal -->

            <!-- Modal DropZone -->

            <div
                class="drop-zone-active"
                [class.drop-zone-active-hovered]="hoverZone"
                [hidden]="!isDropZoneVisible"
                [@widthGrow]="isDropZoneVisible ? 'open' : 'closed'"
            >
                <h5 class="drop-zone-title">{{ modalTitle }}</h5>
                <app-ta-upload-dropzone
                    [dropZoneConfig]="dropZoneConfig"
                    [disableUnsupportedPreview]="true"
                    (onFileEvent)="onFilesEvent($event)"
                    (onDropBackground)="onDropBackground($event)"
                ></app-ta-upload-dropzone>
            </div>
        </div>

        <!-- Modal Additional Part -->

        <div
            *ngIf="
                modalAdditionalPart && (mapVisibility || hazardousVisibility)
            "
            class="modal-additional-part"
        >
            <ng-content select="[additional]"></ng-content>
        </div>
    </div>
</app-custom-scrollbar>
